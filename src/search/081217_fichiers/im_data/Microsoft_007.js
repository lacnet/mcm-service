// Copyright (c) Microsoft Corporation. All rights reserved.

Type.createNamespace('MSA');MSA._A$0=function(){};MSA._A$0.createInterface('MSA._A$0');MSA._A$1=function(){};MSA._A$1.createInterface('MSA._A$1');MSA._A$2=function(){};MSA._A$2.createInterface('MSA._A$2');MSA.AddressBook=function(identity){this.$1=MC.$create_AddressBookConfigurationInfo();this.$2=[];this.$0=identity;}
MSA.AddressBook.prototype={$0:null,$3:false,$4:null,$5:null,abort:function(){var $0=null;this.$2.clear();$0=this.$5;this.$5=null;if($0){try{$0.abort();}catch($1){}}},get_logger:function(){return this.$4;},set_logger:function(value){if(value){value.set_module('AddressBook');value.set_context(this.$0.liveId);}this.$4=value;return value;},get_$6:function(){return this.$1;},$7:function(){if(this.$A){this.$A.invoke(this,EventArgs.Empty);}},$8:function($p0){if(this.$B){this.$B.invoke(this,$p0);}},$9:function($p0,$p1,$p2,$p3,$p4){var $0=new MSCo.HttpRequest($p0,$p1,$p3,$p2,$p4);$0.execute();return $0;},synchronize:function(callback){var $0=new MSA._A$10(this.$0.liveId,this,callback);this.$C($0);},updateContactNickname:function(contact,callback){var $0=new MSA._A$15(this.$0.liveId,contact,this,callback);this.$C($0);},retrieveUnknownContact:function(callback){var $0=new MSA._A$7(this.$0.liveId,this,callback);this.$C($0);},createContact:function(contact,callback){var $0=new MSA._A$E(this.$0.liveId,contact,this,callback);this.$C($0);},retrieveContact:function(contactId,callback){var $0=new MSA._A$F(this.$0.liveId,contactId,this,callback);this.$C($0);},updateContact:function(contact,addedLists,callback){var $0=new MSA._A$12(this.$0.liveId,contact,addedLists,this,callback);this.$C($0);},deleteContact:function(contact,callback){var $0=new MSA._A$16(this.$0.liveId,contact,this,callback);this.$C($0);},createIMAddress:function(contact,address,callback){var $0=new MSA._A$13(this.$0.liveId,contact,address,this,callback);this.$C($0);},retrieveIMAddress:function(contactId,addressId,callback){var $0=new MSA._A$14(this.$0.liveId,contactId,addressId,this,callback);this.$C($0);},updateIMAddress:function(contact,address,callback){var $0=new MSA._A$8(this.$0.liveId,contact,address,this,callback);this.$C($0);},deleteIMAddress:function(contact,address,callback){var $0=new MSA._A$5(this.$0.liveId,contact,address,this,callback);this.$C($0);},createTag:function(group,callback){var $0=new MSA._A$6(this.$0.liveId,group,this,callback);this.$C($0);},retrieveTag:function(groupId,callback){var $0=new MSA._A$9(this.$0.liveId,groupId,this,callback);this.$C($0);},updateTag:function(group,callback){var $0=new MSA._A$C(this.$0.liveId,group,this,callback);this.$C($0);},deleteTag:function(group,callback){var $0=new MSA._A$D(this.$0.liveId,group,this,callback);this.$C($0);},createContactID:function(group,contact,callback){var $0=new MSA._A$A(this.$0.liveId,group,contact,this,callback);this.$C($0);},deleteContactID:function(group,contact,callback){var $0=new MSA._A$B(this.$0.liveId,group,contact,this,callback);this.$C($0);},updateConfiguration:function(configuration){this.$1=configuration;},updateSettings:function(settings,callback){var $0=new MSA._A$11(this.$0.liveId,settings,this,callback);this.$C($0);},add_changed:function(value){this.$A=Delegate.combine(this.$A,value);},remove_changed:function(value){this.$A=Delegate.remove(this.$A,value);},$A:null,add_authenticationFailed:function(value){this.$B=Delegate.combine(this.$B,value);},remove_authenticationFailed:function(value){this.$B=Delegate.remove(this.$B,value);},$B:null,$C:function($p0){$p0.add_$13(Delegate.create(this,this.$D));if(this.$3){this.$2.add($p0);return;}this.$3=true;this.$5=$p0;$p0.$B();},$D:function($p0,$p1){var $0=null;if(!MSCo.CollectionHelper.arrayLength(this.$2)){this.$3=false;return;}this.$E($p0);$0=this.$2[0];this.$2.removeAt(0);this.$5=$0;this.$3=true;if($0){$0.$B();}},$E:function($p0){if($p0.get_$A()){return;}if(Type.canCast($p0,MSA._A$6)){var $0=$p0;var $1=$0.$17;var $2=$0.$1A;for(var $3=0;$3<MSCo.CollectionHelper.arrayLength(this.$2);$3++){if(Type.canCast(this.$2[$3],MSA._A$0)){var $4=this.$2[$3];$4.onTagCreated($1,$2);}}}else if(Type.canCast($p0,MSA._A$E)){var $5=$p0;var $6=$5.$18;var $7=$5.$1A;for(var $8=0;$8<MSCo.CollectionHelper.arrayLength(this.$2);$8++){if(Type.canCast(this.$2[$8],MSA._A$1)){var $9=this.$2[$8];$9.onContactCreated($6,$7);}}}else if(Type.canCast($p0,MSA._A$13)){var $A=$p0;var $B=$A.$18;var $C=$A.$1A;for(var $D=0;$D<MSCo.CollectionHelper.arrayLength(this.$2);$D++){if(Type.canCast(this.$2[$D],MSA._A$2)){var $E=this.$2[$D];$E.onIMAddressCreated($B,$C);}}}}}
MSA._A$4=function(){}
MSA._A$4.$2=function($p0){var $0=MSCo.XmlHelper.xmlNodeValue($p0);if($0==='1'){return 1;}else if($0==='2'){return 2;}else if($0==='4'){return 4;}else if($0==='8'){return 8;}else if($0==='16'){return 16;}else if($0==='32'){return 32;}return 0;}
MSA._A$4.$3=function($p0){var $0=MSCo.XmlHelper.xmlNodeValue($p0);if($0==='Allow'){return 2;}else if($0==='Block'){return 4;}else if($0==='Pending'){return 16;}return 0;}
MSA._A$4.$4=function($p0){var $0=MSCo.XmlHelper.xmlNodeValue($p0);if($0.startsWith('MSGR:')){return MSCo.StringHelper.substringToEnd($0,'MSGR:'.length);}return null;}
MSA._A$4.$5=function($p0){if(String.isNullOrEmpty($p0)){return null;}var $0=$p0.lastIndexOf('(');var $1=$p0.lastIndexOf(')');if($0===-1||$1<$0){return null;}return MSCo.StringHelper.substring($p0,$0+1,$1-$0-1);}
MSA._A$4.$6=function($p0){return parseInt($p0,10);}
MSA._A$3=function(liveId,addressBook){this.$1=1;this.$2={};this.$3=addressBook;this.$0=String.format('http://{0}/{1}/LiveContacts/',this.$3.get_$6().hostName,liveId);this.$2['Content-Type']='application/xml; charset=utf-8';this.$2['Proxy-Connection']='Keep-Alive';this.$2['Pragma']='No-Cache';this.$2['com.microsoft.external.contacts.PartnerID']=this.$3.get_$6().partnerId;this.$2['com.microsoft.external.contacts.ErrorMessageLevel']='Verbose';}
MSA._A$3.prototype={$0:null,$3:null,$4:false,$5:false,$6:false,$7:false,$8:null,get_$9:function(){return true;},get_$A:function(){return this.$1===1;},$B:function(){this.$4=true;this.$10();},$C:function($p0,$p1,$p2,$p3){if(!this.$5){this.$8=this.$3.$9($p0,$p1,this.$2,$p2,$p3);}},$D:function(){if(!this.$6){this.$1=0;this.$6=true;if(this.$14){this.$14.invoke(this,EventArgs.Empty);}this.$12();if(this.get_$9()){this.$3.$7();}}},$E:function($p0,$p1,$p2){MSCo.LogHelper.loggerError(this.$3.get_logger(),$p1,String.format('Error:{0} Content:{1}',$p0.get_status(),$p0.get_responseText()));switch($p0.get_status()){case 403:case 0:case 302:if(!this.$7){this.$7=true;this.$3.$8(new MC.AuthenticationFailedEventArgs(this));return;}break;}if(!this.$6){this.$1=$p2;this.$6=true;if(this.$14){this.$14.invoke(this,EventArgs.Empty);}this.$12();}},$F:function($p0,$p1){this.$E($p0,$p1,1);},add_$13:function($p0){this.$14=Delegate.combine(this.$14,$p0);},remove_$13:function($p0){this.$14=Delegate.remove(this.$14,$p0);},$14:null,retry:function(){this.$10();},fail:function(){this.$1=1;this.$6=true;this.$12();},abort:function(){var $0=null;$0=this.$8;this.$5=true;if($0){$0.abort();}}}
MSA._A$10=function(liveId,addressBook,callback){MSA._A$10.constructBase(this,[liveId,addressBook]);this.$17=callback;}
MSA._A$10.$1A=function($p0){var $0=MC.$create_SettingsInfo();var $1=$p0.documentElement;var $2=$1.selectSingleNode('Owner');var $3=(MSCo.XmlHelper.xmlNodeValue($2.selectSingleNode('MPOPStatus')))||String.Empty;var $4=(MSCo.XmlHelper.xmlNodeValue($2.selectSingleNode('BlockPublicIM')))||String.Empty;switch($3){case '0':$0.isMpopDisabled=true;break;case '1':default:$0.isMpopDisabled=false;break;}$0.isMpopDisabledChanged=true;switch($4){case '1':$0.privacyOptions=2;break;case '0':default:$0.privacyOptions=1;break;}return $0;}
MSA._A$10.$1B=function($p0){var $0=[];var $1={};var $2={};var $3=[];var $4=$p0.documentElement;if(!$4||MSCo.XmlHelper.xmlNodeName($4)!=='XPathResult'){return null;}var $5=$4.selectNodes('Contact');for(var $7=0;$7<MSCo.XmlHelper.xmlNodeListCount($5);$7++){var $8=MSCo.XmlHelper.xmlNodeValue($5[$7].selectSingleNode('ID'));var $9=MSCo.XmlHelper.xmlNodeValue($5[$7].selectSingleNode('CID'));var $A=(MSCo.XmlHelper.xmlNodeValue($5[$7].selectSingleNode('Profiles/Personal/NickName')))||String.Empty;var $B=[];if(String.isNullOrEmpty($8)){continue;}var $C=$5[$7].selectNodes('IMAddresses/IMAddress');for(var $E=0;$E<MSCo.XmlHelper.xmlNodeListCount($C);$E++){var $F=MSCo.XmlHelper.xmlNodeValue($C[$E].selectSingleNode('ID'));var $10=MSA._A$4.$2($C[$E].selectSingleNode('Capability'));var $11=MSCo.XmlHelper.xmlNodeValue($C[$E].selectSingleNode('Address'));var $12=MSA._A$4.$3($C[$E].selectSingleNode('PresencePermission'));var $13=MSCo.XmlHelper.xmlNodeValue($C[$E].selectSingleNode('InviteMessage'));var $14=String.Empty;if(String.isNullOrEmpty($F)||!$10||!$12||$11.length>129){continue;}if($8!=='00000000-0000-0000-0000-000000000000'){$12|=1;}var $15=$11+':'+$10;if(Object.keyExists($1,$15)){continue;}if($10===1&&!String.isNullOrEmpty($9)){$14=$9;}var $16=MC.$create_IMAddressInfo($11,$10,$12);$16.id=$F;$16.inviteMessage=$13;$16.cid=$14;$1[$15]=$16;$B.add($16);}if(!MSCo.CollectionHelper.arrayLength($B)){continue;}var $D=MC.$create_ContactInfo($8,$A,MSCo.CollectionHelper.toArray($B));$2[$D.id]=$D;$3.add($D.id);}var $6=$4.selectNodes('Tag');for(var $17=0;$17<MSCo.XmlHelper.xmlNodeListCount($6);$17++){var $18=MSCo.XmlHelper.xmlNodeValue($6[$17].selectSingleNode('ID'));var $19=MSA._A$4.$4($6[$17].selectSingleNode('Name'));var $1A=[];if(String.isNullOrEmpty($18)||String.isNullOrEmpty($19)){continue;}var $1B=$6[$17].selectNodes('ContactIDs/ContactID');for(var $1D=0;$1D<MSCo.XmlHelper.xmlNodeListCount($1B);$1D++){var $1E=MSCo.XmlHelper.xmlNodeValue($1B[$1D].selectSingleNode('ID'));if(Object.keyExists($2,$1E)){var $1F=$2[$1E];$1A.add($1F);$3.remove($1F.id);}}var $1C=MC.$create_GroupInfo($18,$19,MSCo.CollectionHelper.toArray($1A));$0.add($1C);}if(MSCo.CollectionHelper.arrayLength($3)>0){var $20=[];var $enum1=$3.getEnumerator();while($enum1.moveNext()){var $22=$enum1.get_current();$20.add($2[$22]);}var $21=MC.$create_GroupInfo('00000000-0000-0000-0000-000000000000','00000000-0000-0000-0000-000000000000',MSCo.CollectionHelper.toArray($20));$0.add($21);}return MSCo.CollectionHelper.toArray($0);}
MSA._A$10.prototype={$17:null,$18:null,$19:null,get_$9:function(){return false;},$10:function(){this.$C(0,this.$0+'?Filter=LiveContacts(Owner,Contact(ID,CID,IMAddress,Profiles(Personal(NickName))),Tag)&XPath=//Owner|//Contact[IMAddresses]|//Tag',String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===200&&$p0.get_responseText().length>0){this.$18=MSA._A$10.$1B($p0.get_responseXml());this.$19=MSA._A$10.$1A($p0.get_responseXml());}if(this.$18){this.$D();}else{this.$18=[];this.$F($p0,'Synchronize');}},$12:function(){this.$17.invoke(this.$1,this.$18,this.$19);}}
MSA._A$11=function(liveId,settings,addressBook,callback){MSA._A$11.constructBase(this,[liveId,addressBook]);this.$19=settings;this.$1D=callback;}
MSA._A$11.prototype={$19:null,$1A:0,$1B:0,$1C:false,$1D:null,$10:function(){this.$1A=0;this.$1B=0;this.$1C=false;if(this.$19.isMpopDisabledChanged){this.$1A++;}if(this.$19.privacyOptions){this.$1A++;}if(this.$19.isMpopDisabledChanged){var $0=String.format('{0}Owner/MPOPStatus',this.$0);var $1=((this.$19.isMpopDisabled)?'0':'1');var $2=String.format(MSA._A$11.$15,MSCo.XmlHelper.xmlEscape($1));this.$C(2,$0,$2,Delegate.create(this,this.$11));}if(this.$19.privacyOptions){var $3;switch(this.$19.privacyOptions){case 2:$3='1';break;case 1:default:$3='0';break;}var $4=String.format('{0}Owner/BlockPublicIM',this.$0);var $5=String.format(MSA._A$11.$16,MSCo.XmlHelper.xmlEscape($3));this.$C(2,$4,$5,Delegate.create(this,this.$11));}},$11:function($p0){this.$1B++;switch($p0.get_status()){case 204:break;default:this.$1C=true;break;}if(this.$1A===this.$1B){if(this.$1C){this.$F($p0,'UpdateSettings');}else{this.$D();}}},$12:function(){this.$1D.invoke(this.$1);}}
MSA._A$E=function(liveId,contact,addressBook,callback){MSA._A$E.constructBase(this,[liveId,addressBook]);this.$18=contact;this.$19=callback;}
MSA._A$E.prototype={$18:null,$19:null,$1A:null,$10:function(){var $0=String.format('{0}Contacts',this.$0);var $1=new StringBuilder();var $enum1=this.$18.addresses.getEnumerator();while($enum1.moveNext()){var $4=$enum1.get_current();var $5=String.Empty;if(!String.isNullOrEmpty($4.inviteMessage)){$5=MSCo.XmlHelper.xmlEscape($4.inviteMessage);}$1.append(String.format(MSA._A$E.$16,(($4.address.startsWith('+'))?'Phone':'Email'),MSCo.XmlHelper.xmlEscape($4.address),((($4.roleLists&4))?'Block':'Allow'),$5));}var $2=this.$18.addresses[0].address;if($2.length>40){$2=MSCo.StringHelper.substring($2,0,40);}var $3=String.format(MSA._A$E.$15,MSCo.XmlHelper.xmlEscape($2),$1.toString());this.$C(1,$0,$3,Delegate.create(this,this.$11));},$11:function($p0){switch($p0.get_status()){case 201:this.$1A=MSA._A$4.$5($p0.getResponseHeader('Location'));this.$D();break;case 400:case 500:this.$E($p0,'CreateContact',2);break;default:this.$F($p0,'CreateContact');break;}},$12:function(){this.$19.invoke(this.$1,this.$1A);}}
MSA._A$F=function(liveId,contactId,addressBook,callback){MSA._A$F.constructBase(this,[liveId,addressBook]);this.$17=contactId;this.$18=callback;}
MSA._A$F.$1A=function($p0){var $0=$p0.documentElement;if(!$0||MSCo.XmlHelper.xmlNodeName($0)!=='Contact'){return null;}var $1=MSCo.XmlHelper.xmlNodeValue($0.selectSingleNode('ID'));var $2=MSCo.XmlHelper.xmlNodeValue($0.selectSingleNode('CID'));var $3=(MSCo.XmlHelper.xmlNodeValue($0.selectSingleNode('Profiles/Personal/NickName')))||String.Empty;var $4=[];if(String.isNullOrEmpty($1)){return null;}var $5=$0.selectNodes('IMAddresses/IMAddress');for(var $7=0;$7<MSCo.XmlHelper.xmlNodeListCount($5);$7++){var $8=MSCo.XmlHelper.xmlNodeValue($5[$7].selectSingleNode('ID'));var $9=MSA._A$4.$2($5[$7].selectSingleNode('Capability'));var $A=MSCo.XmlHelper.xmlNodeValue($5[$7].selectSingleNode('Address'));var $B=MSA._A$4.$3($5[$7].selectSingleNode('PresencePermission'));var $C=MSCo.XmlHelper.xmlNodeValue($5[$7].selectSingleNode('InviteMessage'));if(String.isNullOrEmpty($8)||!$9||!$B){return null;}if($1!=='00000000-0000-0000-0000-000000000000'){$B|=1;}var $D=String.Empty;if($9===1&&!String.isNullOrEmpty($2)){$D=$2;}var $E=MC.$create_IMAddressInfo($A,$9,$B);$E.id=$8;$E.inviteMessage=$C;$E.cid=$D;$4.add($E);}if(!MSCo.CollectionHelper.arrayLength($4)){return null;}var $6=MC.$create_ContactInfo($1,$3,MSCo.CollectionHelper.toArray($4));return $6;}
MSA._A$F.prototype={$17:null,$18:null,$19:null,get_$9:function(){return false;},$10:function(){var $0=String.format('{0}Contacts/Contact({1})/',this.$0,this.$17);this.$C(0,$0+'?Filter=LiveContacts(Contact(ID,CID,IMAddress,Profiles(Personal(NickName))))',String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===200&&$p0.get_responseText().length>0){this.$19=MSA._A$F.$1A($p0.get_responseXml());}if(this.$19){this.$D();}else{this.$19=MC.$create_ContactInfo('00000000-0000-0000-0000-000000000000',null,[]);this.$F($p0,'RetrieveContact');}},$12:function(){this.$18.invoke(this.$1,this.$19);},$1B:function($p0,$p1){if(this.$17===$p0.id){this.$17=$p1;}}}
MSA._A$12=function(liveId,contact,addedLists,addressBook,callback){MSA._A$12.constructBase(this,[liveId,addressBook]);this.$17=contact;this.$18=addedLists;this.$1A=callback;}
MSA._A$12.prototype={$17:null,$18:0,$19:0,$1A:null,$10:function(){this.$19=this.$17.addresses.length;var $0=new Array(this.$19);var $1=new Array(this.$19);for(var $2=0;$2<this.$19;$2++){var $3=this.$17.addresses[$2];$0[$2]=String.format('{0}Contacts/Contact({1})/IMAddresses/IMAddress({2})/PresencePermission',this.$0,this.$17.id,$3.id);$1[$2]=String.format('<PresencePermission>{0}</PresencePermission>',(((this.$18&4))?'Block':'Allow'));}for(var $4=0;$4<$0.length;$4++){this.$C(2,$0[$4],$1[$4],Delegate.create(this,this.$11));}},$11:function($p0){if($p0.get_status()===204){this.$D();}else{this.$F($p0,'UpdateContact');}},$12:function(){if(--this.$19){return;}this.$1A.invoke(this.$1);},onContactCreated:function($p0,$p1){if(this.$17.id===$p0.id){this.$17.id=$p1;}}}
MSA._A$15=function(liveId,contact,addressBook,callback){MSA._A$15.constructBase(this,[liveId,addressBook]);this.$17=contact;this.$18=callback;}
MSA._A$15.prototype={$17:null,$18:null,$10:function(){var $0=String.format('{0}Contacts/Contact({1})/Profiles/Personal/NickName',this.$0,this.$17.id);var $1=String.format(MSA._A$15.$15,MSCo.XmlHelper.xmlEscape(this.$17.nickname));this.$C(2,$0,$1,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===204){this.$D();}else{this.$F($p0,'UpdateContact');}},$12:function(){this.$18.invoke(this.$1);}}
MSA._A$16=function(liveId,contact,addressBook,callback){MSA._A$16.constructBase(this,[liveId,addressBook]);this.$16=contact;this.$17=callback;}
MSA._A$16.prototype={$16:null,$17:null,$10:function(){var $0=String.format('{0}Contacts/Contact({1})/',this.$0,this.$16.id);this.$C(3,$0,String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===204){this.$D();}else{this.$F($p0,'DeleteContact');}},$12:function(){this.$17.invoke(this.$1);},onContactCreated:function($p0,$p1){if(this.$16.id===$p0.id){this.$16.id=$p1;}}}
MSA._A$13=function(liveId,contact,address,addressBook,callback){MSA._A$13.constructBase(this,[liveId,addressBook]);this.$17=contact;this.$18=address;this.$19=callback;}
MSA._A$13.prototype={$17:null,$18:null,$19:null,$1A:null,$10:function(){var $0=String.format('{0}Contacts/Contact({1})/IMAddresses',this.$0,this.$17.id);var $1=String.Empty;if(!String.isNullOrEmpty(this.$18.inviteMessage)){$1=MSCo.XmlHelper.xmlEscape(this.$18.inviteMessage);}var $2=String.format(MSA._A$13.$15,((this.$18.address.startsWith('+'))?'Phone':'Email'),MSCo.XmlHelper.xmlEscape(this.$18.address),(((this.$18.roleLists&4))?'Block':'Allow'),$1);this.$C(1,$0,$2,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===201){this.$1A=MSA._A$4.$5($p0.getResponseHeader('Location'));this.$D();}else{this.$F($p0,'CreateIMAddress');}},$12:function(){this.$19.invoke(this.$1,this.$1A);},onContactCreated:function($p0,$p1){if(this.$17.id===$p0.id){this.$17.id=$p1;}}}
MSA._A$14=function(liveId,contactId,addressId,addressBook,callback){MSA._A$14.constructBase(this,[liveId,addressBook]);this.$16=contactId;this.$17=addressId;this.$18=callback;}
MSA._A$14.$1A=function($p0){var $0=$p0.documentElement;if(!$0||MSCo.XmlHelper.xmlNodeName($0)!=='IMAddress'){return null;}var $1=MSCo.XmlHelper.xmlNodeValue($0.selectSingleNode('ID'));var $2=MSA._A$4.$2($0.selectSingleNode('Capability'));var $3=MSCo.XmlHelper.xmlNodeValue($0.selectSingleNode('Address'));var $4=MSA._A$4.$3($0.selectSingleNode('PresencePermission'));var $5=MSCo.XmlHelper.xmlNodeValue($0.selectSingleNode('InviteMessage'));if(String.isNullOrEmpty($1)||!$2||!$4){return null;}var $6=MC.$create_IMAddressInfo($3,$2,$4);$6.id=$1;$6.inviteMessage=$5;return $6;}
MSA._A$14.prototype={$16:null,$17:null,$18:null,$19:null,get_$9:function(){return false;},$10:function(){var $0=String.format('{0}Contacts/Contact({1})/IMAddresses/IMAddress({2})',this.$0,this.$16,this.$17);this.$C(0,$0,String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===200&&$p0.get_responseText().length>0){this.$19=MSA._A$14.$1A($p0.get_responseXml());if(this.$16!=='00000000-0000-0000-0000-000000000000'){this.$19.roleLists|=1;}}if(this.$19){this.$D();}else{this.$F($p0,'RetrieveIMAddress');}},$12:function(){this.$18.invoke(this.$1,this.$19);},onContactCreated:function($p0,$p1){if(this.$16===$p0.id){this.$16=$p1;}},onIMAddressCreated:function($p0,$p1){if(this.$17===$p0.id){this.$17=$p1;}}}
MSA._A$7=function(liveId,addressBook,callback){MSA._A$7.constructBase(this,[liveId,addressBook]);this.$16=callback;}
MSA._A$7.$18=function($p0){var $0=[];var $1={};var $2=[];var $3=$p0.documentElement;if(!$3||MSCo.XmlHelper.xmlNodeName($3)!=='XPathResult'){return null;}var $4=$3.selectNodes('Contact');for(var $5=0;$5<MSCo.XmlHelper.xmlNodeListCount($4);$5++){var $6=MSCo.XmlHelper.xmlNodeValue($4[$5].selectSingleNode('ID'));var $7=[];if(String.isNullOrEmpty($6)||$6!=='00000000-0000-0000-0000-000000000000'){continue;}var $8=$4[$5].selectNodes('IMAddresses/IMAddress');for(var $9=0;$9<MSCo.XmlHelper.xmlNodeListCount($8);$9++){var $A=MSCo.XmlHelper.xmlNodeValue($8[$9].selectSingleNode('ID'));var $B=MSA._A$4.$2($8[$9].selectSingleNode('Capability'));var $C=MSCo.XmlHelper.xmlNodeValue($8[$9].selectSingleNode('Address'));var $D=MSA._A$4.$3($8[$9].selectSingleNode('PresencePermission'));var $E=MSCo.XmlHelper.xmlNodeValue($8[$9].selectSingleNode('InviteMessage'));if(String.isNullOrEmpty($A)||!$B||!$D){continue;}if($6!=='00000000-0000-0000-0000-000000000000'){$D|=1;}var $F=MC.$create_IMAddressInfo($C,$B,$D);$F.id=$A;$F.inviteMessage=$E;$7.add($F);}if(!MSCo.CollectionHelper.arrayLength($7)){continue;}return MC.$create_ContactInfo($6,null,MSCo.CollectionHelper.toArray($7));}return MC.$create_ContactInfo('00000000-0000-0000-0000-000000000000',null,[]);}
MSA._A$7.prototype={$16:null,$17:null,get_$9:function(){return false;},$10:function(){this.$C(0,this.$0+'?Filter=LiveContacts(Contact(ID,IMAddress))&XPath=//Contact[ID=\'00000000-0000-0000-0000-000000000000\']',String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===200&&$p0.get_responseText().length>0){this.$17=MSA._A$7.$18($p0.get_responseXml());}if(this.$17){this.$D();}else{this.$F($p0,'SynchronizePending');}},$12:function(){this.$16.invoke(this.$1,this.$17);}}
MSA._A$8=function(liveId,contact,address,addressBook,callback){MSA._A$8.constructBase(this,[liveId,addressBook]);this.$17=contact;this.$18=address;this.$19=callback;}
MSA._A$8.prototype={$17:null,$18:null,$19:null,$10:function(){var $0=(this.$17&&!String.isNullOrEmpty(this.$17.id))?this.$17.id:'00000000-0000-0000-0000-000000000000';var $1=String.format('{0}Contacts/Contact({1})/IMAddresses/IMAddress({2})',this.$0,$0,this.$18.id);var $2=String.format(MSA._A$8.$15,(((this.$18.roleLists&4))?'Block':'Allow'));this.$C(2,$1,$2,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===204){this.$D();}else{this.$F($p0,'UpdateIMAddress');}},$12:function(){this.$19.invoke(this.$1);},onContactCreated:function($p0,$p1){if(this.$17&&this.$17.id===$p0.id){this.$17.id=$p1;}},onIMAddressCreated:function($p0,$p1){if(this.$18.id===$p0.id){this.$18.id=$p1;}}}
MSA._A$5=function(liveId,contact,address,addressBook,callback){MSA._A$5.constructBase(this,[liveId,addressBook]);this.$16=contact;this.$17=address;this.$18=callback;}
MSA._A$5.prototype={$16:null,$17:null,$18:null,$10:function(){var $0=String.format('{0}Contacts/Contact({1})/IMAddresses/IMAddress({2})',this.$0,this.$16.id,this.$17.id);this.$C(3,$0,String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===204){this.$D();}else{this.$F($p0,'DeleteIMAddress');}},$12:function(){this.$18.invoke(this.$1);},onContactCreated:function($p0,$p1){if(this.$16.id===$p0.id){this.$16.id=$p1;}},onIMAddressCreated:function($p0,$p1){if(this.$17.id===$p0.id){this.$17.id=$p1;}}}
MSA._A$6=function(liveId,group,addressBook,callback){MSA._A$6.constructBase(this,[liveId,addressBook]);this.$17=group;this.$19=callback;}
MSA._A$6.prototype={$17:null,$19:null,$1A:null,$10:function(){var $0=String.format('{0}Tags',this.$0);var $1=new StringBuilder();var $enum1=this.$17.contacts.getEnumerator();while($enum1.moveNext()){var $3=$enum1.get_current();$1.append(String.format(MSA._A$6.$16,MSCo.XmlHelper.xmlEscape($3.id)));}var $2=String.format(MSA._A$6.$15,MSCo.XmlHelper.xmlEscape(this.$17.name),$1.toString());this.$C(1,$0,$2,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===201){this.$1A=MSA._A$4.$5($p0.getResponseHeader('Location'));this.$D();}else{this.$F($p0,'CreateTag');}},$12:function(){this.$19.invoke(this.$1,this.$1A);}}
MSA._A$9=function(liveId,groupId,addressBook,callback){MSA._A$9.constructBase(this,[liveId,addressBook]);this.$17=groupId;this.$18=callback;}
MSA._A$9.$1A=function($p0){var $0=$p0.documentElement;if(!$0||MSCo.XmlHelper.xmlNodeName($0)!=='Tag'){return null;}var $1=MSCo.XmlHelper.xmlNodeValue($0.selectSingleNode('ID'));var $2=MSA._A$4.$4($0.selectSingleNode('Name'));var $3=[];if(String.isNullOrEmpty($1)||String.isNullOrEmpty($2)){return null;}var $4=$0.selectNodes('ContactIDs/ContactID');for(var $6=0;$6<MSCo.XmlHelper.xmlNodeListCount($4);$6++){var $7=MSCo.XmlHelper.xmlNodeValue($4[$6].selectSingleNode('ID'));if(String.isNullOrEmpty($7)){return null;}var $8=MC.$create_ContactInfo($7,null,[]);$3.add($8);}var $5=MC.$create_GroupInfo($1,$2,MSCo.CollectionHelper.toArray($3));return $5;}
MSA._A$9.prototype={$17:null,$18:null,$19:null,get_$9:function(){return false;},$10:function(){var $0=String.format('{0}Tags/Tag({1})/',this.$0,this.$17);this.$C(0,$0+'?Filter=LiveContacts(Tag(ID,Name,ContactIDs))',String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===200&&$p0.get_responseText().length>0){this.$19=MSA._A$9.$1A($p0.get_responseXml());}if(this.$19){this.$D();}else{this.$19=MC.$create_GroupInfo('00000000-0000-0000-0000-000000000000','Unknown',[]);this.$F($p0,'RetrieveTag');}},$12:function(){this.$18.invoke(this.$1,this.$19);},onTagCreated:function($p0,$p1){if(this.$17===$p0.id){this.$17=$p1;}}}
MSA._A$C=function(liveId,group,addressBook,callback){MSA._A$C.constructBase(this,[liveId,addressBook]);this.$17=group;this.$18=callback;}
MSA._A$C.prototype={$17:null,$18:null,$10:function(){var $0=String.format('{0}Tags/Tag({1})/Name',this.$0,this.$17.id);var $1=String.format('<Name>{0}{1}</Name>','MSGR:',MSCo.XmlHelper.xmlEscape(this.$17.name));this.$C(2,$0,$1,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===204){this.$D();}else{this.$F($p0,'UpdateGroup');}},$12:function(){this.$18.invoke(this.$1);},onTagCreated:function($p0,$p1){if(this.$17.id===$p0.id){this.$17.id=$p1;}}}
MSA._A$D=function(liveId,group,addressBook,callback){MSA._A$D.constructBase(this,[liveId,addressBook]);this.$16=group;this.$17=callback;}
MSA._A$D.prototype={$16:null,$17:null,$10:function(){var $0=String.format('{0}Tags/Tag({1})/',this.$0,this.$16.id);this.$C(3,$0,String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===204){this.$D();}else{this.$F($p0,'DeleteTag');}},$12:function(){this.$17.invoke(this.$1);},onTagCreated:function($p0,$p1){if(this.$16.id===$p0.id){this.$16.id=$p1;}}}
MSA._A$A=function(liveId,group,contact,addressBook,callback){MSA._A$A.constructBase(this,[liveId,addressBook]);this.$17=group;this.$18=contact;this.$19=callback;}
MSA._A$A.prototype={$17:null,$18:null,$19:null,$1A:null,$10:function(){var $0=String.format('{0}Tags/Tag({1})/ContactIDs',this.$0,this.$17.id);var $1=String.format(MSA._A$A.$15,MSCo.XmlHelper.xmlEscape(this.$18.id));this.$1A=this.$18.id;this.$C(1,$0,$1,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===201){this.$1A=MSA._A$4.$5($p0.getResponseHeader('Location'));this.$D();}else if($p0.get_status()===409){this.$D();}else{this.$F($p0,'CreateContactID');}},$12:function(){this.$19.invoke(this.$1,this.$1A);},onTagCreated:function($p0,$p1){if(this.$17.id===$p0.id){this.$17.id=$p1;}},onContactCreated:function($p0,$p1){if(this.$18.id===$p0.id){this.$18.id=$p1;}}}
MSA._A$B=function(liveId,group,contact,addressBook,callback){MSA._A$B.constructBase(this,[liveId,addressBook]);this.$16=group;this.$17=contact;this.$18=callback;}
MSA._A$B.prototype={$16:null,$17:null,$18:null,$10:function(){var $0=String.format('{0}Tags/Tag({1})/ContactIDs/ContactID({2})',this.$0,this.$16.id,this.$17.id);this.$C(3,$0,String.Empty,Delegate.create(this,this.$11));},$11:function($p0){if($p0.get_status()===204){this.$D();}else if($p0.get_status()===404){this.$D();}else{this.$F($p0,'DeleteContactID');}},$12:function(){this.$18.invoke(this.$1);},onTagCreated:function($p0,$p1){if(this.$16.id===$p0.id){this.$16.id=$p1;}},onContactCreated:function($p0,$p1){if(this.$17.id===$p0.id){this.$17.id=$p1;}}}
MSA.AddressBook.createClass('MSA.AddressBook',null,MC.IAddressBook,MC.IAbortable);MSA._A$4.createClass('MSA._A$4');MSA._A$3.createClass('MSA._A$3',null,MC.IAuthenticatedCommand,MC.IAbortable);MSA._A$10.createClass('MSA._A$10',MSA._A$3);MSA._A$11.createClass('MSA._A$11',MSA._A$3);MSA._A$E.createClass('MSA._A$E',MSA._A$3);MSA._A$F.createClass('MSA._A$F',MSA._A$3);MSA._A$12.createClass('MSA._A$12',MSA._A$3,MSA._A$1);MSA._A$15.createClass('MSA._A$15',MSA._A$3);MSA._A$16.createClass('MSA._A$16',MSA._A$3,MSA._A$1);MSA._A$13.createClass('MSA._A$13',MSA._A$3,MSA._A$1);MSA._A$14.createClass('MSA._A$14',MSA._A$3,MSA._A$1,MSA._A$2);MSA._A$7.createClass('MSA._A$7',MSA._A$3);MSA._A$8.createClass('MSA._A$8',MSA._A$3,MSA._A$1,MSA._A$2);MSA._A$5.createClass('MSA._A$5',MSA._A$3,MSA._A$1,MSA._A$2);MSA._A$6.createClass('MSA._A$6',MSA._A$3);MSA._A$9.createClass('MSA._A$9',MSA._A$3,MSA._A$0);MSA._A$C.createClass('MSA._A$C',MSA._A$3,MSA._A$0);MSA._A$D.createClass('MSA._A$D',MSA._A$3,MSA._A$0);MSA._A$A.createClass('MSA._A$A',MSA._A$3,MSA._A$0,MSA._A$1);MSA._A$B.createClass('MSA._A$B',MSA._A$3,MSA._A$0,MSA._A$1);MSA._A$4.$0='MSGR:';MSA._A$4.$1='00000000-0000-0000-0000-000000000000';MSA._A$11.$15='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<MPOPStatus>{0}</MPOPStatus>';MSA._A$11.$16='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<BlockPublicIM>{0}</BlockPublicIM>';MSA._A$E.$15='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<Contact>'+'<Profiles>'+'<Personal>'+'<NameToFileAs>{0}</NameToFileAs>'+'</Personal>'+'</Profiles>'+'<IMAddresses>{1}</IMAddresses>'+'</Contact>';MSA._A$E.$16='<IMAddress>'+'<IMAddressType>{0}</IMAddressType>'+'<Address>{1}</Address>'+'<PresencePermission>{2}</PresencePermission>'+'<InviteMessage>{3}</InviteMessage>'+'</IMAddress>';MSA._A$15.$15='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<NickName>{0}</NickName>';MSA._A$13.$15='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<IMAddress>'+'<IMAddressType>{0}</IMAddressType>'+'<Address>{1}</Address>'+'<PresencePermission>{2}</PresencePermission>'+'<InviteMessage>{3}</InviteMessage>'+'</IMAddress>';MSA._A$8.$15='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<IMAddress>'+'<PresencePermission>{0}</PresencePermission>'+'</IMAddress>';MSA._A$6.$15='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<Tag>'+'<Name>MSGR:{0}</Name>'+'<ContactIDs>{1}</ContactIDs>'+'</Tag>';MSA._A$6.$16='<ContactID>'+'<ID>{0}</ID>'+'</ContactID>';MSA._A$A.$15='<?xml version=\"1.0\" encoding=\"utf-8\"?>'+'<ContactID>'+'<ID>{0}</ID>'+'</ContactID>';
// ---- Do not remove this footer ----
// Generated using Script# v0.5.1.0 (http://projects.nikhilk.net)
// -----------------------------------
