AutoRefresh.initialize=function AutoRefresh$initialize(){AutoRefresh._emailReceivedHandler=Delegate.create(this,AutoRefresh._emailReceived);AutoRefresh._throttlingTime=Math.max(parseInt(AutoRefresh.config.delay),0)*1e3;AutoRefresh._callPending=false;AutoRefresh._webIMReady=false;AutoRefresh._initializerID=setInterval(AutoRefresh._tryInitialize,1e3)};AutoRefresh._onUnload=function AutoRefresh$_onUnload(){AutoRefresh.dispose()};AutoRefresh.dispose=function AutoRefresh$dispose(){if(AutoRefresh._webIMReady){window.detachEvent("onunload",AutoRefresh._onUnload);AutoRefresh._webIM.remove_emailReceived(AutoRefresh._emailReceivedHandler);AutoRefresh._webIM=null}};AutoRefresh._tryInitialize=function AutoRefresh$_tryInitialize(){var b,a;b=top.document.getElementById("IMFrame").contentWindow;if(!b)return;a=b["gWebIM"];if(!a)return;clearInterval(AutoRefresh._initializerID);AutoRefresh._initializerID=0;AutoRefresh._webIM=a;if(a["add_emailReceived"]){AutoRefresh._webIMReady=true;a.add_emailReceived(AutoRefresh._emailReceivedHandler);window.attachEvent("onunload",AutoRefresh._onUnload)}};AutoRefresh._emailReceived=function AutoRefresh$_emailReceived(){if(!AutoRefresh._callPending){setTimeout(AutoRefresh._triggerRefresh,AutoRefresh._throttlingTime);AutoRefresh._callPending=true}};AutoRefresh._triggerRefresh=function AutoRefresh$_triggerRefresh(){if(!AutoRefresh.config.isDown&&AutoRefresh._refreshCallback)AutoRefresh._refreshCallback.call(null);AutoRefresh._callPending=false};new function(){var a=AutoRefresh.Ps={};a.autoRefreshOnlyFolders="97837";a.autoRefreshFoldersAndMessages="97838"};AutoRefresh._refreshInbox=function AutoRefresh$_refreshInbox(){var c=InboxPage.folderList,b=!(c.isSrch||InboxPage.readingPane.isFullView),a=InboxPage.createMessageListRenderingInfo(true);a.AutoSelectMessageIndex=-1;InboxPage.beginRefreshInbox(true,b,a,false,null,false,AutoRefresh._endRefreshInbox)};AutoRefresh._endRefreshInbox=function AutoRefresh$_endRefreshInbox(d,k,l,j){d.MessageHtml=null;var g=false,a=InboxPage.getSelectedMessageData().mids,b=a.length,i=parseInt($("messageListScrollableContainer").scrollTop),h=AutoRefresh.Ps.autoRefreshOnlyFolders,c=d.MessageListHtml;if(b>0){if(1==b)g=$tag($(a[0]),"INPUT")[0].checked;if(c.indexOf(a[0])<0)d.MessageListHtml=c=null}if(c!=null&&c!="")h=AutoRefresh.Ps.autoRefreshFoldersAndMessages;Tracking.addPS(h);InboxServices._endRefreshInbox(d,k,l);if(b>0){var e=InboxPage.messageList;if(1==b){if(g)$tag($(a[0]),"INPUT")[0].checked=true;e.selectByMid(a[0],true,true)}else{if(e.getCount()>0)e.selectByIndex(0,false,true);for(var f=b-1;f>=0;f--){$tag($(a[f]),"INPUT")[0].checked=true;e.selectByMid(a[f],true,false)}}$("messageListScrollableContainer").scrollTop=i}AutoRefresh.config.isDown=j};AutoRefresh._refreshCallback=AutoRefresh._refreshInbox;InboxPage.initializeBucket2=function InboxPage$initializeBucket2(){AutoRefresh.initialize();Page.pageComplete()}