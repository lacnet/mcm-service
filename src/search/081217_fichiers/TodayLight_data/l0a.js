Content={};Content.getString=function Content$getString(b,d){b=(d?d:"live.hotmail")+"."+b;var a=window,e=b.toLowerCase().split("."),g=e.length;for(var c=0;c<g;c++){var f=e[c];a=a[f];if(a==null)return ""}return a.toString()};Content.$=Content.getString;if(typeof __kernel_loaded=="undefined"||!__kernel_loaded){Object.isNull=function Object$isNull(a){return "undefined"==typeof a||null==a};String._format=function String$_format(a,b){if(!String._formatRE)String._formatRE=/(\{[^\}^\{]+\})/g;return a.replace(String._formatRE,function(e,d){var c=parseInt(d.substr(1)),a=b[c+1];if(a===null||a===undefined)return "";return a.toString()})};String.format=function String$format(a){return String._format(a,arguments)};Array.prototype.add=function Array$add(a){this[this.length]=a};Array.prototype.indexOf=function Array$indexOf(c){var b=this.length;if(b)for(var a=0;a<b;a++)if(this[a]===c)return a;return -1};Array.prototype.contains=function Array$contains(b){var a=this.indexOf(b);return a>=0};function $(a){return document.getElementById(a)}function $tag(b,a){return (b||document).getElementsByTagName(a)}if(!window.__usingCompat){window.FunctionHelper={};FunctionHelper.wrapMethod=FunctionHelper.wrapTopLevelMethod=function Function$wrapMethod(c,b,a){return a};FunctionHelper.isSpecialMember=FunctionHelper.needsWrapping=function Type$isSpecialMember(){return false}}window.__classes={};window["__kernel_loaded"]=true}if(Browser.isSF2)String.format=function String$format(a){if(!String._formatRE)String._formatRE=/(\{[^\}^\{]+\})/g;var b=a.match(String._formatRE),f=b.length;if(b)for(var c=0;c<f;c++){var d=parseInt(b[c].substr(1)),e=arguments[d+1]||"";a=a.replace(new RegExp("\\{"+d+"\\}"),e.toString())}return a};String.prototype._replace=String.prototype.replace;String.prototype.replace=function String$replace(a,b){if(a===null||a===undefined)return "";if(a.constructor==String){b=b||"";return this.split(a).join(b)}return String.prototype._replace.call(this,a,b)};String.prototype.trim=function String$trim(){return this.trimEnd().trimStart()};String.prototype.trimEnd=function String$trimEnd(){return this.replace(/\s*$/,"")};String.prototype.trimStart=function String$trimStart(){return this.replace(/^\s*/,"")};String.prototype.isGuid=function String$isGuid(){return /^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/.test(this)};var Type=Function;Type.registerNamespace=function Type$registerNamespace(b){if(window.__namespaces[b])return;var a=window,e=b.split("."),g=e.length;for(var d=0;d<g;d++){var f=e[d],c=a[f];if(!c)a[f]=c={};a=c}window.__namespaces[b]=a};window.__namespaces={};Type.getType=function Type$getType(a){return window.__classes[a]};Type.prototype.createClass=function Type$createClass(b,a){Type.createStaticClass(this,b);this.prototype.constructor=this;if(a)this.extendFrom(a)};Type.createStaticClass=function Type$createStaticClass(b,a){b.__typeName=a;window.__classes[a]=b};__classes["Type"]=Type;if(window.__usingCompat){Type._oldCC=Type.createStaticClass;Type.createStaticClass=function Type$mozilla$createStaticClass(a,c){Type._oldCC(a,c);for(var b in a){if(FunctionHelper.isSpecialMember(a,b))continue;if(FunctionHelper.needsWrapping(a[b]))a[b]=FunctionHelper.wrapMethod(c,b,a[b],false)}a=a.prototype;for(var b in a){if(FunctionHelper.isSpecialMember(a,b))continue;if(FunctionHelper.needsWrapping(a[b]))a[b]=FunctionHelper.wrapMethod(c,b,a[b],false)}}}var Type=Function;function Type$callBase(d,c,a){var b=d.prototype[c];if(a!==undefined)return b.apply(this,a);return b.call(this)}Type.prototype.extendFrom=function Type$extendFrom(a){this.__baseType=a;this.prototype.callBase=Type$callBase;for(var b in a.prototype)if(!this.prototype[b])this.prototype[b]=a.prototype[b]};Type.prototype.isInstance=function Type$isInstance(a){if(a===null||a===undefined)return false;if(this==Object||a instanceof this)return true;var c=null;try{c=a.constructor}catch(d){}if(this==Object||this==c)return true;var b=a.constructor.__baseType;while(b){if(b==this)return true;b=b.__baseType}return false};Type.__typeName="Type";Boolean.__typeName="Boolean";Object.__typeName="Object";Number.__typeName="Number";String.__typeName="String";Array.__typeName="Array";RegExp.__typeName="RegExp";Date.__typeName="Date";Error.__typeName="Error";if(Browser.isSF)Type.prototype.extendFrom=function Type$extendFrom(a){this.__baseType=a;this.prototype.callBase=Type$callBase;var c=false;for(var b in a.prototype){if(b=="__events")c=true;if(FunctionHelper.isSpecialMember(a.prototype,b))continue;if(!this.prototype[b])this.prototype[b]=a.prototype[b]}if(c){this.prototype.attachEvent=a.prototype.attachEvent;this.prototype.detachEvent=a.prototype.detachEvent}};var Control={};Control.onPreInvoke=Control.onPostInvoke=Control.onError=function(){};Control.create=function Control$create(a,b){a.elt=b;b["__"+a.constructor.__typeName]=a};Control.destroy=function Control$destroy(a){var b=a.elt;b["__"+a.constructor.__typeName]=a.elt=null;b=null;a.elt=null};Control.tryFindControl=function Control$tryFindControl(a,d){var c=Type.getType(d);if(!c)return null;var b="__"+c.__typeName;while(a!=document.body){if(a[b])return a[b];a=a.parentNode}return null};Control.findControl=function Control$findControl(c,a){var b=Control.tryFindControl(c,a);return b};Control._invokeImpl=function Control$_invokeImpl(c,a,h,d,g){if(window.__usingCompat)window.event=window.__getEventObj(h);Control.onPreInvoke(c,a,d);var b=null;if(g){if(!event)return;var e=Control.findControl(event.srcElement,c);if(!e||!e[a])return;b=e[a](d)}else{var f=Type.getType(c);if(!f||!f[a])return;b=f[a](d)}Control.onPostInvoke(c,a,d,b);if(window.__usingCompat)return event&&event._returnValueSet?event.returnValue:b;return b};Control.invoke=function Control$invoke(b,a,c,d){return Control._invokeImpl(b,a,c,d,true)};Control.invokeStatic=function Control$invokeStatic(b,a,c,d){return Control._invokeImpl(b,a,c,d,false)};Control.lookup=function Control$lookup(a,b){var a=Control.getAncestorByAttr(a,b);return a?a.getAttribute(b):null};Control.getAncestorByAttr=function Control$getAncestorByAttr(a,b){while(a&&a.getAttribute&&!a.getAttribute(b))a=a.parentElement;return a&&a.getAttribute?a:null};Type.createStaticClass(Control,"Control");if(window.__usingCompat){Control.invoke=FunctionHelper.wrapTopLevelMethod("Control","invoke",Control.invoke.__original);Control.invokeStatic=FunctionHelper.wrapTopLevelMethod("Control","invokeStatic",Control.invokeStatic.__original)}function Delegate(){}Delegate.Null=function(){};Delegate._create=function Delegate$_create(a){var b=function(){if(a.length==2)return a[1].apply(a[0],arguments);else{for(var b=0;b<a.length;b+=2)a[b+1].apply(a[b],arguments);return null}};b.invoke=b;b._targets=a;return b};Delegate.create=function Delegate$create(b,a){if(!b){a.invoke=a;return a}return Delegate._create([b,a])};Delegate.combine=function(a,b){if(!a){if(!b._targets)return Delegate.create(null,b);return b}if(!b){if(!a._targets)return Delegate.create(null,a);return a}var c=a._targets?a._targets:[null,a],d=b._targets?b._targets:[null,b];return Delegate._create(c.concat(d))};Delegate.remove=function Delegate$remove(c,a){if(!c||c===a)return null;if(!a)return c;var b=c._targets,f=null,e;if(a._targets){f=a._targets[0];e=a._targets[1]}else e=a;for(var d=0;d<b.length;d+=2)if(b[d]===f&&b[d+1]===e){if(b.length==2)return null;b.splice(d,2);return Delegate._create(b)}return c};__classes["Delegate"]=Delegate;var Events={};Events.init=function Events$init(a){a.__events={}};Events._attachEvent=function Events$_attachEvent(a,b){this.__events[a]=Delegate.combine(this.__events[a],b);return this.__events[a]};Events._detachEvent=function Events$_detachEvent(a,b){if(!this.__events[a])return;this.__events[a]=Delegate.remove(this.__events[a],b);if(!this.__events[a])delete this.__events[a]};Events._fireEvent=function Events$_fireEvent(a,b){if(!this.__events[a])return;this.__events[a].apply(this,b)};Events.addEventing=function Events$addEventing(b){var a=b.prototype;if(a){a.__events=null;a.attachEvent=Events._attachEvent;a.detachEvent=Events._detachEvent;a.fireEvent=Events._fireEvent}b.__events={};b.attachEvent=Events._attachEvent;b.detachEvent=Events._detachEvent;b.fireEvent=Events._fireEvent};__classes["Events"]=Events;Array.prototype.remove=function Array$remove(b){var a=this.indexOf(b);if(a>=0){this.splice(a,1);return true}return false};function $addClass(b,a){if(!b.className.split(" ").contains(a)){b.className+=" "+a;return true}return false}function $removeClass(c,b){var a=c.className.split(" ");if(a.contains(b)){a.remove(b);c.className=a.join(" ");return true}return false}function $replaceClass(a,b,c){if($containsClass(a,b)){$removeClass(a,b);$addClass(a,c);return true}return false}function $updateClass(e,d,c){var b=e.className.split(" ");for(var a=d.length-1;a>=0;a--)if(!b.contains(d[a]))b.push(d[a]);for(var a=c.length-1;a>=0;a--)if(b.contains(c[a]))b.remove(c[a]);e.className=b.join(" ")}function $containsClass(c,a){var b=c.className.split(" ");return b.contains(a)}function $setDisplay(b,a){b.style.display=a?"block":"none"}if(Browser.isSF&&window.__scanUI)$setDisplay=function Safari$setDisplay(b,a){b.style.display=a?"block":"none";window.__scanUI()};function $getDisplay(a){return a.currentStyle.display!="none"}function $callFocus(a){setTimeout(function(){try{a.focus()}catch(b){}},10)}function $getLocation(b,c){c=c||{};var d=c.x||0,e=c.y||0;for(var a=b;a&&a.tagName!="BODY";a=a.offsetParent){d+=a.offsetLeft;e+=a.offsetTop}function f(a,b){return this.left<=a&&a<=this.right&&this.top<=b&&b<=this.bottom}var g={left:d,top:e,right:d+(b?b.offsetWidth:0),bottom:e+(b?b.offsetHeight:0),containsPoint:f};return g}function $scrollIntoView(e,a){var b=parseInt(e.offsetTop),d=b+parseInt(e.offsetHeight),c=parseInt(a.scrollTop),f=c+parseInt(a.clientHeight);if(d-b>f-c)a.scrollTop=b;else{if(d>f)a.scrollTop=Math.max(d-a.clientHeight,0);if(b<c)a.scrollTop=b}}function $insertHtmlIntoElement(d,f){d.innerHTML=f;var a=$tag(d,"SCRIPT"),e=a?a.length:0;for(var b=0;b<e;b++){var c=document.createElement("SCRIPT");c.type=a[b].type;c.text=a[b].text;document.body.appendChild(c)}}if(!window.XMLHttpRequest)window.XMLHttpRequest=function window$XMLHttpRequest(){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return null}};var Network={};Network.EmptyFunction=function Network$EmptyFunction(){};Network.RequestStatus={New:0,Aborted:1,Executing:2,Completed:3,Error:4};Network.onRequestComplete=Network.onexception=Network.EmptyFunction;Network.detectDuplicateRequests=true;Network.makeCallback=function Network$makeCallback(c,b,a){return a};Network.initialize=function Network$initialize(a){Network._requests=[];Network.configuration=a};Network.createRequest=function Network$createRequest(d,e,f){var b=Network._requests,a;if(Network.detectDuplicateRequests)for(var c=b.length-1;c>=0;c--){a=b[c];if(a.url==d)return a}a=new Network._Request(d,e,f);b.push(a);return a};Network._Request=function Network$_Request(c,a,b){this.url=c;this.callback=a;this.verb=b||"GET";this.status=Network.RequestStatus.New;this.postString=this.context=null;this.headers={}};Network._Request.prototype.abort=function Network$_Request$abort(){if(this.status==Network.RequestStatus.Aborted)return;var a=this.resource;if(a){a.onreadystatechange=Network.EmptyFunction;a.abort()}this.status=Network.RequestStatus.Aborted;Network._cleanUpRequest(this)};Network.hasOpenRequests=function Network$hasOpenRequests(){return Network._requests.length>0};Network._cleanUpRequest=function Network$_cleanUpRequest(c){var b=Network._requests;for(var a=b.length-1;a>=0;a--)if(b[a]==c)b.splice(a,1)};Network._Request.prototype.send=function Network$_Request$send(e){this.context=e;if(this.status!=Network.RequestStatus.New)return;this.status=Network.RequestStatus.Executing;var b=this.resource=new XMLHttpRequest,a=this,f=function(){var b=a.resource;if(!b||!b["readyState"])return;a.httpReadyState=b.readyState;if(4==b.readyState){a.httpStatus=b.status;a.httpStatusText=b.statusText;a.httpResponseText=b.responseText;a.httpContentLength=Network.lastContentLength=b.getResponseHeader("Content-Length");a.status=Network.RequestStatus.Completed;delete a.resource;Network._cleanUpRequest(a);if(a.callback)a.callback();Network.onRequestComplete()}};b.onreadystatechange=Network.makeCallback("Network.Basic","callback",f);try{b.open(this.verb,this.url,true);if(Browser.isIE&&this.verb==="POST")b.setRequestHeader("Accept-encoding","gzip, deflate");var d=window["FunctionHelper"];if(this.headers)for(var c in this.headers){if(d&&FunctionHelper.isSpecialMember(this.headers,c))continue;b.setRequestHeader(c,this.headers[c])}if(this.postString||!Browser.isIE)this.resource.send(this.postString);else this.resource.send();return true}catch(g){this.resource.abort();delete this.resource;this.status=Network.RequestStatus.Error;Network._cleanUpRequest(a);Network.onRequestComplete();return false}};Network._fppPrevious=null;Network.FppParamType={String:"__string",Date:"__date",Array:"__array",oArray:"__oArray",Primitive:"__primitive",Object:"__object",Enum:"__enum",Custom:"__custom"};Network.onFppError=Network.onPreInvoke=Network.onPostCallback=Network.onexception=Network.EmptyFunction;Network.createFppMethod=function Network$createFppMethod(d,c,e,b){var a=Network._fppPrevious;if(null!=a&&null!=a._request)a._request.abort();return Network._fppPrevious=new Network._FppMethod(d,c,e,b)};Network._FppMethod=function Network$_FppMethod(c,b,d,a){this.className=c;this.methodName=b;this.callback=d;this.callbackError=a;this.context=null;this._request=null;this._isInvoked=false;this._params=[]};var _Network$_FppMethod$prototype=Network._FppMethod.prototype;_Network$_FppMethod$prototype._HTTP_HEADERS={"X-FPP-Command":"0","Content-Type":"application/x-www-form-urlencoded"};_Network$_FppMethod$prototype.addParameter=function Network$_FppMethod$addParameter(a,b){this._params.push({fppType:a,value:b})};_Network$_FppMethod$prototype.invoke=function Network$_FppMethod$invoke(k){this.context=k;if(!Network.configuration)throw new Error("Network is not configured.");if(this._isInvoked)throw new Error("FppMethod object already used.");this._isInvoked=true;var h,i,g="",i,h,l,a=Network.configuration,e=this._params,f=e.length;if(0<f){var d=[],j=_Web$Network$FppProxy$TypeSystem.prototype.escape;for(var c=0;c<f;c++)d.push(j.call({type:e[c].fppType},e[c].value),",");d.pop();g=d.join("")}i=[a.RequestHandler,"?cnmn=",this.className,".",this.methodName,"&a=",escape(a.SessionId),"&au=",a.AuthUser,"&ptid=",a.PartnerId||"0"].join("");h=["cn=",this.className,"&mn=",this.methodName,"&d=",g,"&v=",a.FppVersion,"&",a.CanaryToken,"=",a.CanaryValue].join("");var b=this._request=Network.createRequest(i,_Network$_FppMethod$prototype._callback,"POST");b.headers=Network._FppMethod.prototype._HTTP_HEADERS;b.postString=h;Network.onPreInvoke(b);b.send(this)};_Network$_FppMethod$prototype._callback=function Network$_FppMethod$_callback(){var request=this,fppMethod=request.context;if(4!=request.httpReadyState)return;Network._fppPrevious=null;var pkg={ErrorCode:0,Context:fppMethod.context,Proxy:request,Error:null};try{if(null==request.httpStatusText||""==request.httpStatusText)pkg.ErrorCode=-5;else if(200!=request.httpStatus&&500!=request.httpStatus)pkg.ErrorCode=-7}catch(ex){pkg.ErrorCode=-5}if(0!=pkg.ErrorCode){Network._FppMethod._raiseError(fppMethod,pkg);return}var oFppPkg;try{oFppPkg=eval(request.httpResponseText)}catch(ex){pkg.ErrorCode=-6;pkg.Error=ex;try{pkg.HttpResponseText=request.httpResponseText}catch(eex){}Network._FppMethod._raiseError(fppMethod,pkg);return}if(0==oFppPkg.Status){if(fppMethod.callback){var arrArgs=oFppPkg.OutRefParams;arrArgs.unshift(fppMethod.context);arrArgs.unshift(oFppPkg.Value);fppMethod.callback.apply(null,arrArgs)}Network.onPostCallback()}else{pkg.ErrorCode=oFppPkg.Status;pkg.Error=oFppPkg.Error;Network._FppMethod._raiseError(fppMethod,pkg)}};Network._FppMethod._raiseError=function Network$_FppMethod$_raiseError(a,c){var b=a.callbackError||Network.onFppError;b(a,c)};var Web={},_Web$Network=Web.Network={},_Web$Network$FppProxy=_Web$Network.FppProxy=function Web$Network$FppProxy(a){this._namespace=a};_Web$Network$FppProxy.escape=function Web$Network$FppProxy$escape(b){if(null==b)return b;var a="";if(0==Network.configuration.Version){a=b.toString();a=encodeURIComponent(a.replace(/([\{|\}\[|\]\,\\])/g,"\\$1"))}else{a=['"',b.toString().replace(/"/g,'\\"'),'"'].join("");a=encodeURIComponent(a.replace(/([|\{\}\[\]\,:]|\\(?!"))/g,"\\$1"))}return a};_Web$Network$FppProxy.arrayToString=function Web$Network$FppProxy$arrayToString(c){if(!c)return "";var a=["["],d=c.length;for(var b=0;b<d;b++)a.push(_Web$Network$FppProxy.objToStringImpl(c[b]),",");if(b>0)a.pop();a.push("]");return a.join("")};_Web$Network$FppProxy.objToStringImpl=function Web$Network$FppProxy$objToStringImpl(a){var b=[];if(a==null||typeof a=="undefined")b.push("null");else switch(a.constructor){case String:b.push(_Web$Network$FppProxy.escape(a));break;case Array:b.push(_Web$Network$FppProxy.arrayToString(a));break;case Object:if(true==a.__isFppObject)b.push(a.toString());else b.push(_Web$Network$FppProxy.objToString(a));break;default:b.push(a.toString())}return b.join("")};_Web$Network$FppProxy.objToString=function Web$Network$FppProxy$objToString(b){var a=["{"];for(var c in b)a.push(_Web$Network$FppProxy.escape(c),":",_Web$Network$FppProxy.objToStringImpl(b[c]),",");a.pop();a.push("}");return a.join("")};var _Web$Network$FppProxy$TypeSystem=_Web$Network$FppProxy.TypeSystem=function Web$Network$FppProxy$TypeSystem(b,a){if(a){this.name=a;this.type=b}else{this.name=b;this.type=Network.FppParamType.Custom}return this};_Web$Network$FppProxy$TypeSystem.prototype.toString=function Web$Network$FppProxy$TypeSystem$toString(){return this.name};_Web$Network$FppProxy$TypeSystem.prototype.escape=function Web$Network$FppProxy$TypeSystem$escape(a){if(null==a||"undefined"==typeof a)return "null";switch(this.type){case "__string":return _Web$Network$FppProxy.escape(a);case "__date":return _Web$Network$FppProxy.dateToISO8601(a);case "__array":return _Web$Network$FppProxy.arrayToString(a,false);case "__oArray":case "__object":return _Web$Network$FppProxy.objToStringImpl(a);case "__primitive":case "__enum":return a;default:return a.__isFppObject==true?a:_Web$Network$FppProxy.objToString(a)}};Web.Flags={};Web.Flags.create=function Web$Flags$create(){var b={},c=arguments.length;for(var a=0;a<c;a+=2)b[arguments[a]]=arguments[a+1];return b};_Web$Network$FppProxy.prototype._inflateClass=function Web$Network$FppProxy$_inflateClass(c,a){function b(){var d=a.length,b={};for(var c=0;c<d;c++)b[a[c]]=arguments[c];b.toString=function(){var c=[];c.push("{");for(var e=0;e<d;e++)c.push(a[e].escape(b[a[e]]),",");if(0<d)c.pop();c.push("}");return c.join("")};b.__isFppObject=true;return b}return b};_Web$Network$FppProxy.prototype.registerFppClass=function Web$Network$FppProxy$registerFppClass(a,b){this[a]=this._inflateClass(a,b)};_Web$Network$FppProxy["__string"]=function(a){return new _Web$Network$FppProxy$TypeSystem("__string",a)};_Web$Network$FppProxy["__date"]=function(a){return new _Web$Network$FppProxy$TypeSystem("__date",a)};_Web$Network$FppProxy["__array"]=function(a){return new _Web$Network$FppProxy$TypeSystem("__array",a)};_Web$Network$FppProxy["__oArray"]=function(a){return new _Web$Network$FppProxy$TypeSystem("__oArray",a)};_Web$Network$FppProxy["__primitive"]=function(a){return new _Web$Network$FppProxy$TypeSystem("__primitive",a)};_Web$Network$FppProxy["__object"]=function(a){return new _Web$Network$FppProxy$TypeSystem("__object",a)};_Web$Network$FppProxy["__enum"]=function(a){return new _Web$Network$FppProxy$TypeSystem("__enum",a)};_Web$Network$FppProxy["__custom"]=function(a,b){return new _Web$Network$FppProxy$TypeSystem(a,b)};_Web$Network.Type={XMLPost:0};_Web$Network$FppProxy.prototype.registerFppMethod=function Web$Network$FppProxy$registerFppMethod(name,params,mn,tm,g,ns){var paramsLen=params.length,dynamic=["new Function("],paramBody=[];for(var i=0;i<paramsLen;i++){dynamic.push('"',params[i].name,'",');paramBody.push('f.addParameter(\\"',params[i].type,'\\",',params[i].name,");")}dynamic.push('"cb","ctx","cbError",');dynamic.push('"');dynamic.push('var f = Network.createFppMethod(\\"',ns,'\\",\\"',mn,'\\",cb,cbError);');dynamic.push(paramBody.join(""));dynamic.push("f.invoke(ctx);");dynamic.push('")');this[name]=eval(dynamic.join(""))};if(!window.Resize)window.Resize={};Resize._em2PxRatio=13.267;Resize.calibrate=function Resize$calibrate(){if($("EM2PX"))Resize._em2PxRatio=$("EM2PX").offsetWidth/parseFloat($("EM2PX").style.width)};Resize.convertToPx=function Resize$convertToPx(a){return a*Resize._em2PxRatio};Resize.convertToEm=function Resize$convert(a){return a/Resize._em2PxRatio};Resize.convertToEmIfNecessary=function Resize$convertToEmIfNecessary(b){var a=parseFloat(b)||0;return (b+"").indexOf("em")<0?Resize.convertToEm(a):a};Resize._OnEMChange=function Resize$_OnEMChange(){Resize.calibrate()};Resize.OnLoad=function Resize$OnLoad(){if(Resize._loaded)return;Resize.calibrate();Resize._loaded=true};if(window.Type)Type.createStaticClass(Resize,"Resize");if(!Browser.isIE6){window.attachEvent("onload",function(){Resize.OnLoad()});window.setTimeout(function(){Resize.OnLoad()},100)}var Tracking={};Tracking.addPS=function Tracking$addPs(c,b){if(typeof b=="undefined"||b==null)b="";var g=["3rdPartyCleargif","OfficeLiveCleargif","cleargif"];for(var e=g.length-1;e>=0;e--){var a=document.getElementById(g[e]);if(a){a.removeAttribute("src");var d="",f=(new Date).getTime();switch(a.id){case "3rdPartyCleargif":a.src=a.getAttribute("name");break;case "OfficeLiveCleargif":d=String.format("{0}&cb={1}",c?c:"0",f);a.src=a.getAttribute("name")+d;break;case "cleargif":d=String.format("{0}&cb={1}{2}",c?c:"0",f,b);a.src=a.getAttribute("name")+d}}}};Type.createStaticClass(Tracking,"Tracking");if(!window.FireAnt)window.FireAnt={};FireAnt.Debug={};FireAnt.attachWatson=true;FireAnt.Debug.initialize=function FirAnt$initialize(){FireAnt.Debug.onJsError=FireAnt.Debug.addData=function(){};function a(d,c,l){var e=[],f=[],k=true;try{c=c?c.toString():"NO_URL_AVAILABLE"}catch(b){c="INVALID_URL_STRING"}try{d=d?d.toString():"unknown error"}catch(b){d="uncaught exception - INVALID_MESSAGE_STRING"}var g,a;try{g=window.__lastKnownException?window.__stack[0]:arguments.callee.caller}catch(b){g=function p(){}}try{a=g&&g.toString?g.toString():"GLOBAL_CODE";if(a.length>=256)a=a.substr(0,256)+"..."}catch(b){a="INVALID_FUNCTION_BODY"}var j=d.indexOf("uncaught exception")==0||c.length==0||c.indexOf("mail.aspx")<0||c.endsWith(".js")||c.indexOf("javascript:")==0||a=="[object Object]"||a.indexOf("FSCommand")>=0||a.indexOf("ebScriptWin")>=0||a.indexOf("flash")>=0||a.indexOf("dart")>=0,h=a=="[object Object]"?d:FireAnt.Debug._getMethodName(g)||a;if(j)h="[Silent Error] "+h;var i="can't get location.hostname";try{i=location.hostname}catch(o){try{i=i+"; document.domain = "+document.domain}catch(n){}}e.push(["<b>date</b>="+new Date,"<b>Browser</b>="+navigator.userAgent,"<b>Host</b>="+i,"<b>msg</b>="+h,"<b>error</b> = "+d,"<b>url</b>="+c,"<b>line</b>="+l].join("<br>"));f.push(["Exception Details:","msg  = "+h,"url  = "+c,"line = "+l,"user-agent = "+navigator.userAgent,"calling-function = "+a,"browser-message = "+d].join("<br>\r\n"));try{FireAnt.Debug.addData(e,f)}catch(b){e.push(String.format("<b>Adding of metadata failed</b> - {0}<br>",b.message));f.push(String.format("Adding of metadata failed - {0}<br>\r\n",b.message))}e.push('<br><br><b>Callstack:</b><pre style="font-size:10pt;margin:0px;">');f.push("<br>\r\n<br>\r\nCallstack:<br>\r\n");try{k=FireAnt._buildStackTrace(g,e,f)}catch(b){e.push(String.format("<b>Building of Stack Trace Failed</b> - {0}<br>",b.message));f.push(String.format("Building of Stack Trace Failed - {0}<br>\r\n",b.message))}try{e.push("</pre>");if(k)FireAnt.Debug.onJsError({isSilent:j,message:d,usermsg:e.join("<br>"),trace:f.join("<br>\r\n")})}catch(b){try{FireAnt.Debug.catastrophicFailure(b.message)}catch(m){window.status=m.message}}return true}if(FireAnt.attachWatson)window.onerror=a};FireAnt.Debug.catastrophicFailure=function FireAnt$Debug$catastrophicFailure(b){var a=String.format("Catastrophic Failure During Error Reporting:<br>\r\n{0}",b);HM.ReportError(a)};FireAnt.Debug._expandArguments=function FireAnt$Debug$_expandArguments(i,h){var b=[],f=i.split(",");if(f[0]){var g=f.length;for(var d=0;d<g;d++){if(d>0)b.push(", ");var a=h[d];b.push(f[d].trim()+":");if(a==null){a="null";b.push(a)}else if(typeof a=="undefined"){a="undefined";b.push(a)}else if(typeof a=="string"){if(a.length>36)a=a.substr(0,36)+"...";b.push("'"+a+"'")}else if(typeof a=="function"){var c=FireAnt.Debug._getMethodName(a);if(!c){c=a.toString();c.substr(0,c.indexOf("("))}b.push(c)}else if(typeof a=="object")if(typeof a.toString=="function"&&!Browser.isSF3)b.push(a.toString());else b.push("object");else if(typeof a=="boolean")b.push(a?"true":"false");else{var e=a.toString();if(e.length>36)e=e.substr(0,36)+"...";b.push(e)}}}return b.join("")};FireAnt.Debug._getMethodName=function FireAnt$Debug$_getMethodName(c){if(!c)return null;if(c.__debugName)return c.__debugName;for(var d in window.__classes){var a=window.__classes[d];for(var b in a){if(FunctionHelper.isSpecialMember(a,b))continue;if(typeof a[b]=="function"&&a[b].__original===c||a[b]===c)return a[b].__debugName||d+"."+b}if(a.prototype){a=a.prototype;for(var b in a){if(FunctionHelper.isSpecialMember(a,b))continue;if(typeof a[b]=="function"&&a[b].__original===c||a[b]===c)return a[b].__debugName||d+"."+b}}}return null};FireAnt._buildStackTrace=function FireAnt$IE$_buildStackTrace(i,j,f){var a=i,c=0;while(a&&c<10){var b=a.toString(),e=FireAnt.Debug._getMethodName(a)||b.substring("function ".length,b.indexOf("(")),h=b.indexOf("(")+1,g=b.indexOf(")"),d=FireAnt.Debug._expandArguments(b.substring(h,g),a.arguments);j.push("<b>"+e+"</b>("+d+")");f.push(e+"("+d+")");a=a.caller;c++}return c>0?true:false};FireAnt._buildStackTrace=function FireAnt$Moz$_buildStackTrace(m,g,e){if(window.__lastKnownException){var f=window.__stack||[],l=f.length;for(var b=0;b<l&&b<10;b++)try{var c=f[b],a=c.toString(),i=FireAnt.Debug._getMethodName(c)||a.substring(String("function ").length,a.indexOf("(")),k=a.indexOf("(")+1,j=a.indexOf(")"),h=FireAnt.Debug._expandArguments(a.substring(k,j),c.args);g.push("<b>"+i+"</b>("+h+")");e.push(i+"("+h+")")}catch(d){g.push(String.format("<b>Failed to get stack frame - {0}</b>",d.message));e.push(String.format("Failed to get stack frame - {0}",d.message));continue}window.__lastKnownException=null;return true}else return false};FireAnt._buildStackTrace=FunctionHelper.wrapMethod("FireAnt","_buildStackTrace",FireAnt._buildStackTrace);Network.reportError=function Network$_reportError(a){HM.ReportError(a)};Network.onFppError=function Network$_onFppError(h,a){if(h.methodName=="ReportError")return;var d="can't get location.hostname";try{d=location.hostname}catch(g){try{d=d+"; document.domain = "+document.domain}catch(o){}}var l="can't get url";try{l=location.href}catch(g){}var k="cant get user agent";try{k=navigator.userAgent}catch(g){}var i="";try{var e=a.Error;if(e){var j=[e.toString()];for(var m in e)j.push(m+" : "+e[m]);i=j.join(",<br>\r\n")}}catch(g){}var n=a.HttpResponseText||"",c=String.format("Exception Details:<br>\r\nmsg = [Silent Error] {0} {1} {2}.{3}<br>\r\nuseragent = {4}<br>\r\nhostname = {5}<br>\r\nurl = {6}<br>\r\nDetails = {7}<br>\r\nHTTP response text = {8}<br>\r\n{9}","{0}",a.ErrorCode,h.className,h.methodName,k,d,l,i,n,"{1}"),b=Res.strings.browserJSError,p=Infopane.ErrorPri.High;switch(a.ErrorCode){case HM.FppStatus.ERR_HTTP_CONNECT_FAILURE:b=Res.strings.noconnectivity;Network.reportError(String.format(c,"FPP Connection Failure"));break;case HM.FppStatus.ERR_HTTP_TIMEOUT:b=Res.strings.fppTimeout;Network.reportError(String.format(c,"FPP Time Out"));break;case HM.FppStatus.ERR_FPP_PROTOCOL:case HM.FppStatus.ERR_HTTP_PARSE_FAILURE:case HM.FppStatus.ERR_HTTP_MISCONFIGURATION:Network.reportError(String.format(c,"FPP Internal Error",String.format("Status:{0}<br>\r\nStatus Text:{1}<br>\r\n",a.Proxy.httpStatus,a.Proxy.httpStatusText)));b=Res.strings.fppInternalErr;break;case HM.FppStatus.ERR_SERVER_UNCAUGHT:case HM.FppStatus.ERR_APP_SPECIFIC:if(a.Error.ErrorObj.IsBlocking)Infopane.showBlocking(a.Error.ErrorObj.Message);else{var f=Infopane.getInstance();f.setContent(a.Error.ErrorObj.Message);$addClass(f.child,"BorderNoTop");f.attachEvent("onclick",function(){if("A"==event.srcElement.tagName)Infopane.hide()});f.show()}return;default:throw new Error(String.format(c,"Unrecognized FPP Error Code"));}b=decodeURIComponent(b);Infopane.show(b,{pri:Infopane.ErrorPri.High})};function Infopane(a){Control.create(this,a);Events.init(this);this._onclickHandler=Delegate.create(this,this._onclick);this.elt.attachEvent("onclick",this._onclickHandler);this.child=this.elt.children[0]?this.elt.children[0].children[0]:null;if(this.child){this._pri=this.child.getAttribute("pri")||"Low";if("Low"==this._pri&&!$containsClass(this.child,"ErrorPriLow"))$addClass(this.child,"ErrorPriLow")}}__p=Infopane.prototype={userdata:null,child:null};__p.dispose=function Infopane$dispose(){this.elt.detachEvent("onclick",this._onclickHandler);this.child=null;Control.destroy(this)};__p._onclick=function Infopane$_onclick(){this.fireEvent("onclick",[this,{}])};__p.show=function Infopane$show(){$setDisplay(this.elt,true);Resize._ipaneResize()};__p.hide=function Infopane$hide(){var a=this.elt,b=a.children[a.children[0].tagName=="S"?1:0].children[0];if(!b||!$containsClass(b,"Sticky"))$setDisplay(a,false);Resize._ipaneResize()};__p.setPriority=function Infopane$setPriority(a){if(!$replaceClass(this.child,"ErrorPri"+this._pri,"ErrorPri"+a))$addClass(this.child,"ErrorPri"+a);this._pri=a;this.child.setAttribute("pri",a)};__p.setContent=function Infopane$setContent(a){this.elt.innerHTML=a;this.child=this.elt.children[0]?this.elt.children[0].children[0]:null};Infopane._instance=null;Infopane.ErrorPri={Low:"Low",Medium:"Medium",High:"High"};Infopane.getInstance=function Infopane$getInstance(a){if(!Infopane._instance&&(a===undefined||a))Infopane.initialize();return Infopane._instance};Infopane.show=function Infopane$show(c,b){b=b||{};var a=Infopane.getInstance(true);a.setContent(String.format($("tmpl_infopane").innerHTML,c||""));a.setPriority(b.pri||Infopane.ErrorPri.Low);a.show();return a};Infopane.hide=function Infopane$hide(){if(Infopane._instance)Infopane._instance.hide()};Infopane.showBlocking=function Infopane$showBlocking(a){alert(a)};Infopane.initialize=function Infopane$initialize(){Infopane._instance=new Infopane($("infoPaneContainer"))};Infopane.cleanup=function Infopane$cleanup(){if(Infopane._instance){Infopane._instance.dispose();Infopane._instance=null}};Events.addEventing(Infopane);Infopane.createClass("Infopane");var LoadingIndicator={_elt:null,_HTML:"<span>{0}</span>",_timeoutObj:null,waitTime:1e3,cursorWaitTime:200};LoadingIndicator._showImpl=function LoadingIndicator$_showImpl(){var a=document.createElement("div");document.body.appendChild(a);LoadingIndicator._elt=a;a.className="LoadingIndicator BorderBox BoldText";LoadingIndicator._position(a);a.style.zIndex=1;a.style.bottom="0em";a.style[Loc.LEFT]="0em";a.innerHTML=Page.decode(Res.strings.loading);$setDisplay(a,true)};LoadingIndicator.show=function LoadingIndicator$show(){LoadingIndicator.hide();LoadingIndicator._cursorTimeoutObj=setTimeout(function(){LoadingIndicator._showProgressCursor(true)},LoadingIndicator.cursorWaitTime);LoadingIndicator._timeoutObj=setTimeout(LoadingIndicator._showImpl,LoadingIndicator.waitTime)};LoadingIndicator._showProgressCursor=function LoadingIndicator$_showProgressCursor(a){document.body.style.cursor=a?"progress":"auto"};LoadingIndicator._position=function LoadingIndicator$_position(a){a.style.position="fixed"};LoadingIndicator.hide=function LoadingIndicator$hide(){clearTimeout(LoadingIndicator._cursorTimeoutObj);LoadingIndicator._cursorTimeoutObj=null;LoadingIndicator._showProgressCursor(false);clearTimeout(LoadingIndicator._timeoutObj);LoadingIndicator._timeoutObj=null;if(LoadingIndicator._elt){$setDisplay(LoadingIndicator._elt,false);document.body.removeChild(LoadingIndicator._elt)}LoadingIndicator._elt=null};if(Browser.isIE6){LoadingIndicator._reposition=function LoadingIndicator$_position(){this.style.bottom="0px";this.style.bottom="0em"};LoadingIndicator._position=function LoadingIndicator$IE6$_position(a){a.style.position="absolute";LoadingIndicator._handler=Delegate.create(a,LoadingIndicator._reposition);window.attachEvent("onscroll",LoadingIndicator._handler)};var oldHide=LoadingIndicator.hide;LoadingIndicator.hide=function LoadingIndicator$hide(){oldHide.call(this);if(LoadingIndicator._handler)window.detachEvent("onscroll",LoadingIndicator._handler)}}Type.createStaticClass(LoadingIndicator,"LoadingIndicator");if(typeof PerfRecorder!="undefined"&&PerfRecorder){PerfRecorder._rollDice=function PerfRecorder$_rollDice(a){if(0==a)return false;else if(1==a)return true;else return Math.random()<=1/a};PerfRecorder._assembleGT1Param=function PerfRecorder$_assembleGT1Param(e){var f=Cookie.getCookieValues(PerfRecorder.config.cookieName),i=Cookie.getCookieValues("wlidperf"),h=PerfRecorder._calculateTime(f),d=PerfRecorder._getStartTimerPageName(f),c=(true==PerfRecorder._isAjaxCall?"":d+":")+e;if(!PerfRecorder._isAjaxCall&&""==d||h<=0||(e==null||e==""))return "";var a=String.format(PerfRecorder._assemblyString(),Cookie.getCookieValues("ANON")["A"],i["latency"],i["throughput"],PerfRecorder._getCluster(),PerfRecorder.config.market,c,h,PerfRecorder.config.delimiter,PerfRecorder._getAuxillaryData(f,d,h));if(PerfRecorder._DataObject){var j=PerfRecorder._DataObject[c];if(j){var b=j();if(b&&typeof b=="object"){var g=[];for(var k in b)g.add(String.format("{0}={1}",k,b[k]));if(g.length>0)a=a+PerfRecorder.config.delimiter+g.join(PerfRecorder.config.delimiter)}}}if(PerfRecorder._isForPltDetection(c))a=a+PerfRecorder._getPltMode();return a};PerfRecorder._getAuxillaryData=function PerfRecorder$_getAuxillaryData(d,e,a){var c="",b=0;if(PerfRecorder._payload>0){if(a>0)b=Math.round(PerfRecorder._payload/1024*8/a);c=String.format(PerfRecorder._assemblyAuxString(),PerfRecorder.config.delimiter,Math.round(PerfRecorder._payload/1024*10)/10,b);PerfRecorder._payload=0}if("S"==e){if(a>0)b=Math.round(d["p"]/1024*8/a);c=String.format(PerfRecorder._assemblyAuxString(),PerfRecorder.config.delimiter,Math.round(d["p"]/1024*10)/10,b)}return c};PerfRecorder._isForPltDetection=function PerfRecorder$_isForPltDetection(c){var a=PerfRecorder.config.pltTransList.split(",");if(a&&a.length>0)for(var b=a.length-1;b>=0;b--)if(a[b].indexOf(c)>=0)return true;return false};PerfRecorder._getPltMode=function PerfRecorder$_getPltMode(){try{var b="";if(Browser.isIE){var a=null==PerfRecorder._requestObj?(PerfRecorder._requestObj=new ActiveXObject("Microsoft.XMLHTTP")):PerfRecorder._requestObj;if(null!=a){var c=(new Date).getTime();a.open("GET",PerfRecorder.config.pltImg,false);a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=(new Date).getTime()-c,d=a.getResponseHeader("Date")==""?"2":"1";b=String.format(PerfRecorder._assemblyPltString(),PerfRecorder.config.delimiter,d,e>0&&d=="1"?e:"NA")}};a.send()}}return b}catch(d){return ""}};PerfRecorder._assemblyString=function PerfRecorder$_assemblyString(){return PerfRecorder.config.reportMode==1?PerfRecorder._IdssStr:PerfRecorder._OmnitureStr};PerfRecorder._assemblyAuxString=function PerfRecorder$_assemblyAuxString(){return PerfRecorder.config.reportMode==1?PerfRecorder._IdssAuxStr:PerfRecorder._OmnitureAuxStr};PerfRecorder._assemblyPltString=function PerfRecorder$_assemblyPltString(){return PerfRecorder.config.reportMode==1?PerfRecorder._IdssPltFlagStr:PerfRecorder._OmniturePltFlagStr};PerfRecorder._getStartTimerPageName=function PerfRecorder$_getStartTimerPageName(a){return PerfRecorder._isAjaxCall?PerfRecorder._startPageName:a["FR"]};PerfRecorder._getStartTimerDate=function PerfRecorder$_getStartTimerDate(a){return PerfRecorder._isAjaxCall?PerfRecorder._startTime:a["ST"]};PerfRecorder._calculateTime=function PerfRecorder$_calculateTime(d){var a=PerfRecorder.page.timeStamp,c=PerfRecorder._getStartTimerDate(d);if(PerfRecorder._isAjaxCall)a=(new Date).getTime();var b=a-c;return b>0?Math.round(b/1e3*10)/10:0};PerfRecorder._ensureInt=function PerfRecorder$_ensureInt(a){return isNaN(parseInt(a))?0:parseInt(a)};PerfRecorder._getCluster=function PerfRecorder$_getCluster(){var a="";try{a=document.location.hostname.substr(0,document.location.hostname.indexOf("."))}catch(b){a=document.domain}return a};PerfRecorder._isWinner=function PerfRecorder$_isWinner(){return Cookie.getCookieValues(PerfRecorder.config.cookieName)["hmt"]=="1"};PerfRecorder._setStartTimer=function PerfRecorder$_setStartTimer(b,c){var a=Cookie.getCookieValues(PerfRecorder.config.cookieName);a["FR"]=b;a["ST"]=(new Date).getTime();a["p"]=c;Cookie.setCookieValues(PerfRecorder.config.cookieName,a,Cookie.SessionCookie,PerfRecorder.config.privateDomain)};PerfRecorder._isQualifiedRequest=function PerfRecorder$_isQualifiedRequest(){var b=Cookie.getCookieValues(PerfRecorder.config.cookieName),c=PerfRecorder._ensureInt(b["LTT"]),a=((new Date).getTime()-c)/1e3/60;if(PerfRecorder._isWinner())if(PerfRecorder._ensureInt(b["RC"])<PerfRecorder._ensureInt(PerfRecorder.config.transactionLimit)&&a<PerfRecorder.config.maxSessionDuration)return true;else{PerfRecorder._killPRCookie();return false}else{if(a>PerfRecorder.config.maxSessionDuration)PerfRecorder._killPRCookie();return false}};PerfRecorder._setLoser=function PerfRecorder$_setLoser(){var a={};a["hmt"]=0;a["LTT"]=(new Date).getTime();Cookie.setCookieValues(PerfRecorder.config.cookieName,a,Cookie.SessionCookie,PerfRecorder.config.privateDomain);PerfRecorder.GT1Param="";PerfRecorder._startTime=0;PerfRecorder._resetPassportPersistantCookie(Cookie.getCookieValues("wlidperf"))};PerfRecorder._setWinner=function PerfRecorder$_setWinner(){var b=Cookie.getCookieValues("wlidperf"),c=b["FR"],d=b["ST"],a={};a["hmt"]=1;a["FR"]=c?c:"";a["ST"]=d?d:"";a["RC"]=0;a["LTT"]=(new Date).getTime();Cookie.setCookieValues(PerfRecorder.config.cookieName,a,Cookie.SessionCookie,PerfRecorder.config.privateDomain);PerfRecorder._resetPassportPersistantCookie(b)};PerfRecorder._resetPassportPersistantCookie=function PerfRecorder$_resetPassportPersistantCookie(b){var d=b["latency"],c=b["throughput"],a={};a["latency"]=d;a["throughput"]=c;Cookie.setCookieValues("wlidperf",a,Cookie.getPermanentExpirationDate(),PerfRecorder.config.sharedDomain)};PerfRecorder._killPRCookie=function PerfRecorder$_killPRCookie(){PerfRecorder.GT1Param="";PerfRecorder._startTime=0;Cookie.setCookieValues(PerfRecorder.config.cookieName,{},Cookie.SessionCookie,PerfRecorder.config.privateDomain)};PerfRecorder._isUserInit=function PerfRecorder$_isUserInit(){var a=Cookie.getCookieValues(PerfRecorder.config.cookieName);if(typeof a["hmt"]=="undefined"||!(a["hmt"]==0||a["hmt"]==1))PerfRecorder._initUser();return true};PerfRecorder._initUser=function PerfRecorder$_initUser(){if(PerfRecorder.config.allowInstrumentation&&PerfRecorder._rollDice(PerfRecorder.config.sampleFrequency))PerfRecorder._setWinner();else PerfRecorder._setLoser()};PerfRecorder.startTimer=function PerfRecorder$startTime(a,b,c){if(!PerfRecorder.config.allowInstrumentation){PerfRecorder._killPRCookie();return}if(PerfRecorder._isUserInit()&&PerfRecorder._isWinner())if(a){PerfRecorder._isAjaxCall=true;PerfRecorder._startTime=(new Date).getTime()}else PerfRecorder._setStartTimer(b,c)};PerfRecorder.stopTimer=function PerfRecorder$stopTimer(c,b){if(!PerfRecorder.config.allowInstrumentation){PerfRecorder._killPRCookie();return}if(PerfRecorder._isUserInit()&&PerfRecorder._isQualifiedRequest()){if(b)PerfRecorder._payload=b;PerfRecorder.GT1Param=PerfRecorder._assembleGT1Param(c);var a=Cookie.getCookieValues(PerfRecorder.config.cookieName),d=PerfRecorder._ensureInt(a["RC"])+1;a["FR"]="";a["ST"]="";a["RC"]=d;a["LTT"]=(new Date).getTime();Cookie.setCookieValues(PerfRecorder.config.cookieName,a,Cookie.SessionCookie,PerfRecorder.config.privateDomain)}};PerfRecorder.stopPageTimer=function PerfRecorder$stopPageTimer(){if(window._ttgTs&&window._ttgTs>0)PerfRecorder.page.timeStamp=window._ttgTs;PerfRecorder._isAjaxCall=false;PerfRecorder.stopTimer(PerfRecorder.page.landingPageName)};PerfRecorder.sendTransaction=function PerfRecorder$sendTransaction(){if(PerfRecorder.config.allowInstrumentation&&PerfRecorder.config.sendTransactionsByImage){var a=$("3rdPartyOmniture");if(a){var b=!(typeof PerfRecorder.GT1Param=="undefined"||PerfRecorder.GT1Param==null||PerfRecorder.GT1Param=="");if(b){var c=String.format("{0}{1}?{2}",a.getAttribute("name"),(new Date).getTime(),PerfRecorder.GT1Param);a.removeAttribute("src");a.src=c}}}};PerfRecorder.getPerfPayload=function PerfRecorder$getPerfPayload(){return PerfRecorder.config.allowInstrumentation&&!PerfRecorder.config.sendTransactionsByImage&&!(typeof PerfRecorder.GT1Param=="undefined"||PerfRecorder.GT1Param==null||PerfRecorder.GT1Param=="")?PerfRecorder.config.delimiter+"GT1="+PerfRecorder.GT1Param:""};PerfRecorder.registerAuxPageDataCallback=function PerfRecorder$registerAuxPageDataCallback(b,a){PerfRecorder._DataObject[b]=a};PerfRecorder.unregisterAuxPageDataCallback=function PerfRecorder$unregisterAuxPageDataCallback(a){if(PerfRecorder._DataObject[a])delete PerfRecorder._DataObject[a]};PerfRecorder.GT1Param="";PerfRecorder._startTime=1;PerfRecorder._startPageName="";PerfRecorder._isAjaxCall=false;PerfRecorder._currentView="";PerfRecorder._payload=0;PerfRecorder._requestObj=null;PerfRecorder._IdssStr="ANON={0}{7}NL={1}{7}TP={2}{7}CL={3}{7}MA={4}{7}TR={5}{7}PLT={6}{8}";PerfRecorder._OmnitureStr="c1={0}{7}c10={1}{7}c9={2}{7}server={3}{7}c2={4}{7}pageName={5}{7}c3={6}{8}";PerfRecorder._OmnitureAuxStr="{0}c8={1}{0}c11={2}";PerfRecorder._IdssAuxStr="{0}SZ={1}{0}TPRS={2}";PerfRecorder._OmniturePltFlagStr="{0}c4={1}{0}c13={2}";PerfRecorder._IdssPltFlagStr="{0}PLM={1}{0}NET={2}";PerfRecorder._DataObject=[]}var Cookie={};Cookie.getCookie=function Cookie$getCookie(e){var d=document.cookie.split(";"),g=d.length;for(var c=0;c<g;c++){var a=d[c],b=a.indexOf("=");if(b!=-1){var f=a.substring(0,b).trim();if(f==e)return a.substring(b+1,a.length).trim()}}return null};Cookie.getCookieValues=function Cookie$getCookieValues(f){var a=Cookie.getCookie(f),b=null,e={};if(a&&a.length>0){if(a.indexOf("&")>=0)b=a.split("&");else if(a.indexOf("=")>=0)b=[a];if(b)for(var c=0;c<b.length;c++){var d=b[c].split("=");e[d[0]]=d[1]}}return e};Cookie.setCookieValues=function Cookie$setCookieValues(g,c,e,a,f){var b=[];for(var d in c){if(FunctionHelper.isSpecialMember(c,d))continue;b.push(escape(d),"=",escape(c[d]),"&")}if(b.length>0)b.pop();a=a||App.config.cookieDomain;document.cookie=String.format("{0}={1};{2}path={3};{4}",g,b.join(""),a?"domain="+a+";":"",f?f:"/",e?"expires="+e.toUTCString()+";":"")};Cookie.getPermanentExpirationDate=function Cookie$getPermanentExpirationDate(){var a=new Date;return new Date(a.getUTCFullYear()+1,a.getUTCMonth(),a.getUTCDay())};Cookie.SessionCookie=undefined;Page.reauth=function Page$reauth(a,b){if(a.length>0)document.cookie=newRPSCookie;Page.fppCfg.CanaryValue=Cookie.getCookie(b)};function Reauth(){if(Page["onreauth"]!=null)Page.onreauth();$setDisplay($("divInfoPane"),true)}Page.submit=function Page$submit(c,a){var d=$("ToolbarActionItem"),b=$(Page.FORM_ID);if(a&&a.length>0)b.action=a;if(c)d.value=c;Page.submitForm(b)};Page.doInfoPanePost=function Page$doInfoPanePost(a){var c=$("InfoPaneActionItem"),b=$(Page.FORM_ID);c.value=a;Page.submitForm(b)};Page.submitForm=function Page$submitForm(a){Page._initializeForm();if(top.isPersistenceInline)PersistenceMerge.submitForm(a);else a.submit()};Page.blockEnter=function Page$blockEnter(){var a=event.keyCode,b=event.returnValue;if((a==3||a==13)&&b!=1)return false;return true};Page.initialize=function Page$initialize(){Page._initializeForm();window.attachEvent("onload",Page._window_onload)};Page._initializeForm=function Page$_initializeForm(){var b=$("mt");if(""!=b.value)return;b.value=Cookie.getCookie("mt");if(Page.FORM_ID){var a=$(Page.FORM_ID);a._submit=a.submit;a.submit=function(){if(a.onsubmit&&a.onsubmit()==false)return;setTimeout(function(){try{a._submit()}catch(b){}},0)}}};Page._window_onload=function Page$_window_onload(){window.detachEvent("onload",Page._window_onload);setTimeout(Page._initialResize,200);Page._registerPerfDataHandlers();PerfRecorder.stopPageTimer();Tracking.addPS(PS,PerfRecorder.getPerfPayload());PerfRecorder.sendTransaction();Page._unregisterPerfDataHandlers();setTimeout(Page.fireAds,1e3);var a=$("uxp_ftr_link_feedback");if(a)a.attachEvent("onclick",function(){Page.addFeedbackData(a)});setTimeout(Page.fireLoadDelayedImages,2550)};Page.fireLoadDelayedImages=function Page$fireLoadDelayedImages(){Page._changeSrcTosFromBaseElt("WNControl");Page._changeSrcTosFromBaseElt("ATNControl")};Page._changeSrcTosFromBaseElt=function Page$_changeSrcTosFromBaseElt(c){var a=$tag($(c),"IMG");if(!a)return;for(i=a.length;i--;){var b=a[i].getAttribute("SRCTO");if(b){a[i].setAttribute("SRCTO","");a[i].src=b;a[i].setAttribute("SRC",b)}}};Page._initialResize=function Page$_initialResize(){Resize._headerResize();Resize._ipaneResize();if(Page.oninitresize!=null)Page.oninitresize()};Page.decode=function Page$decode(a){return decodeURIComponent(a)+""};Resize._mainContentResize=function Resize$_mainContentResize(){Resize._ipaneResize()};Resize._resizeToolbar=function Resize$_resizeToolbar(h,i,g){h.style.height="";var k=h.offsetHeight,c=null,e=0;for(var a=i.children.length-1;a>=0;a--){if(i.children[a].currentStyle.display=="none")continue;c=i.children[a];var d=c.currentStyle;e=parseInt(d.paddingTop)+parseInt(d.paddingBottom)+parseInt(d.marginTop)+parseInt(d.marginBottom);break}if(c){var f=c.offsetHeight,j=c.offsetTop,b=f+j;if(e>0&&f>0)b+=e*Math.ceil(j/f);b=b<k?"":Resize.convertToEm(b)+"em";h.style.height=b;for(var a=g.length-1;a>=0;a--)if(g[a])g[a].style.top=b}};Resize._headerResize=function Resize$_headerResize(){try{Resize._mainContentResize();$("Middle").style.top=Resize.convertToEm($("HeaderContainer").offsetHeight)+"em"}catch(a){return}};Resize._ipaneResize=function Page$_ipaneResize(){try{var b="",a=$("infoPaneContainer"),c=$("IAPWrapper"),d=$("toolbarContainer");Resize._resizeToolbar(d,d.children[0],[$("infoPaneContainer"),$("ManagedContentWrapper"),$("IAPWrapper")]);if($getDisplay(a)){b=Resize.convertToEm(a.offsetTop+a.offsetHeight+2)+"em";$("ManagedContentWrapper").style.top=b;if(c)c.style.top=b}else $removeClass($("contentRight"),"HasInfoPaneAbove")}catch(e){return}};Page.showMessage=function Page$showMessage(e,c,d,b,f){var g=c!=null&&c.length>0,h=d!=null&&d.length>0;if(g||h){var i=b!=null&&b.length>0,a=confirm(e)?c:d;if(a!=null&&a.length>0)if(i)if(b=="_blank")window.setTimeout("window.open('"+a+"', '"+b+"').focus()",200);else window.open(a,b);else if(f)Page.doInfoPanePost(a);else Page.submit(a)}else alert(e)};registerNamespace=function(e){var a=window,d=e.split("."),f=d.length;for(var c=0;c<f;c++){var b=d[c];if(!a[b])a[b]={};a=a[b]}};function RefreshAds(){var a=InboxPage.Ads;if(++a.actionCt>=App.config.adsMinActions){var c=new Date,d=(c-a.lastRefreshTime)/1e3;if(App.config.adsMinInterval<d){a.lastRefreshTime=new Date;a.actionCt=0;try{dapMgr.trackEvent(eventType.click)}catch(b){}}}try{InboxPage.resetSkyscraperScroll(false)}catch(b){}}function SearchInbox(){try{var a="/mail/InboxLight.aspx?SearchEmailKeyWord="+encodeURIComponent($("productSearchTerms").value)+"&n="+Page.queryString.newNonce;Page.navigateTo(a)}catch(b){}return false}Page.fireAds=function Page$fireAds(){if(typeof g_adsToFire!="undefined"){var c=g_adsToFire.length;if(c>0)for(var b=0;b<c;b++){var a=g_adsToFire[b];if(typeof dapMgr!="undefined"){try{dapMgr.enableACB(a[0],a[4])}catch(d){}try{dapMgr.renderAd(a[0],a[1],a[2],a[3])}catch(d){}}}}};Page.getLayout=function Page$getLayout(){return document.body.getAttribute("layout")};Page.postWithFolderCache=function Page$postWithFolderCache(i,j,k){var e=$("folderList"),d=$(i);if(e!=null&&d){var b="",f=d.getAttribute("maxFolders"),a=$tag(e,"LI");if(f!=null&&a.length<=f){for(var c=a.length-1;c>=0;c--){var g=$tag(a[c],"A"),h=g.length>0?g[0].title:"";if(-1!=h.indexOf(":"))break;b=String.format("{0}/{1}/{2}/{3}:{4}",a[c].id,a[c].getAttribute("count"),h,a[c].getAttribute("d"),b)}b=b.substring(0,b.length-1);d.value=b}}this.submit(j,k)};Page.navigateTo=function Page$navigateTo(a){if(top.isPersistenceInline)$BSI.informNav(a);else window.location.href=a};Page._registerPerfDataHandlers=function Page$_registerPerfDataHandlers(){if(typeof PerfRecorder=="undefined"||!PerfRecorder)return false;var a=PerfRecorder.registerAuxPageDataCallback,b="NA";if(typeof InboxPage!="undefined"&&InboxPage){if(typeof InboxPage.Config!="undefined"&&InboxPage.Config&&typeof InboxPage.Config.readingPane!="undefined"&&InboxPage.Config.readingPane)b=InboxPage.Config.readingPane.location;a("VI-LN:I",function(){return {c16:typeof InboxPage.folderList!="undefined"&&InboxPage.folderList?InboxPage.folderList.getSelectedFolderType():"NA",c20:b}});a("VI-SC:I",function(){return {c20:b}});a("L:I",function(){return Page._isMessengerActiveXLoggedIn(InboxPage)})}if(typeof TodayPage!="undefined"&&TodayPage)a("L:T",function(){return Page._isMessengerActiveXLoggedIn(TodayPage)});return true};Page._isMessengerActiveXLoggedIn=function Page$_isMessengerActiveXLoggedIn(e){var d=null,b=null,c=e;if(c.MsnIm)b=decodeURIComponent(c.MsnIm.userEmail);if(Browser.isIE&&b)try{var a=new ActiveXObject("MSNMessenger.Hotmail2Control");if(a&&a.IsUser(b)){var f=a.GetLocalUserStatus();if(f!=1)d={c21:1}}}catch(g){a=null}return d};Page._unregisterPerfDataHandlers=function Page$_unregisterPerfDataHandlers(){if(!PerfRecorder)return;var a=PerfRecorder.unregisterAuxPageDataCallback;if(typeof InboxPage!="undefined"&&InboxPage){a("VI-LN:I");a("VI-SC:I");a("L:I")}if(typeof TodayPage!="undefined"&&TodayPage)a("L:T")};Type.createStaticClass(Page,"Page");Page.initialize();function DoHelp(a){if(!(typeof a==="string"))if(typeof g_helpKey==="string")a=g_helpKey;else a="PIM_WhatsNew";try{LaunchHelp(g_helpBaseUrl,g_helpPaneProject,g_helpPaneMarket,"/mail/HelpPane.aspx","keyword",a,false,"b1","","","")}catch(b){}}HM=new Web.Network.FppProxy("HM");HM.FppStatus=Web.Flags.create("SUCCESS",0,"ERR_HTTP_MISCONFIGURATION",-7,"ERR_HTTP_PARSE_FAILURE",-6,"ERR_HTTP_CONNECT_FAILURE",-5,"ERR_HTTP_TIMEOUT",-4,"ERR_SERVER_UNCAUGHT",-3,"ERR_APP_SPECIFIC",-2,"ERR_FPP_PROTOCOL",-1);HM.registerFppClass("FppReturnPackage",[Web.Network.FppProxy.__enum("Status"),Web.Network.FppProxy.__object("Value"),Web.Network.FppProxy.__oArray("OutRefParams"),Web.Network.FppProxy.__custom(HM.FppError,"Error"),Web.Network.FppProxy.__object("ProfilingInfo")]);HM.registerFppClass("FppError",[Web.Network.FppProxy.__string("ErrorCode"),Web.Network.FppProxy.__string("Message"),Web.Network.FppProxy.__object("ErrorObj"),Web.Network.FppProxy.__string("StackTrace")]);HM.registerFppMethod("ReportError",[Web.Network.FppProxy.__string("message")],"ReportError",Web.Network.Type.XMLPost,"abortable","Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.registerFppClass("HmSimpleMsg",[Web.Network.FppProxy.__primitive("IsBlocking"),Web.Network.FppProxy.__primitive("YesCode"),Web.Network.FppProxy.__primitive("NoCode"),Web.Network.FppProxy.__string("Message")]);Loader={};Loader.load=function Loader$load(k,h,p,e){var d=[],j=0,f=document.getElementsByTagName("HEAD")[0],i=h.length,l=k.length,n=i+l,c=[],b=null!=e;if(b)var r=e;var a;for(a=0;a<l;++a)q(k[a]);for(a=0;a<i;++a)o(h[a]);if(b)r=null;function g(){++j;if(j==n){if(!b)if(Browser.isIE)m();p()}}function m(){var b=d.length,a;for(a=0;a<b;++a)f.appendChild(d[a]);d=null}function q(c){var a=document.createElement("link");a.rel="stylesheet";a.type="text/css";a.href=c;a.onreadystatechange=b;f.appendChild(a);if(!Browser.isIE)a.readyState="complete";function b(){if(a.readyState==="loaded"||a.readyState==="complete"){a.onreadystatechange=null;a=null;g()}}b()}function o(i){if(b){var a=e;c.push(i);if(1==c.length)j()}else{var a=document.createElement("script");a.type="text/javascript";if(Browser.isIE){d.push(a);a.onreadystatechange=h;a.src=i}else{a.onload=a.onerror=h;a.readyState="complete";a.src=i;f.appendChild(a)}}function j(){var b=c[0];if(Browser.isIE)a.onreadystatechange=h;else{a.onload=a.onerror=h;a.readyState="complete"}a.src=b}function h(){if("loaded"===a.readyState||"complete"===a.readyState){if(b)c=c.splice(1,c.length-1);if(Browser.isIE)a.onreadystatechange=null;else a.onload=a.onerror=null;if(!b)a=null;g();if(b)if(c.length>0)j()}}}};var KeyboardHandler={};KeyboardHandler._textElements=",BUTTON,SELECT,TEXTAREA,";KeyboardHandler._validInputTypes=",CHECKBOX,RADIO,";KeyboardHandler.Shortcuts={NOMATCH:0,MATCH:1,POTENTIALMATCH:2};KeyboardHandler.initialize=function KeyboardHandler$initialize(a,b,c,d){if(b&&a){KeyboardHandler._shortcutsTree=a;KeyboardHandler._handler=b;KeyboardHandler._needsModifierOrFunctionKey=true==d?true:false;KeyboardHandler._timeout=c>0?c:1e3;KeyboardHandler._matchFunction=null;KeyboardHandler._timeoutId=0;KeyboardHandler._resetSequence();KeyboardHandler._keyDownDelegate=Delegate.create(this,KeyboardHandler.onKeyDownWrapper);document.attachEvent("onkeydown",KeyboardHandler._keyDownDelegate)}};KeyboardHandler.attachToIframe=function KeyboardHandler$attachToIframe(d){if(d&&KeyboardHandler._shortcutsTree){var b=d.contentWindow;if(b){var a=b.document;if(a){if(!KeyboardHandler._iframeEltsAndHandlers)KeyboardHandler._iframeEltsAndHandlers=[];var c=function(){return KeyboardHandler._keyDownDelegate(b.event)};a.attachEvent("onkeydown",c);KeyboardHandler._iframeEltsAndHandlers.push({iframeDoc:a,handler:c})}}}};KeyboardHandler.dispose=function KeyboardHandler$dispose(){if(KeyboardHandler._iframeEltsAndHandlers){for(var b=KeyboardHandler._iframeEltsAndHandlers.length;b--;){var a=KeyboardHandler._iframeEltsAndHandlers[b];if(a){var d=a["iframeDoc"],c=a["handler'"];if(d&&c)d.detachEvent("onkeydown",c);KeyboardHandler._iframeEltsAndHandlers[b]=null}}KeyboardHandler._iframeEltsAndHandlers=null}if(KeyboardHandler._keyDownDelegate){document.detachEvent("onkeydown",KeyboardHandler._keyDownDelegate);KeyboardHandler._keyDownDelegate=null}KeyboardHandler._shortcutsTree=KeyboardHandler._handler=KeyboardHandler._needsModifierOrFunctionKey=KeyboardHandler._timeout=KeyboardHandler._timeoutId=KeyboardHandler._matchFunction=KeyboardHandler._sequence=null};KeyboardHandler.onKeyDownWrapper=function KeyboardHandler$onKeyDownWrapper(a){a=a||event;if(a.ctrlKey&&a.altKey){KeyboardHandler._resetSequence();return true}var c="",d=false;if(a.ctrlKey){c="CTRL";d=true}else if(a.altKey){c="ALT";d=true}if(a.shiftKey)c=c+"SHIFT";var e=a.keyCode;if(e>=112&&e<=123)d=true;var g=c+e;if(!KeyboardHandler._validatePreConditions(d,a)){KeyboardHandler._resetSequence();return true}var b=KeyboardHandler._addTermAndLookup(g);if(b==KeyboardHandler.Shortcuts.NOMATCH){var h=KeyboardHandler._sequence.length>1;KeyboardHandler._resetSequence();if(h){b=KeyboardHandler._addTermAndLookup(g);if(b==KeyboardHandler.Shortcuts.NOMATCH)KeyboardHandler._resetSequence()}}if(b==KeyboardHandler.Shortcuts.MATCH){if(KeyboardHandler._handler){var f=false;try{f=KeyboardHandler._handler(a,KeyboardHandler._matchFunction)}catch(i){}if(f)b=KeyboardHandler.Shortcuts.NOMATCH;KeyboardHandler._resetSequence();KeyboardHandler._matchFunction=null}}else if(b==KeyboardHandler.Shortcuts.POTENTIALMATCH)KeyboardHandler._setSequenceTimeout();if(b!=KeyboardHandler.Shortcuts.NOMATCH){a.returnValue=false;a.cancelBubble=true;return false}return true};KeyboardHandler._addTermAndLookup=function KeyboardHandler$_addTermAndLookup(a){KeyboardHandler._sequence.push(a);return KeyboardHandler._lookupHelper(KeyboardHandler._shortcutsTree,0)};KeyboardHandler._lookupHelper=function KeyboardHandler$_lookupHelper(a,b){if(null==a)return KeyboardHandler.Shortcuts.NOMATCH;if("string"==typeof a){KeyboardHandler._matchFunction=a;return KeyboardHandler.Shortcuts.MATCH}if(b>=KeyboardHandler._sequence.length)return KeyboardHandler.Shortcuts.POTENTIALMATCH;else return KeyboardHandler._lookupHelper(a[KeyboardHandler._sequence[b]],b+1)};KeyboardHandler._setSequenceTimeout=function KeyboardHandler$_setSequenceTimeout(){if(KeyboardHandler._timeoutId){clearTimeout(KeyboardHandler._timeoutId);KeyboardHandler._timeoutId=0}KeyboardHandler._timeoutId=setTimeout(KeyboardHandler._sequenceTimeout,KeyboardHandler._timeout)};KeyboardHandler._sequenceTimeout=function KeyboardHandler$_sequenceTimeout(){KeyboardHandler._resetSequence()};KeyboardHandler._resetSequence=function KeyboardHandler$_resetSequence(){KeyboardHandler._sequence=[];if(KeyboardHandler._timeoutId){clearTimeout(KeyboardHandler._timeoutId);KeyboardHandler._timeoutId=0}};KeyboardHandler._validatePreConditions=function KeyboardHandler$_validatePreConditions(a,b){return a||!KeyboardHandler._needsModifierOrFunctionKey&&!KeyboardHandler._isTextElt(b.srcElement)};KeyboardHandler._isTextElt=function KeyboardHandler$_isTextElt(a){var b=a.tagName?a.tagName.toUpperCase():"";return KeyboardHandler._textElements.indexOf(["",b,""].join(","))>=0||"INPUT"==b&&KeyboardHandler._isTextInputType(a)||a.isContentEditable||"on"==a.designMode||"HTML"==b&&a.document&&"on"==a.document.designMode};KeyboardHandler._isTextInputType=function KeyboardHandler$_isTextInputType(a){var b=a.type?a.type.toUpperCase():"";return KeyboardHandler._validInputTypes.indexOf(["",b,""].join(","))<0};var ShortcutsHandler={};ShortcutsHandler.handler=function ShortcutsHandler$handler(h,b,c,f){var d=true,a=true;if(!KbdShortcuts.hasSeenUi)if(",deleteMsg,closeFullViewMsg,".indexOf(["",b,""].join(","))<0){d=confirm(Page.decode(KbdShortcuts.hasSeenUiText));KbdShortcuts.hasSeenUi=true;if(OptionsWriter)OptionsWriter.fireOption(KbdShortcuts.uiSeenUrl);var e=Cookie.getCookieValues(c);e["ksui"]="1";Cookie.setCookieValues(c,e,Cookie.getPermanentExpirationDate());a=false}if(d){var g=f(h,b);if(a)a=g}return a};var OptionsWriter={};OptionsWriter.fireOption=function ShortcutsHandler$fireOption(b){var a=new Image;a.onabort=a.onload=function(){};a.src=b};var UnmanagedFooter={};UnmanagedFooter.initialize=function UnmanagedFooter$initialize(){UnmanagedFooter._unmanaged=$containsClass($tag(null,"html")[0],"Unmanaged");if(UnmanagedFooter._unmanaged){var a=$("MainContent");a.attachEvent("onresize",UnmanagedFooter.resize);window.attachEvent("onresize",UnmanagedFooter.resize);window.attachEvent("onunload",UnmanagedFooter._dispose);UnmanagedFooter.resize()}};UnmanagedFooter._dispose=function UnmanagedFooter$_dispose(){if(UnmanagedFooter._unmanaged){$("MainContent").detachEvent("onresize",UnmanagedFooter.resize);window.detachEvent("onresize",UnmanagedFooter.resize);window.detachEvent("onunload",UnmanagedFooter._dispose)}};UnmanagedFooter.resize=function UnmanagedFooter$resize(){var b=$("HeaderContainer"),a=$("FooterContainer"),e=$("ManagedContentWrapper"),d=$("contentLeft"),c=$("MainContent");$setDisplay(a,false);try{a.style.top=Math.max(d.offsetHeight,c.offsetHeight)+(b.offsetHeight+e.offsetTop+20)+"px"}catch(f){}$setDisplay(a,true)};Type.createStaticClass(UnmanagedFooter,"UnmanagedFooter");UnmanagedFooter.initialize();Page.addFeedbackData=function Page$addFeedbackData(b){var a=[""];try{a=["&w="+document.documentElement.clientWidth,"&h="+document.documentElement.clientHeight,typeof InboxPage!="undefined"&&InboxPage?"&rp="+InboxPage.Config.readingPane.location:""]}catch(c){a=[""]}b.href+=a.join("")}