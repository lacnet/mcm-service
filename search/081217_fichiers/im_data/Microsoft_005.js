// Copyright (c) Microsoft Corporation. All rights reserved.
Type.createNamespace('MSM');MSM.MimeParser=function(str){this.$0={};var $0=str.indexOf('\r\n\r\n');if($0===-1){this.$1=MSCo.StringHelper.substringToEnd(str,0);this.$2=String.Empty;this.$3(this.$1);}else{this.$1=MSCo.StringHelper.substring(str,0,$0);this.$2=MSCo.StringHelper.substringToEnd(str,$0+4);this.$3(this.$1);}}
MSM.MimeParser.prototype={$0:null,$1:null,$2:null,$3:function($p0){var $0=0;var $1=$p0.length;while($0<$1){var $2=$p0.indexOf('\r\n',$0);if($2===-1){$2=$1;}var $3=MSCo.StringHelper.substringSection($p0,$0,$2);if($3.length>0){var $4=$3.indexOf(': ');if($4!==-1){var $5=$3.substring(0,$4);var $6=MSCo.StringHelper.substringToEnd($3,$4+2);this.$0[MSCo.StringHelper.toLowerCase($5)]=$6;}}$0=$2+2;}},getHeader:function(name){name=MSCo.StringHelper.toLowerCase(name);if(Object.keyExists(this.$0,name)){return this.$0[name];}return null;},getHeaders:function(){return this.$1;},getBody:function(){return this.$2;},$4:function(){return Object.getKeyCount(this.$0);}}
MSM.IMsnpCommand=function(){};MSM.IMsnpCommand.createInterface('MSM.IMsnpCommand');MSM.IMsnpEvents=function(){};MSM.IMsnpEvents.createInterface('MSM.IMsnpEvents');MSM._P$0=function(){};MSM._P$0.createInterface('MSM._P$0');MSM.MsnpStatusCode=function(){};MSM.MsnpStatusCode.prototype={success:0,invalidParameter:201,invalidFederatedUser:203,unroutableUser:204,invalidUser:205,invalidUsername:208,invalidFriendlyName:209,contactListFull:210,alreadyThere:215,notAcceptingIMs:217,notAcceptingPages:220,invalidMsisdn:232,unknownMsisdn:233,unknownKeitaiDomain:234,invalidXmlData:241,unknownP2PApp:282,unknownUunApp:283,justOutOfFunds:290,addressBookError:403,subscriptionRequired:413,subscriptionDisabled:414,outOfFunds:415,disabledMarket:416,tryAgainLater:418,noMarketSpecified:419,internalServerError:500,upsDown:504,federatedPartnerError:508,pageModeMessageError:509,detailedError:511,serverUnavailable:601,pagingUnavailable:606,sessionRestricted:711,sessionOverloaded:712,userTooActive:713,notExpected:715,userRestricted:718,sessionFederated:719,userFederated:726,roamingLogoff:733,tooManyEndpoints:734,rateLimitExceeded:800,authFailed:911,childWithoutFullConsent:923,managedUserLimitedAccessWrongClient:926,managedUserAccessDenied:927,authError:928,domainReserved:931}
MSM.MsnpStatusCode.createEnum('MSM.MsnpStatusCode',false);MSM._P$6=function(events,debugId,serverType,server){this.$4={};this.$6=new MSM._P$7();this.$8=[];this.$10=-1;this.$2=events;this.$A=debugId;this.$3=serverType;this.$B=MSCo.StringHelper.toLowerCase(server);this.$E=Delegate.create(this,this.$1C);this.$4['Content-Type']='text/xml; charset=utf-8';this.$4['Proxy-Connection']='Keep-Alive';this.$4['Pragma']='No-Cache';this.$4['X-MSN-Auth']='Use-Cookie';}
MSM._P$6.prototype={$2:null,$3:null,$5:0,$7:null,$9:null,$A:0,$B:null,$C:null,$D:'',$E:null,$F:500,$11:0,$12:false,$13:false,$14:false,$15:null,$16:null,get_$17:function(){if(this.$10>=0){return this.$10;}else{return(this.$3==='NS')?10000:5000;}},$18:function($p0){if(!this.$9){this.$1A($p0);}else if(this.$11===MSCo.Timeout.infinite||$p0<this.$11){this.$1B();this.$1A($p0);}},$19:function(){this.$1B();},$1A:function($p0){this.$11=$p0;this.$9=new MSCo.Timer(this.$E,null,$p0,MSCo.Timeout.infinite);},$1B:function(){if(this.$9){this.$9.dispose();this.$9=null;}},$1C:function($p0){if(this.$16||this.$13){return;}this.$22();},$1D:function($p0){var $0=new StringBuilder();$0.append('http://');$0.append(this.$B);$0.append('/gateway/gateway.dll');$0.append('?');if(!this.$D.length){$0.append('Action=open&Server=');$0.append(this.$3);$0.append('&IP=none');}else{if($p0){$0.append('Action=poll&');}$0.append('SessionID=');$0.append(this.$D);}return $0.toString();},$1E:function($p0,$p1){var $0=$p1+'=';var $1=$p0.indexOf($0);if($1!==-1){$1+=$0.length;var $2=$p0.indexOf(';',$1);if($2!==-1){return MSCo.StringHelper.substringSection($p0,$1,$2);}else{return MSCo.StringHelper.substringToEnd($p0,$1);}}return null;},$1F:function($p0){var $0=$p0.getResponseHeader('X-MSN-Messenger');var $1=this.$1E($0,'SessionID');var $2=this.$1E($0,'Session');var $3=$p0.getResponseHeader('X-MSN-Host');if(!MSCo.StringHelper.isNull($3)&&$3.length>0){$3=MSCo.StringHelper.toLowerCase($3);if($3!==this.$B){this.$B=$3;this.$23();}}if(!MSCo.StringHelper.isNull($1)){this.$D=$1;}if(!MSCo.StringHelper.isNull($2)){if($2==='close'){return false;}}return true;},$20:function($p0){var $0=200;var $1=null;var $2=null;var $3=[];if(this.$13){return;}this.$16=null;if($p0.get_status()===200){var $4=false;if(!this.$1F($p0)){MSCo.LogHelper.loggerWarning(this.$7,'HttpMsnpTransport.OnResponse','Connection has been closed by server.');$4=true;}var $5=this.get_$17();if($p0.get_hasContent()){if(this.$6.get_$1()){this.$6.$6($p0.get_responseText());}else{this.$6.$5($p0.get_responseData());}while(this.$6.$4()){$3.add(this.$6.get_$3());this.$14=true;}if($5>1000){$5=1000;}}if($4){this.$12=true;this.$1B();$0=0;}else{$2=this.$15;if($2&&!MSCo.CollectionHelper.queueLength(this.$8)){$1=MC.$create_MessengerSessionInfo(this.$B,this.$D,this.$5,null);this.$15=null;}else{if(MSCo.CollectionHelper.queueLength(this.$8)>0){$5=this.$F;}this.$18($5);}}}else{MSCo.LogHelper.loggerWarning(this.$7,'HttpMsnpTransport.OnResponse',String.format('HttpMsnpTransport [{0}]: Http error detected: {1}',this.$3,$p0.get_status()));this.$12=true;$0=$p0.get_status();}this.$21($3);if(this.$12){this.$2.onDisconnect($0);}else if($2){$2.invoke($1);}},$21:function($p0){var $enum1=$p0.getEnumerator();while($enum1.moveNext()){var $0=$enum1.get_current();this.$2.onCommand($0);}this.$14=false;},$22:function(){this.$19();var $0=new StringBuilder();var $1=0;while((MSCo.CollectionHelper.queueLength(this.$8)>0)&&($1<24572)){var $5=this.$8.peek();var $6=$5.toString();if($6.length+$1<=24572){$0.append($6);$1+=$6.length;this.$5=$5.get_trid();this.$8.dequeue();}else{break;}}var $2=$0.toString();var $3=(!$2.length);if(!$3){}var $4=new MSCo.HttpRequest(1,this.$1D($3),$2,this.$4,Delegate.create(this,this.$20));this.$16=$4;$4.execute();},sendCommand:function($p0){if(this.$12){return;}this.$8.enqueue($p0);if(!this.$16){if($p0.get_name()==='OUT'||!this.$F){this.$22();return;}this.$18(25);}},resume:function($p0){this.$D=$p0;if(!this.$16){this.$18(this.get_$17());}},dispose:function(){var $0=null;this.$13=true;this.$1B();$0=this.$16;if($0){$0.abort();}},pauseSession:function($p0){var $0=false;if(this.$16||this.$14){this.$15=$p0;}else{(this).dispose();$0=true;}if($0){var $1=MC.$create_MessengerSessionInfo(this.$B,this.$D,this.$5,null);$p0.invoke($1);}},setRpsTicket:function($p0){this.$C=$p0;this.$23();},$23:function(){},setConnectionSpeed:function($p0,$p1){this.$F=$p0;this.$10=$p1;},get_logger:function(){return this.$7;},set_logger:function($p0){this.$7=$p0;return $p0;}}
MSM._P$5=function(fragments,onResponse){this.$0=fragments;this.$1=onResponse;}
MSM._P$5.prototype={$0:null,$1:null,get_name:function(){return this.$0[0].toString();},toString:function(){var $0=new StringBuilder();var $1=this.$0.length;for(var $2=0;$2<$1-1;$2++){$0.append(this.$0[$2].toString());$0.append(' ');}if(MSM._P$1.$8(this.$0[0])){var $3=this.$0[$1-1];$0.append(MSM._P$3.$5($3).toString());$0.append('\r\n');$0.append($3);}else{$0.append(this.$0[$1-1].toString());$0.append('\r\n');}return $0.toString();},get_trid:function(){return this.$0[1];},onComplete:function($p0,$p1){if(this.$1){this.$1.invoke($p0,$p1);}}}
MSM.MsnpServerCommand=function(name,parameters){this.$0=name;this.$1=parameters;}
MSM.MsnpServerCommand.prototype={$0:null,$1:null,get_name:function(){return this.$0;},get_parameters:function(){return this.$1;},get_allParameters:function(){var $0=[];$0.addRange(MSCo.CollectionHelper.toArray(this.$1));var $1=this.get_$2();if($1){$0.add(this.get_$2());}return MSCo.CollectionHelper.toArray($0);},get_$2:function(){return null;}}
MSM.MsnpConnection=function(serverType,server){this.$2=new MSM._P$2(30);this.$1=MSM._P$3.$4(this,MSM.MsnpConnection.$0++,serverType,server);}
MSM.MsnpConnection.prototype={$1:null,$3:0,$4:false,$5:null,$6:null,get_logger:function(){return this.$6;},set_logger:function(value){this.$6=value;this.$1.set_logger(value);return value;},setAuthenticationInfo:function(authInfo){this.$5=authInfo;if(authInfo.authType===1){this.$1.setRpsTicket(authInfo.ticket);}},setConnectionSpeed:function(sendInterval,receiveInterval){this.$1.setConnectionSpeed(sendInterval,receiveInterval);},resume:function(sessionCookie,trid){this.$1.resume(sessionCookie);this.$3=trid;},pauseSession:function(callback){this.$1.pauseSession(callback);},get_nextTrid:function(){return++this.$3;},sendCommand:function(args,callback){if(this.$4){return;}var $0=new MSM._P$5(args,callback);this.$2.$2($0.get_trid(),$0);this.onSendCommand($0);},onSendCommand:function(command){this.$1.sendCommand(command);},getPendingCommand:function(trid){return this.$2.$3(trid);},onCommand:function(command){if(this.$4){return;}this.$2.$4();this.onCommandReceived(command);},onDisconnect:function(errorCode){if(this.$4){return;}this.onDisconnected(errorCode);this.$4=true;},dispose:function(){this.$4=true;this.$1.dispose();}}
MSM._P$1=function(){}
MSM._P$1.$7=function($p0){switch($p0){case'ADL':case'FQY':case'GCF':case'IPG':case'MSG':case'NFY':case'NOT':case'RML':case'UBM':case'UBN':case'UBX':case'203':case'204':case'205':case'210':case'234':case'241':case'508':case'509':case'511':return true;default:return false;}}
MSM._P$1.$8=function($p0){switch($p0){case'ADL':case'FQY':case'MSG':case'PGD':case'QRY':case'RML':case'UUM':case'UUN':case'UUX':return true;default:return false;}}
MSM._P$1.prototype={$0:false,get_$1:function(){return this.$0;},get_$2:function(){return!this.$0;},$5:function($p0){throw new Error('Invalid operation!');},$6:function($p0){throw new Error('Invalid operation!');}}
MSM._P$7=function(){MSM._P$7.constructBase(this);this.$0=true;this.$9=String.Empty;}
MSM._P$7.prototype={$9:null,$A:null,$6:function($p0){this.$9+=$p0;},$B:function(){this.$A=null;return false;},$C:function($p0,$p1){this.$A=new MSM.MsnpServerCommand($p0,$p1);return true;},$4:function(){while(this.$9.length>0){var $0=this.$9.indexOf('\n');if($0<=0){return this.$B();}if(MSCo.StringHelper.charAt(this.$9,$0-1)!=='\r'){MSCo.LogHelper.logError('MsnpTextParser.MoveNext','Unexpected character found. Text: '+this.$9);return this.$B();}var $1=this.$9.substring(0,3);var $2=[];var $3=MSCo.StringHelper.substringSection(this.$9,3,$0-1).split(' ');for(var $4=0;$4<$3.length;$4++){if($3[$4].length>0){$2.add($3[$4]);}}if(MSM._P$1.$7($1)){if($1==='MSG'){var $5=this.$9.indexOf('\r\n\r\n');if($5>=0){var $6=this.$9.indexOf('\r\nP2P-Dest:');if($6>=0&&$6<$5){this.$9=String.Empty;return this.$B();}}}if($2[MSCo.CollectionHelper.arrayLength($2)-1]==='OK'){}else{var $7=MSM._P$3.$0($2[MSCo.CollectionHelper.arrayLength($2)-1]);$2.removeAt(MSCo.CollectionHelper.arrayLength($2)-1);var $8=$7;var $9=$0+1;while($7>0){if(this.$9.length<=$9){return false;}var $A=MSCo.StringHelper.charCodeAt(this.$9,$9);if($A<=127){$7--;}else if($A<=2047){$7-=2;$8--;}else if($A>=55296&&$A<=57343){$7-=2;$8--;}else{$7-=3;$8-=2;}$9++;}if($8>0){$2.add(MSCo.StringHelper.substring(this.$9,$0+1,$8));}$0+=$8;}}this.$9=MSCo.StringHelper.substringToEnd(this.$9,$0+1);return this.$C($1,$2);}return this.$B();},get_$3:function(){return this.$A;}}
MSM._P$4=function(key,obj,expires){this.$0=key;this.$1=obj;this.$2=expires;}
MSM._P$4.prototype={$0:0,$1:null,$2:null,$3:function($p0){return MSM._P$3.$1($p0,this.$2);},get_$4:function(){return this.$0;},get_$5:function(){return this.$1;}}
MSM._P$2=function(timeoutInSeconds){this.$0=[];this.$1=timeoutInSeconds*1000;}
MSM._P$2.prototype={$1:0,$2:function($p0,$p1){var $0=MSM._P$3.$2(Date.get_now(),this.$1);this.$0.add(new MSM._P$4($p0,$p1,$0));},$3:function($p0){if($p0>0){for(var $0=0;$0<MSCo.CollectionHelper.arrayLength(this.$0);$0++){var $1=this.$0[$0];if($1.get_$4()===$p0){var $2=$1.get_$5();this.$0.removeAt($0);return $2;}}}return null;},$4:function(){if(0===MSCo.CollectionHelper.arrayLength(this.$0)){return;}var $0=Date.get_now();for(var $1=0;$1<MSCo.CollectionHelper.arrayLength(this.$0);$1++){var $2=this.$0[$1];if($2.$3($0)){this.$0.removeAt($1--);}}}}
MSM._P$3=function(){}
MSM._P$3.$0=function($p0){return parseInt($p0,10);}
MSM._P$3.$1=function($p0,$p1){return $p0.getTime()>=$p1.getTime();}
MSM._P$3.$2=function($p0,$p1){$p0.setTime($p0.getTime()+$p1);return $p0;}
MSM._P$3.$3=function($p0){return $p0.toTimeString();}
MSM._P$3.$4=function($p0,$p1,$p2,$p3){return new MSM._P$6($p0,$p1,$p2,$p3);}
MSM._P$3.$5=function($p0){var $0=$p0.length;var $1=0;for(var $2=0;$2<$0;$2++){var $3=MSCo.StringHelper.charCodeAt($p0,$2);if($3<=127){$1+=1;}else if($3<=2047){$1+=2;}else if($3>=55296&&$3<=57343){$1+=2;}else{$1+=3;}}return $1;}
MSM.MimeParser.createClass('MSM.MimeParser');MSM._P$6.createClass('MSM._P$6',null,MSM._P$0);MSM._P$5.createClass('MSM._P$5',null,MSM.IMsnpCommand);MSM.MsnpServerCommand.createClass('MSM.MsnpServerCommand');MSM.MsnpConnection.createClass('MSM.MsnpConnection',null,MSM.IMsnpEvents,IDisposable);MSM._P$1.createClass('MSM._P$1');MSM._P$7.createClass('MSM._P$7',MSM._P$1);MSM._P$4.createClass('MSM._P$4');MSM._P$2.createClass('MSM._P$2');MSM._P$3.createClass('MSM._P$3');MSM.MsnpConnection.$0=0;Type.createNamespace('MSP');MSP._P$4=function(){};MSP._P$4.prototype={$0:0,$1:1,$2:2,$3:3}
MSP._P$4.createEnum('MSP._P$4',false);MSP._P$1=function(){};MSP._P$1.prototype={$0:0,$1:1,$2:2,$3:4,$4:8,$5:16,$6:32}
MSP._P$1.createEnum('MSP._P$1',true);MSP._P$0=function(){};MSP._P$0.prototype={$0:0,$1:1,$2:2,$3:4}
MSP._P$0.createEnum('MSP._P$0',true);MSP._P$3=function(){};MSP._P$3.prototype={$0:0,$1:1,$2:2,$3:4}
MSP._P$3.createEnum('MSP._P$3',false);MSP._P$2=function(){};MSP._P$2.prototype={$0:0,$1:1,$2:2,$3:4}
MSP._P$2.createEnum('MSP._P$2',false);MSP.ContactListType=function(){};MSP.ContactListType.prototype={normal:0,signOn:1,federatedQuery:2,subscriptionRefresh:3}
MSP.ContactListType.createEnum('MSP.ContactListType',false);MSP.RfsItems=function(){};MSP.RfsItems.prototype={none:0,contactList:1,presence:2}
MSP.RfsItems.createEnum('MSP.RfsItems',true);MSP.UunApplicationId=function(){};MSP.UunApplicationId.prototype={logoffRemoteEndpoints:4,chatSessionClosed:5,addressBookUpdated:6,subscriptionNotificationCanceled:7,logoffAllEndpoints:8}
MSP.UunApplicationId.createEnum('MSP.UunApplicationId',false);MSP.ConnectionService=function(identity,events){this.$7=MC.$create_PresenceConfigurationInfo();this.$0=identity;this.$1=events;this.$3=new MSP._P$12(this);}
MSP.ConnectionService.prototype={$0:null,$1:null,$2:null,$3:null,$4:500,$5:10000,$6:null,$8:null,get_logger:function(){return this.$8;},set_logger:function(value){if(value){value.set_module('ConnectionService');value.set_context(this.$0.liveId);}this.$8=value;var $0=this.$2;if($0){$0.set_logger(value);}return value;},authenticate:function(clientId,hostName,onCompleted){if(String.isNullOrEmpty(hostName)){hostName=this.$7.hostName;}this.$2=new MSP._P$20(this,hostName);this.$2.set_logger(this.$8);this.$2.$1_1E(this.$6);this.$2.setConnectionSpeed(this.$4,this.$5);if(this.$0.authenticationInfo){this.$2.setAuthenticationInfo(this.$0.authenticationInfo);}this.$2.$1_4=this.$7;this.$3.$2(new MSP._P$14(this.$0,clientId,this.$2,onCompleted));},resumeSession:function(sessionInfo,events){if(!this.$2){this.$2=new MSP._P$20(this,sessionInfo.server);this.$2.set_logger(this.$8);this.$2.setConnectionSpeed(this.$4,this.$5);this.$2.resume(sessionInfo.sessionToken,sessionInfo.transactionID);this.$2.$1_4=this.$7;this.$B(new MSP._P$16(this));if(events){var $enum1=events.getEnumerator();while($enum1.moveNext()){var $0=$enum1.get_current();if($0[0]==='OnSubscribeNotificationReceived'){var $1=$0[1];this.$1.onSubscribeNotificationReceived($1[0]);}}}}else{}},$9:function($p0){this.$2=$p0;},notifyAddressBookChanged:function(){this.$3.$7(new MSP._P$F(this.$0,this.$2));},sendNotification:function(address,endpointId,notification,onCompleted){this.$3.$8(new MSP._P$1C(address,endpointId,notification,this.$2,onCompleted));},sendPage:function(address,messageType,messagePayload,onCompleted){this.$3.$9(new MSP._P$1D(address,messageType,messagePayload,this.$2,onCompleted));},signIn:function(addresses,presence,endpointPresence,settings,onCompleted){this.$3.$3(new MSP._P$25(addresses,this.$2),new MSP._P$19(this.$0,settings,this.$2,null),new MSP._P$22(this.$0,presence,endpointPresence,this.$2,null),new MSP._P$1B(this.$1,onCompleted));},signOut:function(locations,endpointIds,initiatedRemotely,onCompleted){this.$3.$4(new MSP._P$15(this.$0,locations,endpointIds,initiatedRemotely,this.$2,this.$1,onCompleted));},updateAddresses:function(addresses,addedLists,removedLists,onCompleted){this.$3.$A(new MSP._P$24(addresses,addedLists,removedLists,this.$2,onCompleted));},publishSettings:function(settings,onCompleted){this.$3.$6(new MSP._P$19(this.$0,settings,this.$2,onCompleted));},publishPresence:function(presence,endpointPresence,onCompleted){this.$3.$5(new MSP._P$22(this.$0,presence,endpointPresence,this.$2,onCompleted));},requestMixerSession:function(onCompleted){this.$3.$B(new MSP._P$18(this.$2,onCompleted));},updateConfiguration:function(configuration){this.$7=configuration;if(this.$2){this.$2.$1_4=configuration;}},onPresenceLost:function(){this.$3.$C(new MSP._P$1F(this.$1));},onIncomingChatRequest:function(inviter,hostName,sessionId,sessionCookie){this.$3.$D(new MSP._P$C(inviter,hostName,sessionId,sessionCookie,this.$1));},onPresenceChanged:function(address,presence,endpointPresence){this.$3.$E(new MSP._P$21(address,presence,endpointPresence,this.$1));},onSettingsChanged:function(settings){this.$3.$13(new MSP._P$1E(settings,this.$1));},onMailNotificationReceived:function(mailNotification){this.$3.$11(new MSP._P$D(mailNotification,this.$1));},onSubscribeNotificationReceived:function(address){this.$3.$12(new MSP._P$1A(address,this.$1));},onNotificationReceived:function(sender,senderEndpointId,notification){this.$3.$14(new MSP._P$10(this.$0,sender,senderEndpointId,notification,this,this.$1));},onPageReceived:function(message,senderAddress,receiverAddress){this.$3.$15(new MSP._P$E(message,senderAddress,receiverAddress,this.$1));},onDisconnected:function(resultCode){this.$3.$10(new MSP._P$B(resultCode,this.$1));},onTransferred:function(hostName,otherEndpointRequested){this.$3.$F(new MSP._P$23(hostName,otherEndpointRequested,this.$1));},onPolicyReceived:function(policyName,content){this.$3.$16(new MSP._P$17(policyName,content,this.$1));},onSignInEventsEmpty:function(){this.$1.onSignInEventsEmpty();},$A:function($p0){$p0.$2();},$B:function($p0){this.$3=$p0;if(Type.canCast(this.$3,MSP._P$12)){if(this.$2){this.$2.dispose();this.$2=null;}}},abort:function(){var $0=this.$2;if($0){$0.dispose();}},pauseSession:function(callback){this.$2.pauseSession(callback);},ignoreServerCommands:function(cmdlist){this.$6=cmdlist;if(this.$2){this.$2.$1_1E(cmdlist);}},setConnectionSpeed:function(sendInterval,receiveInterval){this.$4=sendInterval;this.$5=receiveInterval;if(this.$2){this.$2.setConnectionSpeed(this.$4,this.$5);}}}
MSP._P$A=function(){}
MSP._P$A.prototype={$0:false,$1:false,$2:function(){this.$0=true;this.$3();},$4:function(){if(!this.$1){this.$1=true;this.$6();}},$5:function(){if(!this.$1){this.$1=true;this.$6();}},$6:function(){if(this.$8){this.$8.invoke(this,EventArgs.Empty);}},add_$7:function($p0){this.$8=Delegate.combine(this.$8,$p0);},remove_$7:function($p0){this.$8=Delegate.remove(this.$8,$p0);},$8:null}
MSP._P$14=function(identity,clientId,connection,onCompleted){MSP._P$14.constructBase(this);this.$9=identity;this.$A=clientId;this.$B=connection;this.$C=onCompleted;}
MSP._P$14.prototype={$9:null,$A:null,$B:null,$C:null,$D:0,$E:0,$3:function(){this.$F(0,null);},$6:function(){this.$C.invoke(this.$E);MSP._P$14.callBase(this,'$6');},$F:function($p0,$p1){if($p0){this.$D=1;}switch(this.$D){case 0:this.$D=2;this.$B.$1_33(Delegate.create(this,this.$10));this.$B.$1_24(this.$9.liveId,this.$A,Delegate.create(this,this.$11));if(this.$9.authenticationInfo.authType===1){this.$B.$1_2D(this.$9.endpointId,Delegate.create(this,this.$12));}else{this.$B.$1_2C(this.$9.appId,this.$9.cid,this.$9.authenticationInfo.ticket,this.$9.endpointId,Delegate.create(this,this.$12));}break;case 2:break;case 3:this.$E=0;this.$5();break;case 1:this.$E=1;this.$5();break;}},$10:function($p0,$p1){this.$F($p0,$p1);},$11:function($p0,$p1){this.$F($p0,$p1);},$12:function($p0,$p1){this.$D=3;this.$F($p0,$p1);}}
MSP._P$B=function(resultCode,events){MSP._P$B.constructBase(this);this.$9=resultCode;this.$A=events;}
MSP._P$B.prototype={$9:0,$A:null,$3:function(){switch(this.$9){case 2:case 3:this.$A.onDisconnected(this.$9);break;default:this.$A.onDisconnected(this.$9);break;}}}
MSP._P$C=function(inviter,hostName,sessionId,sessionCookie,events){MSP._P$C.constructBase(this);this.$9=inviter;this.$A=hostName;this.$B=sessionId;this.$C=sessionCookie;this.$D=events;}
MSP._P$C.prototype={$9:null,$A:null,$B:null,$C:null,$D:null,$3:function(){this.$D.onIncomingChatRequest(this.$9,this.$A,this.$B,this.$C);}}
MSP._P$D=function(mailNotification,events){MSP._P$D.constructBase(this);this.$9=mailNotification;this.$A=events;}
MSP._P$D.prototype={$9:null,$A:null,$3:function(){this.$A.onMailNotificationReceived(this.$9);}}
MSP._P$10=function(identity,sender,senderEndpointId,notification,connService,events){MSP._P$10.constructBase(this);this.$9=identity;this.$A=sender;this.$B=senderEndpointId;this.$C=notification;this.$D=connService;this.$E=events;}
MSP._P$10.prototype={$9:null,$A:null,$B:null,$C:null,$D:null,$E:null,$3:function(){this.$5();},$6:function(){var $0=this.$C.type;switch($0){case 6:break;case 8:case 4:if((this.$A.address===this.$9.liveId)&&(this.$A.type===1)){this.$D.signOut(1,null,true,null);}break;default:this.$E.onNotificationReceived(this.$A,this.$B,this.$C);break;}MSP._P$10.callBase(this,'$6');}}
MSP._P$F=function(identity,connection){MSP._P$F.constructBase(this);this.$9=identity;this.$A=connection;}
MSP._P$F.prototype={$9:null,$A:null,$3:function(){this.$A.$1_2E(MC.$create_IMAddressInfo(this.$9.liveId,1,0),String.Empty,6,String.Empty,Delegate.create(this,this.$B));},$B:function($p0,$p1){if(!$p0){this.$5();}else{this.$4();}}}
MSP._P$E=function(message,senderAddress,receiverAddress,events){MSP._P$E.constructBase(this);this.$9=message;this.$A=senderAddress;this.$B=receiverAddress;this.$C=events;}
MSP._P$E.prototype={$9:null,$A:null,$B:null,$C:null,$3:function(){this.$6();},$6:function(){this.$C.onPageReceived(this.$9,this.$A,this.$B);}}
MSP._P$17=function(policyName,xmlBlob,events){MSP._P$17.constructBase(this);this.$A=policyName;this.$B=xmlBlob;this.$9=events;}
MSP._P$17.prototype={$9:null,$A:null,$B:null,$3:function(){this.$9.onPolicyReceived(this.$A,this.$B);}}
MSP._P$21=function(address,presence,endpointPresence,events){MSP._P$21.constructBase(this);this.$9=address;this.$A=presence;this.$B=endpointPresence;this.$C=events;}
MSP._P$21.prototype={$9:null,$A:null,$B:null,$C:null,get_$D:function(){return this.$9;},get_$E:function(){return this.$A;},get_$F:function(){return this.$B;},$3:function(){this.$C.onPresenceChanged(this.$9,this.$A,this.$B);}}
MSP._P$1F=function(events){MSP._P$1F.constructBase(this);this.$9=events;}
MSP._P$1F.prototype={$9:null,$3:function(){this.$9.onPresenceLost();}}
MSP._P$22=function(identity,presence,endpointPresence,connection,onCompleted){MSP._P$22.constructBase(this);this.$9=MC.$create_IMAddressInfo(identity.liveId,1,0);this.$A=presence;this.$B=endpointPresence;this.$C=connection;this.$D=onCompleted;}
MSP._P$22.prototype={$9:null,$A:null,$B:null,$C:null,$D:null,$E:0,$F:0,$10:0,get_$11:function(){return this.$9;},get_$12:function(){return this.$A;},get_$13:function(){return this.$B;},$3:function(){if((this.$A.properties)||(!MSCo.StringHelper.isNull(this.$A.personalMessage))){this.$C.$1_30(this.$A,Delegate.create(this,this.$17));this.$F|=4;}if((this.$B.capabilities.length>0)||(this.$B.properties)||(this.$B.applicationMessageIds)||(this.$B.webProperties)){this.$C.$1_31(this.$B,Delegate.create(this,this.$18));this.$F|=8;}if(!MSCo.StringHelper.isNull(this.$B.endpointName)){this.$C.$1_32(this.$B,Delegate.create(this,this.$19));this.$F|=16;}if(!MSCo.StringHelper.isNull(this.$A.displayName)){this.$C.$1_27(this.$9.address,this.$A.displayName,Delegate.create(this,this.$16));this.$F|=2;}if(this.$A.status){this.$C.$1_23(this.$A.status,this.$A.capabilities,this.$A.displayPictureKey,Delegate.create(this,this.$15));this.$F|=1;}if(this.$F===this.$10){this.$5();}},$6:function(){if(this.$D){this.$D.invoke(this.$E);}MSP._P$22.callBase(this,'$6');},get_$14:function(){return this.$E;},$15:function($p0,$p1){this.$10|=1;this.$1A($p0);},$16:function($p0,$p1){if($p0===715||$p0===209){$p0=0;}this.$10|=2;this.$1A($p0);},$17:function($p0,$p1){this.$10|=4;this.$1A($p0);},$18:function($p0,$p1){this.$10|=8;this.$1A($p0);},$19:function($p0,$p1){this.$10|=16;this.$1A($p0);},$1A:function($p0){if($p0){this.$E=1;this.$4();return;}if(this.$F===this.$10){this.$5();}}}
MSP._P$25=function(addresses,connection){MSP._P$25.constructBase(this);this.$9=addresses;this.$A=connection;}
MSP._P$25.prototype={$9:null,$A:null,$B:0,$C:0,$3:function(){this.$B=this.$A.$1_21(true,this.$9,Delegate.create(this,this.$D));},$D:function($p0,$p1){switch($p0){case 0:case 204:case 205:case 234:case 508:break;default:break;}this.$C++;if(this.$B===this.$C){this.$5();}}}
MSP._P$19=function(identity,settings,connection,onCompleted){MSP._P$19.constructBase(this);this.$9=identity;this.$A=settings;this.$B=connection;this.$C=onCompleted;}
MSP._P$19.prototype={$9:null,$A:null,$B:null,$C:null,$D:0,$E:0,$F:0,$3:function(){if(this.$A.isMpopDisabledChanged&&this.$A.isMpopDisabled){this.$B.$1_2E(MC.$create_IMAddressInfo(this.$9.liveId,1,0),String.Empty,4,String.Empty,Delegate.create(this,this.$12));this.$D|=2;}if(this.$A.privacyOptions){this.$B.$1_22(this.$A.privacyOptions,Delegate.create(this,this.$11));this.$D|=1;}this.$10(0);},$6:function(){if(this.$C){this.$C.invoke(this.$F);}MSP._P$19.callBase(this,'$6');},$10:function($p0){if($p0){this.$E|=4;}if((this.$E&4)){this.$F=1;this.$4();}if(this.$E===this.$D){this.$5();}},$11:function($p0,$p1){this.$E|=1;this.$10($p0);},$12:function($p0,$p1){this.$E|=2;this.$10($p0);}}
MSP._P$18=function(connection,callback){MSP._P$18.constructBase(this);this.$9=connection;this.$A=callback;}
MSP._P$18.prototype={$9:null,$A:null,$B:0,$C:null,$D:false,$3:function(){this.$E();},$6:function(){this.$A.invoke(this.$B,this.$C);},$E:function(){this.$9.$1_34(Delegate.create(this,this.$F));},$F:function($p0,$p1){if(!$p0){this.$C=$p1;this.$B=0;this.$5();}else{if(!this.$D){this.$D=true;new MSCo.Timer(Delegate.create(this,this.$10),null,MSP._P$6.$17(1000,10000),MSCo.Timeout.infinite);}else{this.$B=1;this.$5();}}},$10:function($p0){this.$E();}}
MSP._P$1C=function(address,endpointId,notification,connection,onCompleted){MSP._P$1C.constructBase(this);this.$9=address;this.$A=endpointId;this.$B=notification;this.$C=connection;this.$D=onCompleted;}
MSP._P$1C.prototype={$9:null,$A:null,$B:null,$C:null,$D:null,$E:0,$3:function(){this.$C.$1_2E(this.$9,this.$A,this.$B.type,this.$B.content,Delegate.create(this,this.$F));},$6:function(){this.$D.invoke(this.$E);MSP._P$1C.callBase(this,'$6');},$F:function($p0,$p1){if($p0){this.$E=1;this.$4();}else{this.$E=0;this.$5();}}}
MSP._P$1D=function(address,messageType,messagePayload,connection,onCompleted){MSP._P$1D.constructBase(this);this.$9=address;this.$A=messageType;this.$B=messagePayload;this.$C=connection;this.$D=onCompleted;}
MSP._P$1D.prototype={$9:null,$A:null,$B:null,$C:null,$D:null,$E:0,$3:function(){this.$C.$1_2F(this.$9,this.$A,this.$B,Delegate.create(this,this.$F));},$6:function(){this.$D.invoke(this.$E);},$F:function($p0,$p1){if(!$p0){this.$E=0;this.$5();}else{this.$E=1;this.$4();}}}
MSP._P$1E=function(settings,events){MSP._P$1E.constructBase(this);this.$9=settings;this.$A=events;}
MSP._P$1E.prototype={$9:null,$A:null,$3:function(){this.$A.onSettingsChanged(this.$9);}}
MSP._P$1B=function(events,onCompleted){MSP._P$1B.constructBase(this);this.$9=events;this.$A=onCompleted;}
MSP._P$1B.prototype={$9:null,$A:null,$B:0,$C:null,$D:null,$E:null,$F:function($p0,$p1,$p2,$p3){this.$B=$p0;this.$C=$p1;this.$D=$p2;this.$E=$p3;},$3:function(){this.$A.invoke(this.$B);if(!this.$B){this.$9.onPresenceChanged(this.$C,this.$D,this.$E);}}}
MSP._P$15=function(identity,locations,endpointIds,initiatedRemotely,connection,events,onCompleted){MSP._P$15.constructBase(this);this.$9=MC.$create_IMAddressInfo(identity.liveId,1,0);this.$A=locations;this.$B=endpointIds;this.$C=initiatedRemotely;this.$D=connection;this.$E=events;this.$F=onCompleted;}
MSP._P$15.prototype={$9:null,$A:0,$B:null,$C:false,$D:null,$E:null,$F:null,$10:0,$11:0,$12:0,$13:0,$3:function(){switch(this.$A){case 3:this.$D.$1_23(3,[],null,Delegate.create(this,this.$16));this.$D.$1_2E(this.$9,String.Empty,8,String.Empty,Delegate.create(this,this.$15));this.$D.$1_26();this.$10|=2;this.$10|=1;break;case 2:this.$D.$1_2E(this.$9,String.Empty,4,String.Empty,Delegate.create(this,this.$15));this.$12++;this.$10|=1;break;case 8:for(var $0=0;$0<this.$B.length;$0++){this.$D.$1_2E(this.$9,this.$B[$0],4,String.Empty,Delegate.create(this,this.$15));this.$12++;}this.$10|=1;break;case 1:this.$D.$1_26();break;}},get_$14:function(){return((this.$A&1));},$6:function(){if(this.$F){this.$F.invoke(0);}else if(this.$C){this.$E.onDisconnected(2);}MSP._P$15.callBase(this,'$6');},$15:function($p0,$p1){this.$11|=1;this.$13++;this.$17($p0);},$16:function($p0,$p1){this.$11|=2;this.$17($p0);},$17:function($p0){if($p0){this.$11|=4;}if((this.$11&4)){this.$4();return;}if((this.$11===this.$10)&&(this.$13===this.$12)){this.$5();}}}
MSP._P$1A=function(subscriber,events){MSP._P$1A.constructBase(this);this.$9=subscriber;this.$A=events;}
MSP._P$1A.prototype={$9:null,$A:null,$3:function(){this.$A.onSubscribeNotificationReceived(this.$9);}}
MSP._P$23=function(hostName,otherEndpointRequested,events){MSP._P$23.constructBase(this);this.$9=hostName;this.$A=otherEndpointRequested;this.$B=events;}
MSP._P$23.prototype={$9:null,$A:false,$B:null,$3:function(){this.$B.onTransferred(this.$9,this.$A);}}
MSP._P$24=function(addresses,addedLists,removedLists,connection,callback){this.$13=0;MSP._P$24.constructBase(this);this.$A=addresses;this.$B=addedLists;this.$C=removedLists;this.$D=connection;this.$E=callback;}
MSP._P$24.prototype={$A:null,$B:0,$C:0,$D:null,$E:null,$F:0,$10:0,$11:0,$12:0,$3:function(){if((this.$C&MSP._P$24.$9)){var $0=this.$14(this.$C);for(var $1=0;$1<$0.length;$1++){this.$D.$1_29($0[$1],Delegate.create(this,this.$16));this.$11++;}this.$F|=2;}if((this.$B&MSP._P$24.$9)){this.$D.$1_21(false,this.$14(this.$B),Delegate.create(this,this.$15));this.$F|=1;}},$14:function($p0){var $0=new Array(this.$A.length);for(var $1=0;$1<this.$A.length;$1++){$0[$1]=MC.$create_IMAddressInfo(this.$A[$1].address,this.$A[$1].type,$p0);}return $0;},$15:function($p0,$p1){this.$10|=1;this.$17($p0);},$16:function($p0,$p1){this.$10|=2;this.$12++;this.$17($p0);},$17:function($p0){if($p0){this.$10|=4;}if((this.$10&4)){this.$13=1;this.$4();return;}if((this.$10===this.$F)&&(this.$11===this.$12)){this.$5();}},$6:function(){this.$E.invoke(this.$13);MSP._P$24.callBase(this,'$6');},get_$18:function(){return this.$A;},get_$19:function(){return!this.$13;},get_$1A:function(){return(this.$B&MSP._P$24.$9);}}
MSP._P$6=function(){}
MSP._P$6.$0=function($p0){var $0=MSCo.StringHelper.splitChar(MSCo.StringHelper.toLowerCase($p0),';');if($0.length!==2){$0=[$0[0],''];}return $0;}
MSP._P$6.$1=function($p0){return new MSP._P$9().$1C($p0);}
MSP._P$6.$2=function($p0){return Math.ceil($p0);}
MSP._P$6.$3=function($p0){return Math.floor($p0);}
MSP._P$6.$4=function($p0,$p1,$p2){return $p0.replace(new RegExp($p1),$p2);}
MSP._P$6.$5=function($p0){return $p0.nodeName;}
MSP._P$6.$6=function($p0){return $p0.nodeType;}
MSP._P$6.$7=function($p0){return $p0.hasChildNodes();}
MSP._P$6.$8=function($p0){return $p0.length;}
MSP._P$6.$9=function($p0,$p1){var $0=$p0.toString(2);var $1=$p1.toString(2);var $2=new StringBuilder();var $3=new StringBuilder();var $4=Math.abs($0.length-$1.length);for(var $5=0;$5<$4;$5++){$3.append('0');}if($0.length<$1.length){$3.append($0);$0=$3.toString();}else if($1.length<$0.length){$3.append($1);$1=$3.toString();}for(var $6=0;$6<$0.length;$6++){$2.append((MSCo.StringHelper.charAt($0,$6)===MSCo.StringHelper.charAt($1,$6))?'0':'1');}return parseInt($2.toString(),2);}
MSP._P$6.$A=function($p0){if($p0){var $0=new StringBuilder();for(var $1=0;$1<$p0.length;$1++){var $2=MSCo.StringHelper.charAt($p0,$1);switch($2){case'%':$0.append('%25');break;case' ':$0.append('%20');break;case'\t':$0.append('%09');break;case'\r':$0.append('%0D');break;case'\n':$0.append('%0A');break;default:$0.append($2);break;}}$p0=$0.toString();}return $p0;}
MSP._P$6.$B=function($p0){return decodeURIComponent($p0);}
MSP._P$6.$C=function($p0){var $0=parseInt($p0,10);if(isNaN($0)){$0=-1;}return $0;}
MSP._P$6.$D=function($p0){return parseInt($p0,10);}
MSP._P$6.$E=function($p0){return parseInt($p0,16);}
MSP._P$6.$F=function($p0){return MSP._P$6.$D($p0);}
MSP._P$6.$10=function($p0){return MSP._P$6.$D($p0);}
MSP._P$6.$11=function($p0){$p0=MSCo.StringHelper.toLowerCase($p0);if($p0.startsWith('http://')){$p0=MSCo.StringHelper.substringToEnd($p0,'http://'.length);var $0=$p0.indexOf('/');if($0>=0){$p0=MSCo.StringHelper.substring($p0,0,$0);}}return $p0;}
MSP._P$6.$13=function($p0){if($p0.indexOf('&')<0){return $p0;}return $p0.replace(MSP._P$6.$14,Delegate.create(null,function($p1_0){return($p1_0==='&')?'&amp;':$p1_0;}));}
MSP._P$6.$15=function($p0,$p1){for(var $0=0;$0<MSP._P$6.$8($p0.childNodes);$0++){if(MSP._P$6.$5($p0.childNodes[$0])===$p1&&MSP._P$6.$6($p0.childNodes[$0])===1){return $p0.childNodes[$0];}}return null;}
MSP._P$6.$16=function($p0,$p1){var $0=$p0.attributes.getNamedItem($p1);if($0){return $0.value;}return null;}
MSP._P$6.$17=function($p0,$p1){return Math.floor($p0+(Math.random()*$p1));}
MSP._P$5=function(n){this.$0=[];if(!n.length){this.$0.insert(0,0);}else{if(MSCo.StringHelper.charAt(n,0)==='-'){this.$1=true;n=n.substring(1,n.length);}var $0;for($0=0;3*($0+1)<=n.length;$0++){this.$0.insert($0,MSP._P$6.$D(MSCo.StringHelper.substringSection(n,n.length-3*($0+1),n.length-3*$0)));}if(0!==(n.length%3)){this.$0.insert($0++,MSP._P$6.$D(n.substring(0,(n.length%3))));}this.$2=$0;}}
MSP._P$5.prototype={$1:false,$2:0,toString:function(){if(!this.$2){return'0';}var $0='';for(var $1=0;$1<this.$2;$1++){$0=this.$0[$1]+$0;if($1<this.$2-1){for(var $2=10;$2<1000;$2*=10){if(this.$0[$1]<$2){$0=0+$0;}}}}if(this.$1){$0='-'+$0;}return $0;},$5:function(){for(var $0=this.$2-1;$0>=0;$0--){if(!this.$0[$0]){this.$2--;}else{break;}}for(var $1=0;$1<2;$1++){if(!this.$2){this.$1=false;}else{if(this.$0[this.$2-1]<0){for(var $2=0;$2<this.$2;$2++){this.$0[$2]=-this.$0[$2];}this.$1=!this.$1;}for(var $3=0;$3<this.$2-1;$3++){if(this.$0[$3]<0){var $4=MSP._P$6.$2(-this.$0[$3]/1000);this.$0[$3]=this.$0[$3]+(1000*$4);this.$0[$3+1]=this.$0[$3+1]-$4;}if(this.$0[$3]>=1000){var $5=MSP._P$6.$3(this.$0[$3]/1000);this.$0[$3]=this.$0[$3]%1000;this.$0[$3+1]=this.$0[$3+1]+$5;}}while(this.$0[this.$2-1]>=1000){this.$6();this.$0[this.$2]=MSP._P$6.$3(this.$0[this.$2-1]/1000);this.$0[this.$2-1]=this.$0[this.$2-1]%1000;this.$2++;}if(this.$0[this.$2-1]<0){for(var $6=0;$6<this.$2;$6++){this.$0[$6]=-this.$0[$6];}this.$1=!this.$1;}else{break;}}}},$6:function(){if(this.$2===this.$0.length){this.$0[this.$2]=0;}},$7:function($p0){for(var $0=0;$0<this.$2-$p0.$2;$0++){$p0.$0.insert($p0.$2+$0,0);}for(var $1=0;$1<$p0.$2-this.$2;$1++){this.$0.insert(this.$2+$1,0);}this.$2=Math.max($p0.$2,this.$2);if(this.$1===$p0.$1){for(var $2=0;$2<this.$2;$2++){this.$0[$2]=this.$0[$2]+$p0.$0[$2];}}else{for(var $3=0;$3<this.$2;$3++){this.$0[$3]=this.$0[$3]-$p0.$0[$3];}}this.$5();},$8:function($p0){var $0=new MSP._P$5('0');for(var $1=0;$1<$p0.$2+this.$2;$1++){if($1<MSCo.CollectionHelper.arrayLength($0.$0)){$0.$0[$1]=0;}else{$0.$0.insert($1,0);}}for(var $2=0;$2<$p0.$2;$2++){for(var $3=0;$3<this.$2;$3++){$0.$0[$2+$3]=$0.$0[$2+$3]+($p0.$0[$2]*this.$0[$3]);if($0.$0[$2+$3]){$0.$2=Math.max($0.$2,$2+$3+1);}}$0.$5();}$0.$1=$p0.$1!==this.$1;return $0;},$9:function($p0){while(true){if(!$p0.$2||!this.$2){break;}var $0=this.$2-$p0.$2;if($0<0){break;}var $1=this.$0[this.$2-1];var $2=$p0.$0[$p0.$2-1];if($1>=$2){var $3=MSP._P$6.$3($1/$2);for(var $4=0;$4<$p0.$2;$4++){this.$0[$4+$0]=this.$0[$4+$0]-($3*$p0.$0[$4]);}this.$5();continue;}if(!$0){break;}this.$0[this.$2-2]=this.$0[this.$2-2]+(1000*this.$0[this.$2-1]);this.$2--;}if(this.$1){if($p0.$1){$p0.$1=false;this.$7($p0);$p0.$1=true;}else{this.$7($p0);}}this.$5();}}
MSP._P$20=function(events,host){MSP._P$20.constructBase(this,['NS',host]);this.$1_2=events;}
MSP._P$20.prototype={$1_1:17,$1_2:null,$1_3:null,$1_4:null,$1_5:function($p0){if($p0.length!==2){this.$1_1B('ADL',$p0);return;}var $0=this.getPendingCommand(MSP._P$6.$F($p0[0]));if($0){$0.onComplete(0,null);}else if($p0[1]==='OK'){}else{var $1=new MSP.ContactListReader($p0[1]);if($1.parse()){this.$1_2.onSubscribeNotificationReceived($1.get_imAddress());}}},$1_6:function($p0){if($p0.length!==2){this.$1_1B('CHL',$p0);return;}var $0='PROD0090YUAUV{2B';var $1=$p0[1];var $2=new MSP._P$8().$1($1,$0,'YMM8C_H7KCQ2S_KL');this.$1_28($0,$2);this.getPendingCommand(MSP._P$6.$F($p0[0]));},$1_7:function($p0){if($p0.length!==3&&$p0.length!==4){this.$1_1B('FLN',$p0);return;}var $0=MC.$create_IMAddressInfo(MSP._P$6.$B($p0[0]),MSP.MsnpHelper.parseIMAddressInfoType($p0[1]),0);var $1=1;var $2=null;var $3=MSP.MsnpHelper.parseCapabilities($p0[2]);var $4=String.Empty;if($p0.length>3){$4=MSP._P$6.$B($p0[3]);}var $5=MC.$create_PresenceInfo($1,$2,null,$4,$3,null);this.$1_2.onPresenceChanged($0,$5,null);},$1_8:function($p0){if($p0.length!==2){this.$1_1B('GCF',$p0);return;}var $0=MSCo.XmlHelper.parseXmlDocument($p0[1]);if($0){var $1=$0.selectNodes('/Policies/Policy');for(var $2=0;$2<MSCo.XmlHelper.xmlNodeListCount($1);$2++){var $3=MSCo.XmlHelper.xmlNodeValue($1[$2].selectSingleNode('@type'));this.$1_2.onPolicyReceived(MSCo.StringHelper.toLowerCase($3),MSCo.XmlHelper.xmlNodeText($1[$2]));}}},$1_9:function($p0){if($p0.length!==7&&$p0.length!==8){this.$1_1B('ILN',$p0);return;}var $0=MC.$create_IMAddressInfo(MSP._P$6.$B($p0[2]),MSP.MsnpHelper.parseIMAddressInfoType($p0[3]),0);var $1=MSP.MsnpHelper.parseStatus($p0[1]);var $2=MSP._P$6.$B($p0[4]);var $3=MSP.MsnpHelper.parseCapabilities($p0[5]);var $4=MSP._P$6.$B($p0[6]);var $5=String.Empty;if($p0.length>7){$5=MSP._P$6.$B($p0[7]);}var $6=this.$1_35($0,$1,$2,$4,$5,$3);this.$1_2.onPresenceChanged($0,$6,null);},$1_A:function($p0){if($p0.length!==3){this.$1_1B('MSG',$p0);return;}if($p0[0]!=='Hotmail'||$p0[1]!=='Hotmail'){return;}var $0=new MSM.MimeParser($p0[2]);var $1=MSCo.StringHelper.splitChar($0.getHeader('Content-Type'),';')[0];switch($1){case'text/x-msmsgsprofile':var $2=MC.$create_SettingsInfo();$2.hasInbox=($0.getHeader('EmailEnabled')==='1');$2.hasInboxChanged=true;$2.lcid=MSP._P$6.$D($0.getHeader('lang_preference'));$2.lcidChanged=true;this.$1_2.onSettingsChanged($2);break;case'text/x-msmsgsinitialmdatanotification':case'text/x-msmsgsactivemailnotification':case'text/x-msmsgsemailnotification':case'text/x-msmsgsoimnotification':var $3=new MSP.MailNotificationParser($0);if($3.parse()){for(var $4=0;$4<$3.get_notifications().length;$4++){this.$1_2.onMailNotificationReceived($3.get_notifications()[$4]);}}else{MSCo.LogHelper.loggerWarning(this.get_logger(),'CsConnection.OnServerMsg','Failed to parse mail notification: '+$p0[2]);}break;case'text/x-msmsgsservicemessage':break;case'text/x-msmsgsfamilysafetysettings':break;default:break;}},$1_B:function($p0){if($p0.length!==2){this.$1_1B('NFY',$p0);return;}},$1_C:function($p0){if($p0.length!==6&&$p0.length!==7){this.$1_1B('NLN',$p0);return;}var $0=MC.$create_IMAddressInfo(MSP._P$6.$B($p0[1]),MSP.MsnpHelper.parseIMAddressInfoType($p0[2]),0);var $1=MSP.MsnpHelper.parseStatus($p0[0]);var $2=MSP._P$6.$B($p0[3]);var $3=MSP.MsnpHelper.parseCapabilities($p0[4]);var $4=MSP._P$6.$B($p0[5]);var $5=String.Empty;if($p0.length>6){$5=MSP._P$6.$B($p0[6]);}var $6=this.$1_35($0,$1,$2,$4,$5,$3);this.$1_2.onPresenceChanged($0,$6,null);},$1_D:function($p0){if($p0.length!==1){this.$1_1B('NOT',$p0);return;}this.$1_1C($p0[0]);},$1_E:function($p0){if($p0.length&&$p0.length!==1&&$p0.length!==2){this.$1_1B('OUT',$p0);return;}if($p0.length>0){switch($p0[0]){case'OTH':this.$1_2.onDisconnected(2);break;case'TME':this.$1_2.onDisconnected(3);break;case'RCT':case'SSD':default:this.$1_2.onDisconnected(1);break;}}else{this.$1_2.onDisconnected(1);}},$1_F:function($p0){if($p0.length!==1){this.$1_1B('RFS',$p0);return;}var $0=MSP._P$6.$10($p0[0]);if(($0&2)){this.$1_2.onPresenceLost();}},$1_10:function($p0){if($p0.length!==2){this.$1_1B('RML',$p0);return;}var $0=this.getPendingCommand(MSP._P$6.$F($p0[0]));if($0){$0.onComplete(0,null);}else{}},$1_11:function($p0){if($p0.length!==8&&$p0.length!==9){this.$1_1B('RNG',$p0);return;}var $0=MSCo.StringHelper.splitChar($p0[1],':');var $1=MC.$create_IMAddressInfo(MSP._P$6.$B($p0[4]),0,0);this.$1_2.onIncomingChatRequest($1,$0[0],$p0[0],$p0[3]);},$1_12:function($p0){if($p0.length!==2){this.$1_1B('SBS',$p0);return;}var $0=new MSP.PremiumFeatureParser($p0[1]);if($0.parse()){var $1=MC.$create_SettingsInfo();$1.prepaidMobileMessaging=$0.get_prepaidMobileMessaging();$1.partnerMobileMessaging=$0.get_partnerMobileMessaging();this.$1_2.onSettingsChanged($1);}this.getPendingCommand(MSP._P$6.$F($p0[0]));},$1_13:function($p0){if($p0.length!==6){this.$1_1B('UBM',$p0);return;}var $0=0;var $1=MC.$create_IMAddressInfo($p0[$0++],MSP.MsnpHelper.parseIMAddressInfoType($p0[$0++]),0);var $2=MC.$create_IMAddressInfo($p0[$0++],MSP.MsnpHelper.parseIMAddressInfoType($p0[$0++]),0);this.$1_2.onPageReceived($p0[5],$1,$2);},$1_14:function($p0){if($p0.length!==2&&$p0.length!==3){this.$1_1B('UBN',$p0);return;}var $0=MSP._P$6.$0(MSP._P$6.$B($p0[0]));var $1=1;var $2=MC.$create_IMAddressInfo($0[0],$1,0);var $3=MSP._P$6.$D($p0[1]);var $4=String.Empty;if($p0.length>=3){$4=$p0[2];}var $5=MC.$create_NotificationInfo();$5.type=$3;$5.content=$4;this.$1_2.onNotificationReceived($2,$0[1],$5);},$1_15:function($p0){if($p0.length!==2&&$p0.length!==3){this.$1_1B('UBX',$p0);return;}var $0=MC.$create_IMAddressInfo(MSP._P$6.$B($p0[0]),MSP.MsnpHelper.parseIMAddressInfoType($p0[1]),0);var $1=null;var $2=null;if($p0.length>2){var $3=new MSP.PresenceParser($p0[2]);if(!$3.parse()){return;}$1=$3.get_presence();$2=$3.get_endpointPresence();}else{$1=MC.$create_PresenceInfo(0,null,null,null,null,null);}this.$1_2.onPresenceChanged($0,$1,$2);},$1_16:function($p0){if($p0.length!==4&&$p0.length!==5){this.$1_1B('USR',$p0);return;}var $0=this.getPendingCommand(MSP._P$6.$F($p0[0]));if($p0[1]==='TWN'&&$p0[2]==='S'){if($p0.length!==4){return;}}else if($p0[1]==='OK'){if($p0.length!==5){return;}var $1=($p0[3]!=='1');var $2=($p0[4]!=='0');var $3=($p0[4]==='1');if($1){}var $4=MC.$create_SettingsInfo();$4.isIdentityUnverified=$1;$4.isIdentityUnverifiedChanged=true;this.$1_2.onSettingsChanged($4);}if($0){$0.onComplete(0,null);}},$1_17:function($p0){if($p0.length<2){this.$1_1B('VER',$p0);return;}var $0=this.getPendingCommand(MSP._P$6.$F($p0[0]));var $1=false;for(var $2=1;!$1&&$2<$p0.length;$2++){for(var $3=0;!$1&&$3<MSP._P$20.$1_0.length;$3++){if($p0[$2]===MSP._P$20.$1_0[$3]){this.$1_1=MSP._P$6.$D(MSCo.StringHelper.substringToEnd($p0[$2],4));$1=true;}}}if($0){if(!$1){$0.onComplete(500,null);}else{$0.onComplete(0,null);}}},$1_18:function($p0){if($p0.length!==7&&$p0.length!==8&&$p0.length!==5&&$p0.length!==4){this.$1_1B('XFR',$p0);return;}var $0=this.getPendingCommand(MSP._P$6.$F($p0[0]));if($p0[1]==='SB'&&$p0[3]==='CKI'){var $1=MSCo.StringHelper.splitChar($p0[2],':');var $2=MSCo.StringHelper.splitChar($p0[4],'.')[0];var $3=true;if($0){$0.onComplete(0,[$1[0],$3,$2,$p0[4]]);}}else if($p0[1]==='NS'){var $4=($p0[3]==='M');var $5=MSCo.StringHelper.splitChar($p0[2],':');this.$1_2.onTransferred($5[0],$4);}},$1_19:function($p0,$p1){if($p1.length<1){this.$1_1B($p0,$p1);return;}var $0=MSP._P$6.$F($p1[0]);var $1=this.getPendingCommand($0);if($1){$1.onComplete(0,$p1);}},$1_1A:function($p0,$p1,$p2){var $0=this.getPendingCommand($p1);MSCo.LogHelper.loggerWarning(this.get_logger(),'CsConnection.OnServerError','Error: '+$p0+' '+$p2);if($0){var $1=$p0;if($1===511){$1=500;if(!String.isNullOrEmpty($p2)){var $2='<msnp>';var $3=$p2.indexOf($2);if($3>=0){$3+=$2.length;var $4=$p2.indexOf('</msnp>',$3);if($4>=0){var $5=MSCo.StringHelper.substring($p2,$3,$4-$3);$1=MSP._P$6.$D($5);}}}}$0.onComplete($1,$p2);}},$1_1B:function($p0,$p1){MSCo.LogHelper.loggerError(this.get_logger(),'CsConnection.OnUnexpectedArgument',String.format('{0}: Unexpected number of arguments: {1}',$p0,$p1.length));},$1_1C:function($p0){$p0=MSP._P$6.$13($p0);var $0=MSCo.XmlHelper.parseXmlDocument($p0);var $1=$0.documentElement;if(!$1){MSCo.LogHelper.loggerWarning(this.get_logger(),'CsConnection.OnAlert','OnAlert: Received invalid notification XML. Ignoring.');return;}if(MSP._P$6.$5($1)!=='NOTIFICATION'){return;}var $2=MSP._P$6.$16($1,'siteid');var $3=MSP._P$6.$16($1,'siteurl');if($2==='111100110'&&MSP._P$6.$11($3)==='isp.messenger.msn.com'){this.$1_1D($1);}},$1_1D:function($p0){var $0=MSP._P$6.$15($p0,'MSG');if(!$0){return;}var $1=MSP._P$6.$15($0,'BODY');if(!$1){return;}var $2=MSP._P$6.$15($1,'USERSTATUS');if(!$2){return;}if('subscriptionchange'!==MSP._P$6.$16($2,'value')){return;}this.$1_25();},$1_1E:function($p0){this.$1_3=$p0;},$1_1F:function($p0){return this.$1_3&&this.$1_3.indexOf($p0)>=0;},$1_20:function($p0){this.sendCommand(['ADL',this.get_nextTrid(),String.format('<ml l=\"{0}\" />',3)],$p0);},$1_21:function($p0,$p1,$p2){var $0=($p0)?1:0;var $1=new MSP.ContactListWriter($0,$p1).getPayloads();for(var $2=0;$2<$1.length;$2++){this.sendCommand(['ADL',this.get_nextTrid(),$1[$2]],$p2);}return $1.length;},$1_22:function($p0,$p1){var $0=($p0===2)?'AL':'BL';this.sendCommand(['BLP',this.get_nextTrid(),$0],$p1);},$1_23:function($p0,$p1,$p2,$p3){if(String.isNullOrEmpty($p2)){$p2='1';}else{$p2=MSP._P$6.$A($p2);}this.sendCommand(['CHG',this.get_nextTrid(),MSP.MsnpHelper.formatStatus($p0),MSP.MsnpHelper.formatCapabilities($p1),$p2],$p3);},$1_24:function($p0,$p1,$p2){this.sendCommand(['CVR',this.get_nextTrid(),'0x0409','winnt','5.2','i386','msgrlib','1.0.0.0',MSP._P$6.$A($p1),MSP._P$6.$A($p0)],$p2);},$1_25:function(){this.sendCommand(['GSB',this.get_nextTrid()],null);},$1_26:function(){this.sendCommand(['OUT',this.get_nextTrid()],null);},$1_27:function($p0,$p1,$p2){if(String.isNullOrEmpty($p1)){$p1=$p0;}this.sendCommand(['PRP',this.get_nextTrid(),'MFN',MSP._P$6.$A($p1)],$p2);},$1_28:function($p0,$p1){this.sendCommand(['QRY',this.get_nextTrid(),$p0,$p1],null);},$1_29:function($p0,$p1){var $0=new MSP.ContactListWriter(0,[$p0]).getPayloads();this.sendCommand(['RML',this.get_nextTrid(),$0[0]],$p1);},$1_2A:function($p0,$p1){this.sendCommand(['USR',this.get_nextTrid(),'TWN','I',MSP._P$6.$A($p0)],$p1);},$1_2B:function($p0,$p1,$p2){this.sendCommand(['USR',this.get_nextTrid(),'TWN','S',MSP._P$6.$A($p0),$p1],$p2);},$1_2C:function($p0,$p1,$p2,$p3,$p4){this.sendCommand(['USR',this.get_nextTrid(),'DAT','11:'+$p1,'12:'+$p0,$p2,$p3],$p4);},$1_2D:function($p0,$p1){this.sendCommand(['USR',this.get_nextTrid(),'WEB',$p0],$p1);},$1_2E:function($p0,$p1,$p2,$p3,$p4){if(String.isNullOrEmpty($p3)){$p3=' ';}var $0=MSP._P$6.$A($p0.address);if(!String.isNullOrEmpty($p1)){$0+=';'+$p1;}this.sendCommand(['UUN',this.get_nextTrid(),$0,$p2,$p3],$p4);},$1_2F:function($p0,$p1,$p2,$p3){this.sendCommand(['UUM',this.get_nextTrid(),MSP._P$6.$A($p0.address),$p0.type,$p1,$p2],$p3);},$1_30:function($p0,$p1){this.sendCommand(['UUX',this.get_nextTrid(),MSP.MsnpHelper.formatGlobalData($p0)],$p1);},$1_31:function($p0,$p1){this.sendCommand(['UUX',this.get_nextTrid(),MSP.MsnpHelper.formatEndpointData($p0)],$p1);},$1_32:function($p0,$p1){this.sendCommand(['UUX',this.get_nextTrid(),MSP.MsnpHelper.formatPrivateEndpointData($p0)],$p1);},$1_33:function($p0){this.sendCommand(['VER',this.get_nextTrid(),MSCo.StringHelper.join(MSP._P$20.$1_0)],$p0);},$1_34:function($p0){this.sendCommand(['XFR',this.get_nextTrid(),'SB'],$p0);},onDisconnected:function($p0){MSCo.LogHelper.loggerWarning(this.get_logger(),'CsConnection.OnDisconnected',String.format('Disconnected due to error code {0}',$p0));this.$1_2.onDisconnected((!$p0)?0:1);},onCommandReceived:function($p0){if(this.$1_1F($p0.get_name())){return;}var $0=$p0.get_allParameters();switch($p0.get_name()){case'BLP':case'CHG':case'CVR':case'QRY':case'PRP':case'UUN':case'UUX':this.$1_19($p0.get_name(),$0);break;case'ADL':this.$1_5($0);break;case'CHL':this.$1_6($0);break;case'FLN':this.$1_7($0);break;case'GCF':this.$1_8($0);break;case'ILN':this.$1_9($0);break;case'MSG':this.$1_A($0);break;case'NFY':this.$1_B($0);break;case'NLN':this.$1_C($0);break;case'NOT':this.$1_D($0);break;case'OUT':this.$1_E($0);break;case'RFS':this.$1_F($0);break;case'RML':this.$1_10($0);break;case'RNG':this.$1_11($0);break;case'SBS':this.$1_12($0);break;case'UBM':this.$1_13($0);break;case'UBN':this.$1_14($0);break;case'UBX':this.$1_15($0);break;case'USR':this.$1_16($0);break;case'VER':this.$1_17($0);break;case'XFR':this.$1_18($0);break;default:var $1=MSP._P$6.$C($p0.get_name());if($1<0){return;}var $2=MSP._P$6.$F($0[0]);this.$1_1A($1,$2,($0.length>1)?$0[1]:null);break;}},$1_35:function($p0,$p1,$p2,$p3,$p4,$p5){var $0=false;var $1=false;if($p0.type===1){var $3='(E-mail Address Not Verified)';if($p2.endsWith($3)){$p2=($p2.remove($p2.length-$3.length)).trimEnd();$0=true;}$1=true;}if($p2===$p0.address){$p2=String.Empty;}if(String.isNullOrEmpty($p4)){if(this.$1_4&&!String.isNullOrEmpty(this.$1_4.networkIconUrl)){switch($p0.type){case 1:$p4=this.$1_4.networkIconUrl+'live.png';break;case 2:$p4=this.$1_4.networkIconUrl+'office.png';break;}}}var $2=MC.$create_PresenceInfo($p1,$p2,null,$p4,$p5,null);$2.displayPictureKey=$p3;if($1){$2.isIdentityUnverified=$0;$2.isIdentityUnverifiedChanged=true;}return $2;}}
MSP.ContactListReader=function(payload){this.$0=payload;}
MSP.ContactListReader.prototype={$0:null,$1:null,$2:false,$3:false,get_imAddress:function(){return this.$1;},parse:function(){if(this.$2){return this.$3;}var $0=MSCo.XmlHelper.parseXmlDocument(this.$0);var $1=$0.documentElement;if(!$1){return this.$4('Parse: Invalid XML');}if(MSP._P$6.$5($1)!=='ml'){return this.$4(String.format('Parse: Unknown root node {0}',MSP._P$6.$5($1)));}var $2=MSP._P$6.$15($1,'d');if(!$2){return this.$4('Parse: Missing d element.');}var $3=MSP._P$6.$15($2,'c');if(!$3){return this.$4('Parse: Missing c element.');}var $4=MSP._P$6.$16($3,'n');var $5=MSP._P$6.$16($2,'n');if(MSCo.StringHelper.isNull($4)||MSCo.StringHelper.isNull($5)){return this.$4('Parse: Invalid user handle.');}var $6=String.format('{0}@{1}',$4,$5);var $7=0;var $8=MSP._P$6.$16($3,'t');if($8){$7=MSP.MsnpHelper.parseIMAddressInfoType($8);}var $9=0;var $A=MSP._P$6.$16($3,'l');if($A){$9=MSP.MsnpHelper.parseRoleLists($A);}this.$1=MC.$create_IMAddressInfo(MSP._P$6.$B($6),$7,$9);return this.$5();},$4:function($p0){this.$2=true;this.$3=false;return this.$3;},$5:function(){this.$2=true;this.$3=true;return this.$3;}}
MSP.ContactListWriter=function(listType,addresses){this.$2={};this.$3=[];this.$4=[];this.$5=new StringBuilder();this.$0=listType;this.$1=addresses;}
MSP.ContactListWriter.prototype={$0:0,$1:null,$6:0,$7:false,$9:function(){for(var $0=0;$0<this.$1.length;$0++){var $1=this.$1[$0];var $2=this.$C($1.roleLists);if(this.$0===1&&!$2){}else if($1.type===4){this.$3.add($1);}else{var $3=this.$A($1.address);if($3!==''){$3=MSCo.XmlHelper.xmlEscape($3);if(!this.$2[$3]){this.$2[$3]=[];}var $4=this.$2[$3];$4.add($1);}}}},$A:function($p0){var $0=$p0.indexOf('@');if($0!==-1){return MSCo.StringHelper.substringToEnd($p0,$0+1);}return'';},$B:function($p0){var $0=$p0.indexOf('@');if($0!==-1){return $p0.substring(0,$0);}return'';},$C:function($p0){$p0=$p0&(2|1|4);if(($p0&(2|4))===(2|4)){$p0&=~2;}return $p0;},$D:function($p0){this.$5.append($p0);this.$6+=$p0.length;},$E:function(){this.$D(String.format('<ml l=\"{0}\">',this.$0));},$F:function($p0){this.$D('</ml>');var $0=this.$5.toString();if(this.$0===1&&!$p0){$0=MSP._P$6.$4($0,'^<ml l=\"1\">','<ml l=\"0\">');}this.$4.add($0);this.$5=new StringBuilder();this.$6=0;},$10:function($p0){this.$D(String.format('<d n=\"{0}\">',$p0));},$11:function(){this.$D('</d>');},$12:function($p0){var $0=this.$C($p0.roleLists);this.$D(String.format('<c n=\"{0}\" ',MSCo.XmlHelper.xmlEscape(this.$B($p0.address))));this.$D(String.format('l=\"{0}\" ',$0));this.$D(String.format('t=\"{0}\" ',$p0.type));this.$D('/>');},$13:function(){this.$D('<t>');},$14:function(){this.$D('</t>');},$15:function($p0){this.$D(String.format('<c n=\"tel:{0}\" l=\"{1}\" />',MSCo.XmlHelper.xmlEscape($p0.address),this.$C($p0.roleLists)));},getPayloads:function(){if(this.$7){return MSCo.StringHelper.listToArray(this.$4);}this.$9();this.$E();var $dict1=this.$2;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};this.$10($0.key);var $1=$0.value;for(var $2=0;$2<MSCo.CollectionHelper.arrayLength($1);$2++){var $3=($2===MSCo.CollectionHelper.arrayLength($1)-1);this.$12($1[$2]);if(this.$6>MSP.ContactListWriter.$8){this.$11();this.$F(false);this.$E();if(!$3){this.$10($0.key);}}else if($3){this.$11();}}}if(MSCo.CollectionHelper.arrayLength(this.$3)>0){this.$13();for(var $4=0;$4<MSCo.CollectionHelper.arrayLength(this.$3);$4++){var $5=($4===MSCo.CollectionHelper.arrayLength(this.$3)-1);this.$15(this.$3[$4]);if(this.$6>MSP.ContactListWriter.$8){this.$14();this.$F(false);this.$E();if(!$5){this.$13();}}else if($5){this.$14();}}}this.$F(true);this.$7=true;return MSCo.StringHelper.listToArray(this.$4);}}
MSP.MailNotificationParser=function(message){this.$0=message;}
MSP.MailNotificationParser.$2=function($p0){switch(MSCo.StringHelper.toLowerCase($p0)){case'active':return 0;case'saved':return 3;case'draft':return 4;case'trash':return 1;case'hm_bulkmail_':return 2;case'00000000-0000-0000-0000-000000000006':return 6;default:return 5;}}
MSP.MailNotificationParser.prototype={$0:null,$1:null,get_notifications:function(){return this.$1;},parse:function(){var $0=new MSM.MimeParser(this.$0.getBody());var $1=MSCo.StringHelper.splitChar(this.$0.getHeader('Content-Type'),';')[0];switch($1){case'text/x-msmsgsinitialmdatanotification':var $2=MSCo.XmlHelper.parseXmlDocument($0.getHeader('Mail-Data'));var $3=(($2)?$2.documentElement:null);if(!$3){MSCo.LogHelper.logError('Presence.MailNotificationParser.Parse','Unable to parse mail data: '+$0.getHeader('Mail-Data'));return false;}var $4=$3.selectSingleNode('E');if(!$4){return false;}var $5=['IU','I','OU','O'];var $6=[0,0,0,0];for(var $7=0;$7<$5.length;$7++){var $8=$4.selectSingleNode($5[$7]);if($8){var $9=MSCo.XmlHelper.xmlNodeValue($8.firstChild);if(!MSCo.StringHelper.isNull($9)){$6[$7]=MSP._P$6.$D($9);}}}this.$1=[MC.$create_MailNotificationInfo(MC.$create_MailNotificationInitialInfo($6[0],$6[1],$6[2],$6[3]),0)];return true;case'text/x-msmsgsemailnotification':this.$1=[MC.$create_MailNotificationInfo(MC.$create_MailNotificationIncomingInfo($0.getHeader('From'),$0.getHeader('From-Addr'),$0.getHeader('Message-URL'),$0.getHeader('Subject'),MSP.MailNotificationParser.$2($0.getHeader('Dest-Folder')),$0.getHeader('id')),1),MC.$create_MailNotificationInfo(new MC.MailNotificationActivityInfo(0,0,-1),2)];return true;case'text/x-msmsgsactivemailnotification':this.$1=[MC.$create_MailNotificationInfo(new MC.MailNotificationActivityInfo(MSP.MailNotificationParser.$2($0.getHeader('Src-Folder')),MSP.MailNotificationParser.$2($0.getHeader('Dest-Folder')),MSP._P$6.$D($0.getHeader('Message-Delta'))),2)];return true;}return false;}}
MSP._P$9=function(){this.$12=[0,0,0,0];this.$13=[0,0];this.$14=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.$15();}
MSP._P$9.f=function($p0,$p1,$p2){return(($p0&$p1)|((~$p0)&$p2));}
MSP._P$9.g=function($p0,$p1,$p2){return(($p0&$p2)|($p1&(~$p2)));}
MSP._P$9.h=function($p0,$p1,$p2){return($p0^$p1^$p2);}
MSP._P$9.i=function($p0,$p1,$p2){return($p1^($p0|(~$p2)));}
MSP._P$9.$11=function($p0,$p1){return(($p0<<$p1)|($p0>>>(32-$p1)));}
MSP._P$9.FF=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP._P$9.f($p1,$p2,$p3)+$p4+$p6;$p0=MSP._P$9.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP._P$9.GG=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP._P$9.g($p1,$p2,$p3)+$p4+$p6;$p0=MSP._P$9.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP._P$9.HH=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP._P$9.h($p1,$p2,$p3)+$p4+$p6;$p0=MSP._P$9.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP._P$9.II=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0+=MSP._P$9.i($p1,$p2,$p3)+$p4+$p6;$p0=MSP._P$9.$11($p0,$p5);$p0+=$p1;return $p0;}
MSP._P$9.$1B=function($p0,$p1,$p2,$p3,$p4){for(var $0=0;$0<$p4;$0++){$p2[$p3+$0]=$p0[$p1+$0];}}
MSP._P$9.prototype={$15:function(){this.$13[0]=this.$13[1]=0;this.$12[0]=1732584193;this.$12[1]=4023233417;this.$12[2]=2562383102;this.$12[3]=271733878;},$16:function($p0,$p1,$p2){var $0;var $1;var $2;$1=((this.$13[0]>>>3)&63);if((this.$13[0]+=($p2<<3))<($p2<<3)){this.$13[1]++;}this.$13[1]+=($p2>>>29);$2=64-$1;if($p2>=$2){MSP._P$9.$1B($p0,$p1,this.$14,$1,$2);this.$18(this.$14,0);for($0=$2;$0+63<$p2;$0+=64){this.$18($p0,$p1+$0);}$1=0;}else{$0=0;}MSP._P$9.$1B($p0,$p1+$0,this.$14,$1,$p2-$0);},$17:function(){var $0=new Array(16);var $1=new Array(8);var $2,$3;this.$19($1,0,this.$13,0,8);$2=((this.$13[0]>>>3)&63);$3=($2<56)?(56-$2):(120-$2);this.$16(MSP._P$9.$10,0,$3);this.$16($1,0,8);this.$19($0,0,this.$12,0,16);this.$13[0]=this.$13[1]=0;this.$12[0]=0;this.$12[1]=0;this.$12[2]=0;this.$12[3]=0;this.$15();return $0;},$18:function($p0,$p1){var $0=this.$12[0],$1=this.$12[1],$2=this.$12[2],$3=this.$12[3];var $4=new Array(16);this.$1A($4,0,$p0,$p1,64);$0=MSP._P$9.FF($0,$1,$2,$3,$4[0],7,3614090360);$3=MSP._P$9.FF($3,$0,$1,$2,$4[1],12,3905402710);$2=MSP._P$9.FF($2,$3,$0,$1,$4[2],17,606105819);$1=MSP._P$9.FF($1,$2,$3,$0,$4[3],22,3250441966);$0=MSP._P$9.FF($0,$1,$2,$3,$4[4],7,4118548399);$3=MSP._P$9.FF($3,$0,$1,$2,$4[5],12,1200080426);$2=MSP._P$9.FF($2,$3,$0,$1,$4[6],17,2821735955);$1=MSP._P$9.FF($1,$2,$3,$0,$4[7],22,4249261313);$0=MSP._P$9.FF($0,$1,$2,$3,$4[8],7,1770035416);$3=MSP._P$9.FF($3,$0,$1,$2,$4[9],12,2336552879);$2=MSP._P$9.FF($2,$3,$0,$1,$4[10],17,4294925233);$1=MSP._P$9.FF($1,$2,$3,$0,$4[11],22,2304563134);$0=MSP._P$9.FF($0,$1,$2,$3,$4[12],7,1804603682);$3=MSP._P$9.FF($3,$0,$1,$2,$4[13],12,4254626195);$2=MSP._P$9.FF($2,$3,$0,$1,$4[14],17,2792965006);$1=MSP._P$9.FF($1,$2,$3,$0,$4[15],22,1236535329);$0=MSP._P$9.GG($0,$1,$2,$3,$4[1],5,4129170786);$3=MSP._P$9.GG($3,$0,$1,$2,$4[6],9,3225465664);$2=MSP._P$9.GG($2,$3,$0,$1,$4[11],14,643717713);$1=MSP._P$9.GG($1,$2,$3,$0,$4[0],20,3921069994);$0=MSP._P$9.GG($0,$1,$2,$3,$4[5],5,3593408605);$3=MSP._P$9.GG($3,$0,$1,$2,$4[10],9,38016083);$2=MSP._P$9.GG($2,$3,$0,$1,$4[15],14,3634488961);$1=MSP._P$9.GG($1,$2,$3,$0,$4[4],20,3889429448);$0=MSP._P$9.GG($0,$1,$2,$3,$4[9],5,568446438);$3=MSP._P$9.GG($3,$0,$1,$2,$4[14],9,3275163606);$2=MSP._P$9.GG($2,$3,$0,$1,$4[3],14,4107603335);$1=MSP._P$9.GG($1,$2,$3,$0,$4[8],20,1163531501);$0=MSP._P$9.GG($0,$1,$2,$3,$4[13],5,2850285829);$3=MSP._P$9.GG($3,$0,$1,$2,$4[2],9,4243563512);$2=MSP._P$9.GG($2,$3,$0,$1,$4[7],14,1735328473);$1=MSP._P$9.GG($1,$2,$3,$0,$4[12],20,2368359562);$0=MSP._P$9.HH($0,$1,$2,$3,$4[5],4,4294588738);$3=MSP._P$9.HH($3,$0,$1,$2,$4[8],11,2272392833);$2=MSP._P$9.HH($2,$3,$0,$1,$4[11],16,1839030562);$1=MSP._P$9.HH($1,$2,$3,$0,$4[14],23,4259657740);$0=MSP._P$9.HH($0,$1,$2,$3,$4[1],4,2763975236);$3=MSP._P$9.HH($3,$0,$1,$2,$4[4],11,1272893353);$2=MSP._P$9.HH($2,$3,$0,$1,$4[7],16,4139469664);$1=MSP._P$9.HH($1,$2,$3,$0,$4[10],23,3200236656);$0=MSP._P$9.HH($0,$1,$2,$3,$4[13],4,681279174);$3=MSP._P$9.HH($3,$0,$1,$2,$4[0],11,3936430074);$2=MSP._P$9.HH($2,$3,$0,$1,$4[3],16,3572445317);$1=MSP._P$9.HH($1,$2,$3,$0,$4[6],23,76029189);$0=MSP._P$9.HH($0,$1,$2,$3,$4[9],4,3654602809);$3=MSP._P$9.HH($3,$0,$1,$2,$4[12],11,3873151461);$2=MSP._P$9.HH($2,$3,$0,$1,$4[15],16,530742520);$1=MSP._P$9.HH($1,$2,$3,$0,$4[2],23,3299628645);$0=MSP._P$9.II($0,$1,$2,$3,$4[0],6,4096336452);$3=MSP._P$9.II($3,$0,$1,$2,$4[7],10,1126891415);$2=MSP._P$9.II($2,$3,$0,$1,$4[14],15,2878612391);$1=MSP._P$9.II($1,$2,$3,$0,$4[5],21,4237533241);$0=MSP._P$9.II($0,$1,$2,$3,$4[12],6,1700485571);$3=MSP._P$9.II($3,$0,$1,$2,$4[3],10,2399980690);$2=MSP._P$9.II($2,$3,$0,$1,$4[10],15,4293915773);$1=MSP._P$9.II($1,$2,$3,$0,$4[1],21,2240044497);$0=MSP._P$9.II($0,$1,$2,$3,$4[8],6,1873313359);$3=MSP._P$9.II($3,$0,$1,$2,$4[15],10,4264355552);$2=MSP._P$9.II($2,$3,$0,$1,$4[6],15,2734768916);$1=MSP._P$9.II($1,$2,$3,$0,$4[13],21,1309151649);$0=MSP._P$9.II($0,$1,$2,$3,$4[4],6,4149444226);$3=MSP._P$9.II($3,$0,$1,$2,$4[11],10,3174756917);$2=MSP._P$9.II($2,$3,$0,$1,$4[2],15,718787259);$1=MSP._P$9.II($1,$2,$3,$0,$4[9],21,3951481745);this.$12[0]+=$0;this.$12[1]+=$1;this.$12[2]+=$2;this.$12[3]+=$3;for(var $5=0;$5<$4.length;$5++){$4[$5]=0;}},$19:function($p0,$p1,$p2,$p3,$p4){var $0=$p1+$p4;for(var $1=$p3,$2=$p1;$2<$0;$1++,$2+=4){$p0[$2]=($p2[$1]&255);$p0[$2+1]=(($p2[$1]>>>8)&255);$p0[$2+2]=(($p2[$1]>>>16)&255);$p0[$2+3]=(($p2[$1]>>>24)&255);}},$1A:function($p0,$p1,$p2,$p3,$p4){var $0=$p3+$p4;for(var $1=$p1,$2=$p3;$2<$0;$1++,$2+=4){$p0[$1]=($p2[$2])|(($p2[$2+1])<<8)|(($p2[$2+2])<<16)|(($p2[$2+3])<<24);}},$1C:function($p0){var $0=new Array($p0.length);for(var $4=0;$4<$p0.length;$4++){$0[$4]=$p0.charCodeAt($4);}this.$16($0,0,$0.length);var $1=this.$17();var $2='0123456789abcdef';var $3=new StringBuilder();for(var $5=0;$5<$1.length;$5++){$3.append(MSCo.StringHelper.charAt($2,($1[$5]>>>4)&15));$3.append(MSCo.StringHelper.charAt($2,$1[$5]&15));}return $3.toString();}}
MSP._P$8=function(){}
MSP._P$8.prototype={$0:function($p0){var $0='0123456789abcdef';var $1=new StringBuilder();for(var $2=0;$2<=3;$2++){$1.append(MSCo.StringHelper.charAt($0,($p0>>($2*8+4))&15));$1.append(MSCo.StringHelper.charAt($0,($p0>>($2*8))&15));}return $1.toString();},$1:function($p0,$p1,$p2){var $0=$p0+$p1;var $1=$0;var $2=8-($1.length%8);if($2){$1=$1.padRight($1.length+$2,'0');}var $3=$1.length/4;var $4=[];for(var $C=0,$D=0;$C<$3;$C++){$4.insert($C,0);$4[$C]=$4[$C]+MSCo.StringHelper.charCodeAt($1,$D++)*1;$4[$C]=$4[$C]+MSCo.StringHelper.charCodeAt($1,$D++)*256;$4[$C]=$4[$C]+MSCo.StringHelper.charCodeAt($1,$D++)*65536;$4[$C]=$4[$C]+MSCo.StringHelper.charCodeAt($1,$D++)*16777216;}var $5=new Array(4);var $6=MSP._P$6.$1($p0+$p2);for(var $E=0,$F=0;$E<$5.length;$E++){$5[$E]=0;$5[$E]+=MSP._P$6.$E(MSCo.StringHelper.substring($6,$F,2))*1;$F+=2;$5[$E]+=MSP._P$6.$E(MSCo.StringHelper.substring($6,$F,2))*256;$F+=2;$5[$E]+=MSP._P$6.$E(MSCo.StringHelper.substring($6,$F,2))*65536;$F+=2;$5[$E]+=MSP._P$6.$E(MSCo.StringHelper.substring($6,$F,2))*16777216;$F+=2;}var $7=new Array(2);this.$2($4,$5,$7);var $8=MSP._P$6.$9($5[0],$7[0]);var $9=MSP._P$6.$9($5[1],$7[1]);var $A=MSP._P$6.$9($5[2],$7[0]);var $B=MSP._P$6.$9($5[3],$7[1]);return this.$0($8)+this.$0($9)+this.$0($A)+this.$0($B);},$2:function($p0,$p1,$p2){var $0=2147483647;if(MSCo.CollectionHelper.arrayLength($p0)<2||(MSCo.CollectionHelper.arrayLength($p0)&1)===1){return false;}var $1=$p1[0]&$0;var $2=$p1[1]&$0;var $3=$p1[2]&$0;var $4=$p1[3]&$0;var $5=242854337;var $6=new MSP._P$5($1.toString());var $7=new MSP._P$5($2.toString());var $8=new MSP._P$5($3.toString());var $9=new MSP._P$5($4.toString());var $A=new MSP._P$5($5.toString());var $B=0;var $C=new MSP._P$5($0.toString());var $D=new MSP._P$5('0');var $E=new MSP._P$5('0');var $F=new MSP._P$5('0');for(var $10=0;$10<MSCo.CollectionHelper.arrayLength($p0)/2;$10++){$D=$A.$8(new MSP._P$5($p0[$B++].toString()));$D.$9($C);$E.$7($D);$E=$E.$8($6);$E.$7($7);$E.$9($C);$F.$7($E);$E.$7(new MSP._P$5($p0[$B++].toString()));$E=$E.$8($8);$E.$7($9);$E.$9($C);$F.$7($E);}$E.$7($7);$E.$9($C);$F.$7($9);$F.$9($C);$p2[0]=MSP._P$6.$D($E.toString());$p2[1]=MSP._P$6.$D($F.toString());return true;}}
MSP.PremiumFeatureParser=function(features){this.$3=MC.$create_PremiumFeatureInfo(false,false,false);this.$4=MC.$create_PremiumFeatureInfo(false,false,false);this.$2=features;}
MSP.PremiumFeatureParser.prototype={$2:null,$5:false,$6:false,get_prepaidMobileMessaging:function(){return this.$3;},get_partnerMobileMessaging:function(){return this.$4;},parse:function(){if(this.$5){return this.$6;}if(this.$2==='null'){this.$6=true;this.$5=true;return this.$6;}var $0=MSCo.StringHelper.splitChar(this.$2,'|');for(var $1=0;$1<$0.length;$1++){var $2=MSCo.StringHelper.splitChar($0[$1],';');var $3=null;var $4=null;var $5=null;var $6=null;for(var $A=0;$A<$2.length;$A++){var $B=MSCo.StringHelper.splitChar($2[$A],'=');switch($B[0]){case'SC':$3=MSCo.StringHelper.toLowerCase($B[1]);break;case'SI':$4=MSCo.StringHelper.toLowerCase($B[1]);break;case'SS':$5=$B[1];break;case'PS':$6=$B[1];break;default:break;}}if((String.isNullOrEmpty($3))||(String.isNullOrEmpty($4))||(String.isNullOrEmpty($5))||(String.isNullOrEmpty($6))||($3.length!==32)){this.$5=true;this.$6=false;return this.$6;}var $7=('2'===$5);var $8=('3'===$5);var $9=('2'===$6);if($3==='2ad5b0fad0464b7f9577c2a3ac0a13f1'){this.$3=MC.$create_PremiumFeatureInfo($9,$7,$8);}else if($3==='88e53f49b577463dba43689bd59205be'){this.$4=MC.$create_PremiumFeatureInfo($9,$7,$8);}}this.$6=true;this.$5=true;return this.$6;}}
MSP.PresenceParser=function(document){this.$0=MSP._P$6.$13(document);}
MSP.PresenceParser.prototype={$0:null,$1:false,$2:false,$3:null,$4:null,get_presence:function(){return this.$3;},get_endpointPresence:function(){return this.$4;},get_$5:function(){return(this.$1&&this.$2);},$6:function($p0){MSCo.LogHelper.logError('Presence.PresenceParser.Parse',$p0);this.$1=true;this.$2=false;return this.$2;},$7:function(){this.$1=true;this.$2=true;return this.$2;},parse:function(){if(this.$1){return this.$2;}if(!this.$0.length){this.$3=MC.$create_PresenceInfo(0,null,null,null,null,null);this.$4=[];return this.$7();}var $0=MSCo.XmlHelper.parseXmlDocument(this.$0);var $1=$0.documentElement;if(!$1){return this.$6(String.format('Parse: Invalid XML {0}',this.$0));}if(MSP._P$6.$5($1)!=='Data'){return this.$6(String.format('Parse: Invalid root node \'{0}\'',MSP._P$6.$5($1)));}var $2={};var $3=[];for(var $6=0;$6<MSP._P$6.$8($1.childNodes);$6++){var $7=$1.childNodes[$6];var $8=MSP._P$6.$6($7);var $9=MSP._P$6.$5($7);if($8===1&&$9==='EndpointData'){var $A=MSP._P$6.$16($7,'id');if(String.isNullOrEmpty($A)){continue;}this.$8($3,$A,$7);}else if($9==='PrivateEndpointData'){var $B=MSP._P$6.$16($7,'id');if(String.isNullOrEmpty($B)){continue;}this.$A($3,$B,$7);}else{this.$F($2,$7);}}var $4=String.Empty;var $5=[];var $dict1=$2;for(var $key2 in $dict1){var $C={key:$key2,value:$dict1[$key2]};if($C.key==='PSM'){$4=$C.value;}else{$5.add(MC.$create_KeyValuePair($C.key,$C.value));}}this.$3=MC.$create_PresenceInfo(0,null,$4,null,null,this.$D($5));this.$4=this.$C($3);return this.$7();},$8:function($p0,$p1,$p2){var $0={};var $1=null;var $2=null;for(var $6=0;$6<MSP._P$6.$8($p2.childNodes);$6++){var $7=$p2.childNodes[$6];if(MSP._P$6.$5($7)==='WebAppData'){$2=MSP._P$6.$16($7,'domain');if(!String.isNullOrEmpty($2)){$1=$7;}}else{this.$F($0,$7);}}var $3=[];var $4=[];var $dict1=$0;for(var $key2 in $dict1){var $8={key:$key2,value:$dict1[$key2]};if($8.key==='Capabilities'){$3=MSP.MsnpHelper.parseCapabilities($8.value);}else{$4.add(MC.$create_KeyValuePair($8.key,$8.value));}}var $5=this.$B($p0,$p1);$5.domain=$2;$5.capabilities=$3;$5.properties=this.$D($4);if($1){this.$9($1,$5);}},$9:function($p0,$p1){var $0=MSP._P$6.$8($p0.childNodes);for(var $1=0;$1<$0;$1++){var $2=$p0.childNodes[$1];var $3=MSP._P$6.$5($2);var $4=MSP._P$6.$6($2);if($4===1&&$3==='MsgIds'){var $5=[];var $6=MSP._P$6.$8($2.childNodes);for(var $7=0;$7<$6;$7++){if(MSP._P$6.$6($2.childNodes[$7])===1&&MSP._P$6.$5($2.childNodes[$7])==='Id'){var $8=this.$10($2.childNodes[$7]);if(!String.isNullOrEmpty($8)){$5.add($8);}}}$p1.applicationMessageIds=this.$E($5);}else if($4===1&&$3==='Properties'){var $9=[];var $A=MSP._P$6.$8($2.childNodes);for(var $B=0;$B<$A;$B++){if(MSP._P$6.$6($2.childNodes[$B])===1){var $C=MSP._P$6.$5($2.childNodes[$B]);var $D=this.$10($2.childNodes[$B]);if(!String.isNullOrEmpty($D)){$9.add(MC.$create_KeyValuePair($C,$D));}}}$p1.webProperties=this.$D($9);}}},$A:function($p0,$p1,$p2){var $0=null;for(var $2=0;$2<MSP._P$6.$8($p2.childNodes);$2++){var $3=$p2.childNodes[$2];if(MSP._P$6.$5($3)==='EpName'){$0=this.$10($3);}}var $1=this.$B($p0,$p1);$1.endpointName=$0;},$B:function($p0,$p1){for(var $1=0;$1<MSCo.CollectionHelper.arrayLength($p0);$1++){var $2=$p0[$1];if($2.id===$p1){return $2;}}var $0=MC.$create_EndpointPresenceInfo($p1,null,null,null,null,null,null);$p0.add($0);return $0;},$C:function($p0){return $p0;},$D:function($p0){return $p0;},$E:function($p0){return $p0;},$F:function($p0,$p1){if(MSP._P$6.$6($p1)===1){var $0=this.$10($p1);if(!String.isNullOrEmpty($0)){$p0[MSP._P$6.$5($p1)]=$0;}}},$10:function($p0){return $p0.text;}}
MSP._P$7=function(cxnService){this.$0=cxnService;}
MSP._P$7.prototype={$0:null,get_$1:function(){return this.$0;},$2:function($p0){this.$17($p0);},$3:function($p0,$p1,$p2,$p3){this.$17($p0);this.$17($p1);this.$17($p2);this.$17($p3);},$4:function($p0){this.$17($p0);},$5:function($p0){this.$17($p0);},$6:function($p0){this.$17($p0);},$7:function($p0){this.$17($p0);},$8:function($p0){this.$17($p0);},$9:function($p0){this.$17($p0);},$A:function($p0){this.$17($p0);},$B:function($p0){this.$17($p0);},$C:function($p0){this.$17($p0);},$D:function($p0){this.$17($p0);},$E:function($p0){this.$17($p0);},$F:function($p0){this.$17($p0);},$10:function($p0){this.$17($p0);},$11:function($p0){this.$17($p0);},$12:function($p0){this.$17($p0);},$13:function($p0){this.$17($p0);},$14:function($p0){this.$17($p0);},$15:function($p0){this.$17($p0);},$16:function($p0){this.$17($p0);},$17:function($p0){}}
MSP._P$16=function(service){MSP._P$16.constructBase(this,[service]);this.$18={};}
MSP._P$16.prototype={$18:null,$4:function($p0){if($p0.get_$14()){this.get_$1().$B(new MSP._P$13(this.get_$1(),$p0));}this.get_$1().$A($p0);},$7:function($p0){this.get_$1().$A($p0);},$D:function($p0){this.get_$1().$A($p0);},$E:function($p0){if(!(this.$1B($p0))){this.get_$1().$A($p0);}},$C:function($p0){this.get_$1().$A($p0);},$11:function($p0){this.get_$1().$A($p0);},$14:function($p0){this.get_$1().$A($p0);},$15:function($p0){this.get_$1().$A($p0);},$13:function($p0){this.get_$1().$A($p0);},$12:function($p0){this.get_$1().$A($p0);},$16:function($p0){this.get_$1().$A($p0);},$5:function($p0){this.get_$1().$A($p0);},$6:function($p0){this.get_$1().$A($p0);},$8:function($p0){this.get_$1().$A($p0);},$9:function($p0){this.get_$1().$A($p0);},$B:function($p0){this.get_$1().$A($p0);},$A:function($p0){this.$19($p0);this.get_$1().$A($p0);},$F:function($p0){this.get_$1().$A($p0);},$10:function($p0){this.get_$1().$A($p0);},$19:function($p0){if($p0.get_$1A()){var $enum1=$p0.get_$18().getEnumerator();while($enum1.moveNext()){var $0=$enum1.get_current();var $1=this.$1C($0);if(!Object.keyExists(this.$18,$1)){this.$18[$1]=[];}}$p0.add_$7(Delegate.create(this,this.$1A));}},$1A:function($p0,$p1){var $0=$p0;var $enum1=$0.get_$18().getEnumerator();while($enum1.moveNext()){var $1=$enum1.get_current();var $2=this.$1C($1);if(Object.keyExists(this.$18,$2)){if($0.get_$19()){var $3=this.$18[$2];while(MSCo.CollectionHelper.queueLength($3)>0){this.get_$1().$A($3.dequeue());}}delete this.$18[$2];}}$0.remove_$7(Delegate.create(this,this.$1A));},$1B:function($p0){var $0=this.$1C($p0.get_$D());if(Object.keyExists(this.$18,$0)){var $1=this.$18[$0];$1.enqueue($p0);return true;}else{return false;}},$1C:function($p0){return $p0.address+':'+$p0.type;}}
MSP._P$11=function(service){this.$1B=[];this.$1C=[];MSP._P$11.constructBase(this,[service]);}
MSP._P$11.prototype={$18:null,$19:null,$1A:false,$1D:false,$1E:null,$1F:null,$20:null,$3:function($p0,$p1,$p2,$p3){this.$18=$p2;this.$19=$p1;this.$1E=$p3;this.$1F=this.$18.get_$12();this.$1D=true;if(MSCo.CollectionHelper.queueLength(this.$1C)>0){while(MSCo.CollectionHelper.queueLength(this.$1C)>0){this.$E(this.$1C.dequeue());}}this.get_$1().$A($p0);},$4:function($p0){if($p0.get_$14()){this.get_$1().$B(new MSP._P$13(this.get_$1(),$p0));}this.get_$1().$A($p0);},$E:function($p0){if(!this.$1D){this.$1C.enqueue($p0);}else{if(($p0.get_$D().address!==this.$18.get_$11().address)||($p0.get_$D().type!==this.$18.get_$11().type)){this.$1B.enqueue($p0);}else{this.$21($p0.get_$E(),$p0.get_$F());if((!$p0.get_$E().status)&&(!this.$1A)){this.$18.add_$7(Delegate.create(this,this.$23));this.get_$1().$A(this.$18);this.get_$1().$A(this.$19);this.$1A=true;}}}},$13:function($p0){this.$1B.enqueue($p0);},$11:function($p0){this.$1B.enqueue($p0);},$F:function($p0){this.get_$1().$B(new MSP._P$12(this.get_$1()));this.get_$1().$A($p0);},$10:function($p0){this.get_$1().$B(new MSP._P$12(this.get_$1()));this.get_$1().$A($p0);},$16:function($p0){this.get_$1().$A($p0);},$21:function($p0,$p1){if(!MSCo.StringHelper.isNull($p0.displayName)){this.$1F.displayName=$p0.displayName;}if($p0.capabilities.length>0){this.$1F.capabilities=$p0.capabilities;}if($p0.status){this.$1F.status=$p0.status;}if(!MSCo.StringHelper.isNull($p0.personalMessage)){this.$1F.personalMessage=$p0.personalMessage;}if(!MSCo.StringHelper.isNull($p0.displayPictureKey)){this.$1F.displayPictureKey=$p0.displayPictureKey;}if(!MSCo.StringHelper.isNull(this.$1F.networkIconUrl)){this.$1F.displayPictureKey=$p0.displayPictureKey;}if(!MSCo.StringHelper.isNull($p0.networkIconUrl)){this.$1F.networkIconUrl=$p0.networkIconUrl;}if(($p0.properties)&&(this.$1F.properties)){this.$1F.properties=this.$22(this.$1F.properties,$p0.properties);}if(($p1)&&($p1.length>0)){this.$20=$p1;}},$22:function($p0,$p1){var $0=[];for(var $1=0;$1<$p1.length;$1++){var $2=false;for(var $3=0;$3<$p0.length;$3++){if($p0[$3].key===$p1[$1].key){$p0[$3].value=$p1[$1].value;$2=true;break;}}if(!$2){$0.add($p1[$1]);}}if(!MSCo.CollectionHelper.arrayLength($0)){return $p0;}else{var $4=new Array($p0.length+MSCo.CollectionHelper.arrayLength($0));for(var $6=0;$6<$p0.length;$6++){$4[$6]=$p0[$6];}var $5=$p0.length;for(var $7=0;$7<MSCo.CollectionHelper.arrayLength($0);$7++){$4[$5+$7]=$0[$7];}return $4;}},$23:function($p0,$p1){var $0=$p0;var $1=$0.get_$14();if(!$1){this.get_$1().$B(new MSP._P$16(this.get_$1()));}else{this.get_$1().$B(new MSP._P$12(this.get_$1()));}this.$1E.$F($1,this.$18.get_$11(),this.$1F,this.$20);this.get_$1().$A(this.$1E);if(!$1){while(MSCo.CollectionHelper.queueLength(this.$1B)>0){this.get_$1().$A(this.$1B.dequeue());}this.get_$1().onSignInEventsEmpty();}}}
MSP._P$12=function(service){MSP._P$12.constructBase(this,[service]);}
MSP._P$12.prototype={$2:function($p0){this.get_$1().$B(new MSP._P$11(this.get_$1()));this.get_$1().$A($p0);}}
MSP._P$13=function(service,signOutCommand){MSP._P$13.constructBase(this,[service]);this.$18=signOutCommand;}
MSP._P$13.prototype={$18:null,$10:function($p0){this.get_$1().$B(new MSP._P$12(this.get_$1()));this.$18.$5();}}
MSP.MsnpHelper=function(){}
MSP.MsnpHelper.parseStatus=function(status){switch(status){case'NLN':return 2;case'HDN':return 3;case'BSY':return 4;case'IDL':return 5;case'FLN':return 1;case'BRB':return 6;case'AWY':return 7;case'PHN':return 8;case'LUN':return 9;default:return 0;}}
MSP.MsnpHelper.formatStatus=function(status){switch(status){case 2:return'NLN';case 3:return'HDN';case 4:return'BSY';case 5:return'IDL';case 1:return'FLN';case 6:return'BRB';case 7:return'AWY';case 8:return'PHN';case 9:return'LUN';case 0:default:return'';}}
MSP.MsnpHelper.parseIMAddressInfoType=function(type){return MSP._P$6.$D(type);}
MSP.MsnpHelper.parseCapabilities=function(capabilities){if(String.isNullOrEmpty(capabilities)){return[0];}var $0=MSCo.StringHelper.splitChar(capabilities,':');var $1=new Array($0.length);for(var $2=0;$2<$1.length;$2++){var $3=MSP._P$6.$C($0[$2]);if($3===-1){$1[$2]=0;}else{$1[$2]=$3;}}return $1;}
MSP.MsnpHelper.formatCapabilities=function(capabilities){if(!capabilities.length){return'0';}var $0=new Array(capabilities.length);for(var $1=0;$1<$0.length;$1++){$0[$1]=MSP.MsnpHelper.$0(capabilities[$1]);}return MSCo.StringHelper.joinSeparator(':',$0);}
MSP.MsnpHelper.$0=function($p0){var $0=$p0;if($0<0){$0+=4294967296;}return $0.toString();}
MSP.MsnpHelper.parseRoleLists=function(roleLists){return MSP._P$6.$D(roleLists);}
MSP.MsnpHelper.formatGlobalData=function(presence){var $0=new StringBuilder();MSP.MsnpHelper.$3($0,'Data');if(!MSCo.StringHelper.isNull(presence.personalMessage)){MSP.MsnpHelper.$3($0,'PSM');$0.append(MSCo.XmlHelper.xmlEscape(presence.personalMessage));MSP.MsnpHelper.$5($0,'PSM');}MSP.MsnpHelper.$1($0,presence.properties);MSP.MsnpHelper.$5($0,'Data');return $0.toString();}
MSP.MsnpHelper.formatPrivateEndpointData=function(endpointPresence){var $0=new StringBuilder();MSP.MsnpHelper.$3($0,'PrivateEndpointData');if(!MSCo.StringHelper.isNull(endpointPresence.endpointName)){MSP.MsnpHelper.$3($0,'EpName');$0.append(MSCo.XmlHelper.xmlEscape(endpointPresence.endpointName));MSP.MsnpHelper.$5($0,'EpName');MSP.MsnpHelper.$3($0,'ClientType');$0.append('2');MSP.MsnpHelper.$5($0,'ClientType');}MSP.MsnpHelper.$5($0,'PrivateEndpointData');return $0.toString();}
MSP.MsnpHelper.formatEndpointData=function(presence){var $0=new StringBuilder();MSP.MsnpHelper.$3($0,'EndpointData');if(presence.capabilities&&presence.capabilities.length>0){MSP.MsnpHelper.$3($0,'Capabilities');$0.append(MSP.MsnpHelper.formatCapabilities(presence.capabilities));MSP.MsnpHelper.$5($0,'Capabilities');}MSP.MsnpHelper.$1($0,presence.properties);MSP.MsnpHelper.$2($0,presence.domain,presence.applicationMessageIds,presence.webProperties);MSP.MsnpHelper.$5($0,'EndpointData');return $0.toString();}
MSP.MsnpHelper.$1=function($p0,$p1){if($p1){for(var $0=0;$0<$p1.length;$0++){var $1=MSCo.XmlHelper.xmlEscape($p1[$0].key);var $2=MSCo.XmlHelper.xmlEscape($p1[$0].value);MSP.MsnpHelper.$3($p0,$1);$p0.append($2);MSP.MsnpHelper.$5($p0,$1);}}}
MSP.MsnpHelper.$2=function($p0,$p1,$p2,$p3){if($p2||$p3){MSP.MsnpHelper.$4($p0,'WebAppData',[MC.$create_KeyValuePair('domain',$p1)]);if($p2){MSP.MsnpHelper.$3($p0,'MsgIds');for(var $0=0;$0<$p2.length;$0++){MSP.MsnpHelper.$3($p0,'Id');$p0.append(MSCo.XmlHelper.xmlEscape($p2[$0]));MSP.MsnpHelper.$5($p0,'Id');}MSP.MsnpHelper.$5($p0,'MsgIds');}if($p3){MSP.MsnpHelper.$3($p0,'Properties');for(var $1=0;$1<$p3.length;$1++){MSP.MsnpHelper.$3($p0,$p3[$1].key);$p0.append(MSCo.XmlHelper.xmlEscape($p3[$1].value));MSP.MsnpHelper.$5($p0,$p3[$1].key);}MSP.MsnpHelper.$5($p0,'Properties');}MSP.MsnpHelper.$5($p0,'WebAppData');}}
MSP.MsnpHelper.$3=function($p0,$p1){$p0.append('<');$p0.append($p1);$p0.append('>');}
MSP.MsnpHelper.$4=function($p0,$p1,$p2){$p0.append('<');$p0.append($p1);if($p2&&$p2.length>0){$p0.append(' ');for(var $0=0;$0<$p2.length;$0++){$p0.append($p2[$0].key);$p0.append('=\"');$p0.append($p2[$0].value);$p0.append('\"');}}$p0.append('>');}
MSP.MsnpHelper.$5=function($p0,$p1){$p0.append('</');$p0.append($p1);$p0.append('>');}
MSP.ConnectionService.createClass('MSP.ConnectionService',null,MC.IConnectionService,MC.IConnectionServiceEvents);MSP._P$A.createClass('MSP._P$A');MSP._P$14.createClass('MSP._P$14',MSP._P$A);MSP._P$B.createClass('MSP._P$B',MSP._P$A);MSP._P$C.createClass('MSP._P$C',MSP._P$A);MSP._P$D.createClass('MSP._P$D',MSP._P$A);MSP._P$10.createClass('MSP._P$10',MSP._P$A);MSP._P$F.createClass('MSP._P$F',MSP._P$A);MSP._P$E.createClass('MSP._P$E',MSP._P$A);MSP._P$17.createClass('MSP._P$17',MSP._P$A);MSP._P$21.createClass('MSP._P$21',MSP._P$A);MSP._P$1F.createClass('MSP._P$1F',MSP._P$A);MSP._P$22.createClass('MSP._P$22',MSP._P$A);MSP._P$25.createClass('MSP._P$25',MSP._P$A);MSP._P$19.createClass('MSP._P$19',MSP._P$A);MSP._P$18.createClass('MSP._P$18',MSP._P$A);MSP._P$1C.createClass('MSP._P$1C',MSP._P$A);MSP._P$1D.createClass('MSP._P$1D',MSP._P$A);MSP._P$1E.createClass('MSP._P$1E',MSP._P$A);MSP._P$1B.createClass('MSP._P$1B',MSP._P$A);MSP._P$15.createClass('MSP._P$15',MSP._P$A);MSP._P$1A.createClass('MSP._P$1A',MSP._P$A);MSP._P$23.createClass('MSP._P$23',MSP._P$A);MSP._P$24.createClass('MSP._P$24',MSP._P$A);MSP._P$6.createClass('MSP._P$6');MSP._P$5.createClass('MSP._P$5');MSP._P$20.createClass('MSP._P$20',MSM.MsnpConnection);MSP.ContactListReader.createClass('MSP.ContactListReader');MSP.ContactListWriter.createClass('MSP.ContactListWriter');MSP.MailNotificationParser.createClass('MSP.MailNotificationParser');MSP._P$9.createClass('MSP._P$9');MSP._P$8.createClass('MSP._P$8');MSP.PremiumFeatureParser.createClass('MSP.PremiumFeatureParser');MSP.PresenceParser.createClass('MSP.PresenceParser');MSP._P$7.createClass('MSP._P$7');MSP._P$16.createClass('MSP._P$16',MSP._P$7);MSP._P$11.createClass('MSP._P$11',MSP._P$7);MSP._P$12.createClass('MSP._P$12',MSP._P$7);MSP._P$13.createClass('MSP._P$13',MSP._P$7);MSP.MsnpHelper.createClass('MSP.MsnpHelper');MSP._P$24.$9=2|4|1;MSP._P$6.$12='&amp;|&lt;|&gt;|&apos;|&quot;|&#[0-9]{1,5};|&#x[0-9a-f]{1,5};|&';MSP._P$6.$14=new RegExp('&amp;|&lt;|&gt;|&apos;|&quot;|&#[0-9]{1,5};|&#x[0-9a-f]{1,5};|&','ig');MSP._P$20.$1_0=['MSNP17','MSNP16'];MSP.ContactListWriter.$8=8000-200;MSP._P$9.$10=[128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];Type.createNamespace('MSCr');MSCr._O$1=function(){};MSCr._O$1.prototype={$0:0,$1:1,$2:2,$3:3,$4:4,$5:5}
MSCr._O$1.createEnum('MSCr._O$1',false);MSCr._O$0=function(){};MSCr._O$0.prototype={$0:0,$1:1,$2:2,$3:4,$4:7,$5:8,$6:16,$7:32,$8:64}
MSCr._O$0.createEnum('MSCr._O$0',true);MSCr._O$4=function(){};MSCr._O$4.prototype={$0:0,$1:1}
MSCr._O$4.createEnum('MSCr._O$4',false);MSCr._O$3=function(){};MSCr._O$3.prototype={$0:0,$1:1,$2:2}
MSCr._O$3.createEnum('MSCr._O$3',false);MSCr._O$2=function(){};MSCr._O$2.prototype={$0:0,$1:1,$2:2,$3:3}
MSCr._O$2.createEnum('MSCr._O$2',false);MSCr.MessengerService=function(identity,factory,events){this.$7=new MSCr._O$13(this);this.$6=factory.createConfigurationService();this.$0=factory.createConnectionService(identity,this);this.$2=factory.createExpressionProfile(identity);this.$1=factory.createAddressBook(identity);this.$3=factory.createIdentityService();this.$5=factory.createConversationService(identity,this,events);this.$4=events;this.$1.add_changed(Delegate.create(this,this.$A));this.$1.add_authenticationFailed(Delegate.create(this,this.$C));this.$2.add_authenticationFailed(Delegate.create(this,this.$C));this.$6.add_changed(Delegate.create(this,this.$B));}
MSCr.MessengerService.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,addAddress:function(address,inviteMessage,userState){this.$7.$2(new MSCr._O$19(address,inviteMessage,this.$0,this.$1,this.$4,userState));},updateContactNickname:function(contact,userState){this.$7.$6(new MSCr._O$9(contact,this.$1,this.$4,userState));},updateContact:function(contact,addedLists,removedLists,userState){this.$7.$5(new MSCr._O$8(contact,addedLists,removedLists,this.$0,this.$1,this.$4,userState));},addAddressToContact:function(address,contact,userState){this.$7.$3(new MSCr._O$18(contact,address,this.$0,this.$1,this.$4,userState));},removeAddressFromContact:function(address,contact,userState){this.$7.$4(new MSCr._O$24(contact,address,this.$0,this.$1,this.$4,userState));},addGroup:function(group,userState){this.$7.$D(new MSCr._O$C(0,group,this.$1,this.$4,userState));},renameGroup:function(group,userState){this.$7.$D(new MSCr._O$C(2,group,this.$1,this.$4,userState));},removeGroup:function(group,userState){this.$7.$D(new MSCr._O$C(1,group,this.$1,this.$4,userState));},addContactToGroup:function(contact,group,userState){this.$7.$E(new MSCr._O$7(0,group,contact,this.$1,this.$4,userState));},removeContactFromGroup:function(contact,group,userState){this.$7.$E(new MSCr._O$7(1,group,contact,this.$1,this.$4,userState));},conversationCreate:function(id,address){this.$5.conversationCreate(id,address);},conversationSendMessage:function(id,message,userState){this.$5.conversationSendMessage(id,message,userState);},conversationInviteAddress:function(id,address,userState){this.$5.conversationInviteAddress(id,address,userState);},conversationExpose:function(id,roster){this.$4.onConversationCreated(id,roster);},conversationUpdateId:function(oldId,newId){this.$4.onConversationUpdatedId(oldId,newId);},conversationClose:function(id){this.$5.conversationClose(id);},signIn:function(presence,endpointPresence,userState){endpointPresence.domain=MSCo.Configuration.get_domainName();this.$7.$B(new MSCr._O$20(presence,endpointPresence,this.$0,this.$1,this.$2,this.$4,userState));this.$7.$A(new MSCr._O$1A(this.$6));},signOut:function(locations,endpointIds,userState){this.$7.$C(new MSCr._O$1F(locations,endpointIds,this.$0,this.$5,this.$4,userState));},updateSettings:function(settings,userState){this.$7.$F(new MSCr._O$12(settings,this.$1,this.$0,this.$4,userState));},updatePresence:function(presence,endpointPresence,userState){endpointPresence.domain=MSCo.Configuration.get_domainName();this.$7.$10(new MSCr._O$11(true,presence,endpointPresence,this.$2,this.$0,this.$4,userState));},refreshPresence:function(presence,endpointPresence,userState){endpointPresence.domain=MSCo.Configuration.get_domainName();this.$7.$10(new MSCr._O$11(false,presence,endpointPresence,this.$2,this.$0,this.$4,userState));},sendPage:function(address,messageType,messagePayload,callback,userState){this.$7.$11(new MSCr._O$23(address,messageType,messagePayload,this.$0,callback,userState));},$8:function($p0){$p0.$5();},$9:function($p0){this.$7=$p0;},$A:function($p0,$p1){this.$7.$8(new MSCr._O$14(this.$0));},$B:function($p0,$p1){this.$7.$18(new MSCr._O$1B(this.$6.get_current(),this.$2,this.$1,this.$0,this.$3,this.$4));},$C:function($p0,$p1){this.$7.$9(new MSCr._O$22($p1.get_authenticatedCommand(),this.$3));},requestMixerSession:function(callback){this.$7.$12(new MSCr._O$21(this.$0,callback));},resumeSignedInSession:function(config,sessionInfo,events){this.$3.updateConfiguration(config.identity);this.$1.updateConfiguration(config.addressBook);this.$2.updateConfiguration(config.expressionProfile);this.$0.updateConfiguration(config.presence);this.$0.resumeSession(sessionInfo,events);this.$9(new MSCr._O$10(this));},onPresenceLost:function(){this.$7.$13(new MSCr._O$1C(this.$4));},onIncomingChatRequest:function(inviter,hostName,sessionId,sessionCookie){this.$5.onMixerIncomingRequest(inviter,hostName,sessionId,sessionCookie);},onPresenceChanged:function(address,presence,endpointPresence){if(endpointPresence&&endpointPresence.length>0){for(var $0=0;$0<endpointPresence.length;$0++){if(endpointPresence[$0].domain!==MSCo.Configuration.get_domainName()){endpointPresence[$0].applicationMessageIds=null;endpointPresence[$0].webProperties=null;}}}this.$7.$14(new MSCr._O$16(address,presence,endpointPresence,this.$4));},onSettingsChanged:function(settings){this.$7.$15(new MSCr._O$1E(settings,this.$4));},onMailNotificationReceived:function(mailNotification){this.$7.$1A(new MSCr._O$15(mailNotification,this.$4));},onSubscribeNotificationReceived:function(address){this.$7.$7(new MSCr._O$B(address,this.$1,this.$4,null));},onNotificationReceived:function(sender,senderEndpointId,notification){},onPageReceived:function(message,senderAddress,receiverAddress){this.$7.$17(new MSCr._O$17(this.$5,message,senderAddress,receiverAddress));},onDisconnected:function(resultCode){this.$7.$16(new MSCr._O$1D(this.$5,this.$4));},onTransferred:function(hostName,otherEndpointRequested){this.$7.$19(new MSCr._O$A(hostName,otherEndpointRequested));},onPolicyReceived:function(policyName,content){switch(policyName){case'shields':this.$5.onPolicyReceived(content);break;case'abch':break;}},onSignInEventsEmpty:function(){}}
MSCr._O$6=function(){}
MSCr._O$6.prototype={$0:null,$1:false,$2:false,$3:false,get_$4:function(){return this.$2;},$5:function(){this.$0=Date.get_now();this.$1=true;this.$6();},$7:function(){if(!this.$3){this.$3=true;this.$A();}},$8:function(){if(!this.$3){this.$3=true;this.$A();}},$9:function(){if(!this.$3){this.$3=true;this.$2=true;if(this.$C){this.$C.invoke(this,EventArgs.Empty);}this.$A();}},add_$B:function($p0){this.$C=Delegate.combine(this.$C,$p0);},remove_$B:function($p0){this.$C=Delegate.remove(this.$C,$p0);},$C:null}
MSCr._O$19=function(address,inviteMessage,connService,addressBook,events,userState){MSCr._O$19.constructBase(this);this.$D=address;this.$E=inviteMessage;this.$F=connService;this.$10=addressBook;this.$11=events;this.$12=userState;}
MSCr._O$19.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:0,$14:0,$15:null,$16:null,$6:function(){this.$17();},$A:function(){this.$11.onAddressAdded(this.$13,this.$16,this.$12);},$17:function(){switch(this.$14){case 0:var $0=MC.$create_IMAddressInfo(this.$D,0,2);$0.inviteMessage=this.$E;var $1=MC.$create_ContactInfo($0.address,null,[$0]);this.$10.createContact($1,Delegate.create(this,this.$18));break;case 1:this.$10.retrieveContact(this.$15,Delegate.create(this,this.$19));break;case 2:this.$F.updateAddresses(this.$16.addresses,2|1,0,Delegate.create(this,this.$1A));break;case 3:this.$9();break;case 5:this.$8();break;}},$18:function($p0,$p1){switch($p0){case 0:this.$14=1;break;case 2:this.$14=5;this.$13=2;break;case 1:default:this.$14=5;this.$13=1;break;}this.$15=$p1;this.$17();},$19:function($p0,$p1){switch($p0){case 0:this.$14=2;break;case 1:default:this.$14=5;this.$13=1;break;}this.$16=$p1;this.$17();},$1A:function($p0){if(!$p0){this.$14=3;this.$13=0;}else{this.$14=5;this.$13=1;}this.$17();}}
MSCr._O$18=function(contact,address,connService,addressBook,events,userState){MSCr._O$18.constructBase(this);this.$D=contact;this.$E=address;this.$F=connService;this.$10=addressBook;this.$11=events;this.$12=userState;}
MSCr._O$18.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:0,$14:null,$6:function(){this.$15();},$A:function(){this.$11.onContactUpdated((this.get_$4())?0:1,this.$14,this.$12);},$15:function(){switch(this.$13){case 0:this.$10.createIMAddress(this.$D,this.$E,Delegate.create(this,this.$16));break;case 1:this.$10.retrieveContact(this.$D.id,Delegate.create(this,this.$17));break;case 2:this.$9();break;case 3:this.$8();break;case 5:this.$8();break;}},$16:function($p0,$p1){this.$13=(!$p0)?1:5;this.$15();},$17:function($p0,$p1){this.$13=(!$p0)?2:5;this.$14=$p1;this.$15();}}
MSCr._O$1B=function(configuration,expProfile,addressBook,connService,idService,events){MSCr._O$1B.constructBase(this);this.$D=configuration;this.$E=expProfile;this.$F=addressBook;this.$10=connService;this.$11=idService;this.$12=events;}
MSCr._O$1B.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$6:function(){this.$9();},$A:function(){this.$E.updateConfiguration(this.$D.expressionProfile);this.$F.updateConfiguration(this.$D.addressBook);this.$10.updateConfiguration(this.$D.presence);this.$11.updateConfiguration(this.$D.identity);this.$12.onConfigurationChanged(this.$D);}}
MSCr._O$1A=function(service){MSCr._O$1A.constructBase(this);this.$D=service;}
MSCr._O$1A.prototype={$D:null,$6:function(){this.$9();},$A:function(){this.$D.loadConfiguration();}}
MSCr._O$15=function(notification,events){MSCr._O$15.constructBase(this);this.$E=events;this.$D=notification;}
MSCr._O$15.prototype={$D:null,$E:null,$6:function(){this.$E.onMailNotification(this.$D);},$A:function(){}}
MSCr._O$14=function(connService){MSCr._O$14.constructBase(this);this.$D=connService;}
MSCr._O$14.prototype={$D:null,$6:function(){this.$D.notifyAddressBookChanged();},$A:function(){}}
MSCr._O$17=function(convService,message,senderAddress,receiverAddress){MSCr._O$17.constructBase(this);this.$D=convService;this.$E=message;this.$F=senderAddress;this.$10=receiverAddress;}
MSCr._O$17.prototype={$D:null,$E:null,$F:null,$10:null,$6:function(){this.$D.onPageReceived(this.$E,this.$F,this.$10);},$A:function(){}}
MSCr._O$16=function(address,presence,endpointPresence,events){MSCr._O$16.constructBase(this);this.$D=address;this.$E=presence;this.$F=endpointPresence;this.$10=events;}
MSCr._O$16.prototype={$D:null,$E:null,$F:null,$10:null,$6:function(){this.$9();},$A:function(){this.$10.onPresenceChanged(this.$D,this.$E,this.$F);}}
MSCr._O$1C=function(events){MSCr._O$1C.constructBase(this);this.$D=events;}
MSCr._O$1C.prototype={$D:null,$6:function(){this.$9();},$A:function(){this.$D.onUserPresenceLost();}}
MSCr._O$22=function(pendingCommand,idService){MSCr._O$22.constructBase(this);this.$D=pendingCommand;this.$E=idService;}
MSCr._O$22.prototype={$D:null,$E:null,$F:0,get_$10:function(){return this.$D;},get_$11:function(){return this.$F;},$6:function(){this.$E.reauthenticate(Delegate.create(this,this.$12));},$A:function(){if(this.$F){this.$D.fail();}else{this.$D.retry();}},$12:function($p0){this.$F=$p0;if(this.$F){this.$8();}else{this.$9();}}}
MSCr._O$21=function(connService,onResponse){MSCr._O$21.constructBase(this);this.$D=connService;this.$E=onResponse;}
MSCr._O$21.prototype={$D:null,$E:null,$6:function(){this.$D.requestMixerSession(Delegate.create(this,this.$F));},$A:function(){},$F:function($p0,$p1){this.$E.invoke($p0,$p1);}}
MSCr._O$24=function(contact,address,connService,addressBook,events,userState){MSCr._O$24.constructBase(this);this.$D=contact;this.$E=address;this.$F=connService;this.$10=addressBook;this.$11=events;this.$12=userState;}
MSCr._O$24.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:0,$14:null,$6:function(){this.$15();},$A:function(){this.$11.onContactUpdated((this.get_$4())?0:1,this.$14,this.$12);},$15:function(){switch(this.$13){case 0:this.$10.deleteIMAddress(this.$D,this.$E,Delegate.create(this,this.$16));break;case 1:this.$10.retrieveContact(this.$D.id,Delegate.create(this,this.$17));break;case 2:this.$9();break;case 3:this.$8();break;case 5:this.$8();break;}},$16:function($p0){this.$13=(!$p0)?1:5;this.$15();},$17:function($p0,$p1){this.$13=(!$p0)?2:5;this.$14=$p1;this.$15();}}
MSCr._O$23=function(address,messageType,messagePayload,connService,callback,userState){MSCr._O$23.constructBase(this);this.$D=address;this.$E=messageType;this.$F=messagePayload;this.$10=connService;this.$11=callback;this.$12=userState;}
MSCr._O$23.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$6:function(){this.$10.sendPage(this.$D,this.$E,this.$F,Delegate.create(this,this.$13));},$A:function(){},$13:function($p0){this.$11.invoke($p0);}}
MSCr._O$1E=function(settings,events){MSCr._O$1E.constructBase(this);this.$D=settings;this.$E=events;}
MSCr._O$1E.prototype={$D:null,$E:null,$6:function(){this.$9();},$A:function(){this.$E.onSettingsChanged(this.$D);}}
MSCr._O$1D=function(convService,events){MSCr._O$1D.constructBase(this);this.$D=convService;this.$E=events;}
MSCr._O$1D.prototype={$D:null,$E:null,$6:function(){this.$D.close();this.$9();},$A:function(){this.$E.onSignedOutRemotely();}}
MSCr._O$20=function(presence,endpointPresence,connService,addressBook,expProfile,callback,userState){MSCr._O$20.constructBase(this);this.$14=MC.$create_PresenceInfo(presence.status,presence.displayName,presence.personalMessage,presence.networkIconUrl,presence.capabilities.clone(),presence.properties.clone());this.$14.displayPictureKey=presence.displayPictureKey;this.$15=endpointPresence;this.$D=connService;this.$E=addressBook;this.$F=expProfile;this.$10=callback;this.$11=userState;this.$12=MSCo.Configuration.get_clientID();}
MSCr._O$20.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:null,$13:0,$14:null,$15:null,$16:null,$17:null,$18:null,$19:function($p0){this.$D.authenticate(this.$12,$p0,Delegate.create(this,this.$1B));},$1A:function(){this.$13|=32;this.$20();},$6:function(){this.$20();},$A:function(){if(this.$10){var $0=(this.get_$4())?0:1;this.$10.onSignedIn($0,this.$17,this.$16,this.$11);}},$1B:function($p0){this.$13|=1;if($p0){this.$13|=32;}this.$20();},$1C:function($p0,$p1,$p2){this.$13|=2;this.$17=$p1;this.$16=$p2;var $0={};var $enum1=this.$17.getEnumerator();while($enum1.moveNext()){var $2=$enum1.get_current();if(!$2.contacts){continue;}var $enum2=$2.contacts.getEnumerator();while($enum2.moveNext()){var $3=$enum2.get_current();if(!$3.addresses){continue;}var $enum3=$3.addresses.getEnumerator();while($enum3.moveNext()){var $4=$enum3.get_current();if(Object.keyExists($0,$4.id)){continue;}$0[$4.id]=$4;}}}var $1=[];var $dict4=$0;for(var $key5 in $dict4){var $5={key:$key5,value:$dict4[$key5]};$1.add($5.value);}this.$18=$1;if($p0){this.$13|=32;}this.$20();},$1D:function($p0){this.$13|=4;if($p0){this.$13|=64;}this.$20();},$1E:function($p0){this.$13|=8;if($p0){this.$13|=32;}this.$20();},$1F:function($p0,$p1){this.$13|=16;this.$13|=32;this.$20();},$20:function(){if(!this.$13){this.$D.authenticate(this.$12,null,Delegate.create(this,this.$1B));this.$E.synchronize(Delegate.create(this,this.$1C));this.$F.synchronize(this.$14,Delegate.create(this,this.$1D));return;}if((this.$13&16)){this.$7();return;}if((this.$13&32)){this.$8();return;}if((this.$13&8)){this.$9();return;}if((this.$13&7)===7){this.$D.signIn(this.$18,this.$14,this.$15,this.$16,Delegate.create(this,this.$1E));return;}}}
MSCr._O$1F=function(locations,endpointIds,connService,convService,callback,userState){MSCr._O$1F.constructBase(this);this.$D=locations;this.$E=endpointIds;this.$F=connService;this.$10=convService;this.$11=callback;this.$12=userState;}
MSCr._O$1F.prototype={$D:0,$E:null,$F:null,$10:null,$11:null,$12:null,$13:0,get_$14:function(){return((this.$D&1));},$6:function(){this.$F.signOut(this.$D,this.$E,false,Delegate.create(this,this.$15));if(this.get_$14()){this.$10.close();}},$A:function(){this.$11.onSignedOut(this.$13,this.$D,this.$12);},$15:function($p0){if(!$p0){this.$13=0;this.$9();}else{this.$13=1;this.$8();}}}
MSCr._O$B=function(address,addressBook,events,userState){MSCr._O$B.constructBase(this);this.$D=address;this.$E=addressBook;this.$F=events;this.$10=userState;}
MSCr._O$B.prototype={$D:null,$E:null,$F:null,$10:null,$11:0,$12:null,$13:null,$6:function(){this.$14();},$A:function(){if(this.get_$4()){this.$F.onPendingContact(this.$13);}},$14:function(){switch(this.$11){case 0:this.$E.retrieveUnknownContact(Delegate.create(this,this.$15));break;case 1:this.$16();break;case 2:break;case 3:this.$9();break;case 5:this.$8();break;}},$15:function($p0,$p1){this.$11=(!$p0)?1:5;this.$12=$p1;this.$14();},$16:function(){var $enum1=this.$12.addresses.getEnumerator();while($enum1.moveNext()){var $0=$enum1.get_current();if($0.address===this.$D.address&&$0.type===this.$D.type){this.$13=MC.$create_ContactInfo(this.$12.id,null,[$0]);break;}}this.$11=(this.$13)?3:5;this.$14();}}
MSCr._O$A=function(hostName,otherEndpointRequest){MSCr._O$A.constructBase(this);this.$D=hostName;}
MSCr._O$A.prototype={$D:null,get_$E:function(){return this.$D;},$6:function(){this.$9();},$A:function(){}}
MSCr._O$8=function(contact,addedLists,removedLists,connService,addressBook,events,userState){MSCr._O$8.constructBase(this);this.$D=contact;this.$E=addedLists;this.$F=removedLists;this.$10=connService;this.$11=addressBook;this.$12=events;this.$13=userState;}
MSCr._O$8.prototype={$D:null,$E:0,$F:0,$10:null,$11:null,$12:null,$13:null,$14:0,$15:null,$6:function(){this.$16();},$A:function(){this.$12.onContactUpdated((this.get_$4())?0:1,this.$15,this.$13);},$16:function(){switch(this.$14){case 0:if((this.$E&1)){this.$11.createContact(this.$D,Delegate.create(this,this.$18));}else if((this.$F&1)){this.$11.deleteContact(this.$D,Delegate.create(this,this.$19));}else{this.$11.updateContact(this.$D,this.$E,Delegate.create(this,this.$17));}break;case 1:this.$11.retrieveContact(this.$D.id,Delegate.create(this,this.$1A));break;case 2:this.$10.updateAddresses(this.$D.addresses,this.$E,this.$F,Delegate.create(this,this.$1B));break;case 3:this.$9();break;case 5:this.$8();break;}},$17:function($p0){this.$14=(!$p0)?1:5;this.$16();},$18:function($p0,$p1){if(!$p0){this.$14=1;this.$D.id=$p1;}else{this.$14=5;}this.$16();},$19:function($p0){this.$14=(!$p0)?2:5;this.$16();},$1A:function($p0,$p1){this.$14=(!$p0)?2:5;this.$15=$p1;this.$16();},$1B:function($p0){this.$14=(!$p0)?3:5;this.$16();}}
MSCr._O$9=function(contact,addressBook,events,userState){MSCr._O$9.constructBase(this);this.$D=contact;this.$E=addressBook;this.$F=events;this.$10=userState;}
MSCr._O$9.prototype={$D:null,$E:null,$F:null,$10:null,$11:0,$6:function(){this.$12();},$12:function(){switch(this.$11){case 0:this.$E.updateContactNickname(this.$D,Delegate.create(this,this.$13));break;case 1:this.$9();break;case 5:this.$8();break;}},$13:function($p0){this.$11=(!$p0)?1:5;this.$12();},$A:function(){this.$F.onContactUpdated((this.get_$4())?0:1,this.$D,this.$10);}}
MSCr._O$7=function(type,group,contact,addressBook,events,userState){MSCr._O$7.constructBase(this);this.$D=type;this.$F=group;this.$E=contact;this.$10=addressBook;this.$11=events;this.$12=userState;}
MSCr._O$7.prototype={$D:0,$E:null,$F:null,$10:null,$11:null,$12:null,$6:function(){this.$13();},$A:function(){},$13:function(){switch(this.$D){case 0:this.$10.createContactID(this.$F,this.$E,Delegate.create(this,this.$14));break;case 1:this.$10.deleteContactID(this.$F,this.$E,Delegate.create(this,this.$15));break;default:break;}},$14:function($p0,$p1){this.$9();},$15:function($p0){this.$9();}}
MSCr._O$C=function(type,group,addressBook,events,userState){MSCr._O$C.constructBase(this);this.$D=type;this.$E=group;this.$F=addressBook;this.$10=events;this.$11=userState;}
MSCr._O$C.prototype={$D:0,$E:null,$F:null,$10:null,$11:null,$12:null,$6:function(){switch(this.$D){case 0:this.$F.createTag(this.$E,Delegate.create(this,this.$13));break;case 1:this.$F.deleteTag(this.$E,Delegate.create(this,this.$14));break;case 2:this.$F.updateTag(this.$E,Delegate.create(this,this.$14));break;default:break;}},$A:function(){switch(this.$D){case 0:this.$10.onGroupAdded((this.get_$4())?0:1,this.$12,this.$11);break;case 1:this.$10.onGroupRemoved((this.get_$4())?0:1,this.$12,this.$11);break;case 2:this.$10.onGroupRenamed((this.get_$4())?0:1,this.$12,this.$11);break;default:break;}},$13:function($p0,$p1){if(!$p0){this.$12=MC.$create_GroupInfo($p1,this.$E.name,this.$E.contacts);this.$9();}else{this.$8();}},$14:function($p0){if(!$p0){this.$12=this.$E;this.$9();}else{this.$8();}}}
MSCr._O$11=function(persist,presence,endpointPresence,expProfile,connService,events,userState){MSCr._O$11.constructBase(this);this.$D=persist;this.$E=presence;this.$F=endpointPresence;this.$10=expProfile;this.$11=connService;this.$12=events;this.$13=userState;}
MSCr._O$11.prototype={$D:false,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:false,$15:0,$6:function(){this.$11.publishPresence(this.$E,this.$F,Delegate.create(this,this.$16));if(this.$D){this.$10.update(this.$E,Delegate.create(this,this.$17));}},$A:function(){this.$12.onUserPresenceUpdated(this.$15,this.$13);},$16:function($p0){if(!this.$14){this.$14=true;if($p0){this.$15=1;this.$8();}else{this.$15=0;this.$9();}}},$17:function($p0){if(!this.$14){this.$14=true;if($p0){this.$15=1;this.$8();}else{this.$15=0;this.$9();}}}}
MSCr._O$12=function(settings,addressBook,connService,events,userState){MSCr._O$12.constructBase(this);this.$D=settings;this.$F=addressBook;this.$E=connService;this.$10=events;this.$11=userState;}
MSCr._O$12.prototype={$D:null,$E:null,$F:null,$10:null,$11:null,$12:0,$13:0,$6:function(){this.$14();},$14:function(){switch(this.$13){case 0:this.$F.updateSettings(this.$D,Delegate.create(this,this.$16));break;case 2:this.$E.publishSettings(this.$D,Delegate.create(this,this.$15));break;case 1:this.$9();break;case 3:this.$8();break;}},$A:function(){this.$10.onUserSettingsUpdated(this.$12,this.$11);},$15:function($p0){if($p0){this.$12=1;this.$13=3;}else{this.$12=0;this.$13=1;}this.$14();},$16:function($p0){if($p0){this.$12=1;this.$13=3;}else{this.$12=0;this.$13=2;}this.$14();}}
MSCr._O$5=function(service){this.$0=service;}
MSCr._O$5.prototype={$0:null,get_$1:function(){return this.$0;},$2:function($p0){this.$1B($p0);},$3:function($p0){this.$1B($p0);},$4:function($p0){this.$1B($p0);},$5:function($p0){this.$1B($p0);},$6:function($p0){this.$1B($p0);},$7:function($p0){this.$1B($p0);},$8:function($p0){this.$1B($p0);},$9:function($p0){this.$1B($p0);},$A:function($p0){this.$1B($p0);},$B:function($p0){this.$1B($p0);},$C:function($p0){this.$1B($p0);},$D:function($p0){this.$1B($p0);},$E:function($p0){this.$1B($p0);},$F:function($p0){this.$1B($p0);},$10:function($p0){this.$1B($p0);},$11:function($p0){this.$1B($p0);},$12:function($p0){this.$1B($p0);},$13:function($p0){this.$1B($p0);},$14:function($p0){this.$1B($p0);},$15:function($p0){this.$1B($p0);},$16:function($p0){this.$1B($p0);},$17:function($p0){this.$1B($p0);},$18:function($p0){this.$1B($p0);},$19:function($p0){this.$1B($p0);},$1A:function($p0){this.$1B($p0);},$1B:function($p0){}}
MSCr._O$13=function(service){MSCr._O$13.constructBase(this,[service]);}
MSCr._O$13.prototype={$1C:null,$B:function($p0){this.$1C=$p0;},$A:function($p0){this.get_$1().$8($p0);},$18:function($p0){var $0=new MSCr._O$D(this.get_$1());this.get_$1().$8($p0);this.get_$1().$9($0);if(this.$1C){$0.$B(this.$1C);}}}
MSCr._O$10=function(service){MSCr._O$10.constructBase(this,[service]);}
MSCr._O$10.prototype={$2:function($p0){this.get_$1().$8($p0);},$8:function($p0){this.get_$1().$8($p0);},$C:function($p0){if($p0.get_$14()){this.get_$1().$9(new MSCr._O$F(this.get_$1(),$p0));}this.get_$1().$8($p0);},$9:function($p0){this.get_$1().$8($p0);},$D:function($p0){this.get_$1().$8($p0);},$E:function($p0){this.get_$1().$8($p0);},$F:function($p0){this.get_$1().$8($p0);},$10:function($p0){this.get_$1().$8($p0);},$12:function($p0){this.get_$1().$8($p0);},$13:function($p0){this.get_$1().$8($p0);},$17:function($p0){this.get_$1().$8($p0);},$1A:function($p0){this.get_$1().$8($p0);},$14:function($p0){this.get_$1().$8($p0);},$15:function($p0){this.get_$1().$8($p0);},$16:function($p0){this.get_$1().$9(new MSCr._O$D(this.get_$1()));this.get_$1().$8($p0);},$11:function($p0){this.get_$1().$8($p0);},$5:function($p0){this.get_$1().$8($p0);},$6:function($p0){this.get_$1().$8($p0);},$3:function($p0){this.get_$1().$8($p0);},$4:function($p0){this.get_$1().$8($p0);},$7:function($p0){this.get_$1().$8($p0);}}
MSCr._O$D=function(service){MSCr._O$D.constructBase(this,[service]);}
MSCr._O$D.prototype={$B:function($p0){this.get_$1().$9(new MSCr._O$E(this.get_$1(),$p0));this.get_$1().$8($p0);}}
MSCr._O$E=function(service,command){MSCr._O$E.constructBase(this,[service]);this.$1C=command;this.$1C.add_$B(Delegate.create(this,this.$1D));}
MSCr._O$E.prototype={$1C:null,$C:function($p0){if($p0.get_$14()){this.get_$1().$9(new MSCr._O$F(this.get_$1(),$p0));}this.get_$1().$8($p0);},$19:function($p0){this.$1C.$19($p0.get_$E());},$16:function($p0){this.$1C.$1A();},$9:function($p0){$p0.get_$10().fail();},$1D:function($p0,$p1){if(this.$1C.get_$4()){this.get_$1().$9(new MSCr._O$10(this.get_$1()));}else{this.get_$1().$9(new MSCr._O$D(this.get_$1()));}}}
MSCr._O$F=function(service,command){MSCr._O$F.constructBase(this,[service]);command.add_$B(Delegate.create(this,this.$1C));}
MSCr._O$F.prototype={$1C:function($p0,$p1){this.get_$1().$9(new MSCr._O$D(this.get_$1()));}}
MSCr.MessengerService.createClass('MSCr.MessengerService',null,MC.IMessengerService,MC.IConnectionServiceEvents);MSCr._O$6.createClass('MSCr._O$6');MSCr._O$19.createClass('MSCr._O$19',MSCr._O$6);MSCr._O$18.createClass('MSCr._O$18',MSCr._O$6);MSCr._O$1B.createClass('MSCr._O$1B',MSCr._O$6);MSCr._O$1A.createClass('MSCr._O$1A',MSCr._O$6);MSCr._O$15.createClass('MSCr._O$15',MSCr._O$6);MSCr._O$14.createClass('MSCr._O$14',MSCr._O$6);MSCr._O$17.createClass('MSCr._O$17',MSCr._O$6);MSCr._O$16.createClass('MSCr._O$16',MSCr._O$6);MSCr._O$1C.createClass('MSCr._O$1C',MSCr._O$6);MSCr._O$22.createClass('MSCr._O$22',MSCr._O$6);MSCr._O$21.createClass('MSCr._O$21',MSCr._O$6);MSCr._O$24.createClass('MSCr._O$24',MSCr._O$6);MSCr._O$23.createClass('MSCr._O$23',MSCr._O$6);MSCr._O$1E.createClass('MSCr._O$1E',MSCr._O$6);MSCr._O$1D.createClass('MSCr._O$1D',MSCr._O$6);MSCr._O$20.createClass('MSCr._O$20',MSCr._O$6);MSCr._O$1F.createClass('MSCr._O$1F',MSCr._O$6);MSCr._O$B.createClass('MSCr._O$B',MSCr._O$6);MSCr._O$A.createClass('MSCr._O$A',MSCr._O$6);MSCr._O$8.createClass('MSCr._O$8',MSCr._O$6);MSCr._O$9.createClass('MSCr._O$9',MSCr._O$6);MSCr._O$7.createClass('MSCr._O$7',MSCr._O$6);MSCr._O$C.createClass('MSCr._O$C',MSCr._O$6);MSCr._O$11.createClass('MSCr._O$11',MSCr._O$6);MSCr._O$12.createClass('MSCr._O$12',MSCr._O$6);MSCr._O$5.createClass('MSCr._O$5');MSCr._O$13.createClass('MSCr._O$13',MSCr._O$5);MSCr._O$10.createClass('MSCr._O$10',MSCr._O$5);MSCr._O$D.createClass('MSCr._O$D',MSCr._O$5);MSCr._O$E.createClass('MSCr._O$E',MSCr._O$5);MSCr._O$F.createClass('MSCr._O$F',MSCr._O$5);