Type.createNamespace("MailIM");var gTrickIntellisense=false;MailIM.SharedInterval=function MailIM_SharedInterval(b,a){this._callback=Delegate.create(this,this.invoke);this._handlers=null;this._window=b;this._frequency=a};MailIM.SharedInterval.prototype={_Interval:0,_window:null,_handlers:null,_frequency:null,dispose:function MailIM_SharedInterval$dispose(){this._callback=Delegate.remove(this._callback,this.invoke);this._window=null},registerCallback:function MailIM_SharedInterval$register(a){this._handlers=Delegate.combine(this._handlers,a);if(this._Interval==0)this._Interval=this._window.setInterval(this._callback,this._frequency)},unregisterCallback:function MailIM_SharedInterval$unregister(a){this._handlers=Delegate.remove(this._handlers,a);if(this._handlers==null){this._window.clearInterval(this._Interval);this._Interval=0}},invoke:function MailIM_SharedInterval$invoke(){this._handlers.invoke(this,null)}};MailIM.SharedInterval.Create=function MailIM_SharedInterval$Create(b,a){return new MailIM.SharedInterval(b,a)};MailIM.WindowFocus=function MailIM_WindowFocus(a){this._window=a;this._focusInHandler=Delegate.create(this,this._onfocusin);this._window.document.attachEvent("onfocusin",this._focusInHandler);if(isIE())this._window.attachEvent("onfocus",this._focusInHandler);this._focusOutHandler=Delegate.create(this,this._onfocusout);this._window.document.attachEvent("onfocusout",this._focusOutHandler);if(isIE())this._window.attachEvent("onblur",this._focusOutHandler);this.HasFocus=true};MailIM.WindowFocus.prototype={_focusInHandler:null,_focusOutHandler:null,_window:null,HasFocus:null,dispose:function MailIM_WindowFocus$dispose(){this._window.document.detachEvent("onfocusin",this._focusInHandler);this._window.document.detachEvent("onfocusout",this._focusOutHandler);this._window=null},_onfocusin:function MailIM_WindowFocus$OnfocusIn(){this.HasFocus=true},_onfocusout:function MailIM_WindowFocus$OnfocusOut(){this.HasFocus=false}};MailIM.WindowFocus.Create=function MailIM_WindowFocus$Create(a){return new MailIM.WindowFocus(a)};function CallFocus(d,a,b){function c(){function c(){a(b)}d.focus();if(a)setTimeout(c,0)}setTimeout(c,0)}var userAgent=window.navigator.userAgent,gIsIE=userAgent.indexOf("MSIE")>=0;function isIE(){return gIsIE}var gIsIE6=userAgent.indexOf("MSIE 6")>=0;function isIE6(){return gIsIE6}var gIsIE7=userAgent.indexOf("MSIE 7")>=0;function isIE7(){return gIsIE7}var gIsFF=userAgent.indexOf("Firefox/")>=0;function isFF(){return gIsFF}function replaceMultipleSpacesWithNbsp(a){return a==" "?"&nbsp;":a.replace(/  /g," &nbsp; ")}function getWindow(a){return a!=null&&a!="undefined"?a:window}function getWindowEventSrcElement(a){return a.event.srcElement}function getWindowEventToElement(a){return a.event.toElement}function cancelBubble(a,d){var c=getWindow(d),b=c.event;b.cancelBubble=a;b.returnValue=!a}function cancelEvent(b){var a=b||window.event;a.cancelBubble=true;a.returnValue=false}function isClassPresent(c,a){var b=c.className.split(" ");return inArray(a,b)>=0}function inArray(c,b){var d=b.length;for(var a=0;a<d;a++)if(b[a]==c)return a;return -1}function addCssClass(b,c){var a=b.className;if(a){if(a.indexOf(c)==-1)b.className=c+" "+a}else b.className=c}function removeCssClass(b,c){var a=b.className;if(a)b.className=a.replace(c,"").replace(/\s\s+/," ")}function getFirstDescendantWithClass(g,f){var e=g.getElementsByTagName("*"),i=e.length;for(var b=0;b<i;b++){var d=e[b],c=d.className.split(" "),h=c.length;for(var a=0;a<h;a++)if(c[a]==f)return d}return null}var gHtmlEncodeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},gHtmlEncodeRegExp=/([&<>"])/g;function ReplaceForHtmlEncode(b,a){return gHtmlEncodeMap[a]}function htmlEncode(a){if(a!=null&&a!=""){gHtmlEncodeRegExp.lastIndex=0;var b=gHtmlEncodeRegExp.test(a);if(b)a=a.replace(gHtmlEncodeRegExp,ReplaceForHtmlEncode)}return a?a:""}var gSingleQuoteRE=/'/g,gDoubleQuoteRE=/"/g;function htmlQuoteEncode(a){if(a!=null&&a!=""){a=a.replace(gSingleQuoteRE,"&#39");a=a.replace(gDoubleQuoteRE,"&#34")}return a}function setVisible(a,b){a.style.display=b?"block":"none"}function isVisible(a){return a.style.display!="none"}MailIM.EmPx=function MailIM_Em2Px$(a,b,c){if(a!=null&&a.endsWith("em"))this.setInEm=true;else if(b!=null&&b.endsWith("em"))this.setInEm=true;else this.setInEm=false;this._window=c;this.EM2PXOffset=this._numPxPerEm()};MailIM.EmPx.prototype={_window:null,EM2PXOffset:0,setInEm:false,_numPxPerEm:function MailIM_EmPx$_numPxPerEm(){var a=this._window.document.getElementById("EM2PX").offsetWidth;return a},checkForSizeChange:function MailIM_EmPx$checkForSizeChange(){var a=this._numPxPerEm();if(a!=this.EM2PXOffset){this.EM2PXOffset=a;return true}return false},tryParse:function MailIM_EmPx$tryParse(b){var a=parseFloat(b);if(isNaN(a))return null;return a},getVal:function MailIM_EmPx$getVal(b){var a;if(this.setInEm)a=b*1e3/this.EM2PXOffset;else a=b;return a},tryGetVal:function MailIM_EmPx$tryGetVal(b){var a=this.tryParse(b);if(a==null)return 0;else if(b.endsWith("px"))a=this.getVal(a);return a},getValText:function MailIM_EmPx$getValText(b){var a;if(this.setInEm)a=b+"em";else a=b+"px";return a}};MailIM.Anchor=function MailIM_Anchor$(c,b,a){this._stylesLoaded=gStylesLoaded;this.elt=c;this.eParent=b;this._window=a||window;if(gStylesLoaded)this.reset()};MailIM.Anchor.prototype={elt:null,eParent:null,_window:null,eltStyle:null,emPx:null,_horizontalSpace:0,_verticalSpace:0,_stylesLoaded:false,reset:function MailIM_Anchor$reset(){if(!this._stylesLoaded)return;if(!this.eParent)this.eParent=this.elt.offsetParent;var a=this.elt.currentStyle,b=document.documentElement.dir=="rtl";this.emPx=new MailIM.EmPx(b?a.right:a.left,a.top,this._window);var e=this.emPx.tryParse(b?a.right:a.left),f=this.emPx.tryParse(a.top),d=this.emPx.tryParse(b?a.left:a.right),c=this.emPx.tryParse(a.bottom),h=this.emPx.tryGetVal(b?a.borderRightWidth:a.borderLeftWidth),i=this.emPx.tryGetVal(b?a.borderLeftWidth:a.borderRightWidth),j=this.emPx.tryGetVal(a.borderTopWidth),g=this.emPx.tryGetVal(a.borderBottomWidth);MailIM.Anchor.prototype._resize=null;this._horizontalSpace=e+d+h+i;this._verticalSpace=f+c+j+g;if(!isNull(e)&&!isNull(d)&&!isNull(f)&&!isNull(c))this._resize=this.resizeAll;else if(!isNull(e)&&!isNull(d))this._resize=this.resizeHorizontal;else if(!isNull(f)&&!isNull(c))this._resize=this.resizeVertical;else if(a.display=="none")this._resize=this.resizeCheckAgain;this.eltStyle=this.elt.style},_resize:null,resizeCheckAgain:function MailIM_Anchor$resizeCheckAgain(){if(this.elt.currentStyle.display!="none"){this.reset();this._resize()}},resize:function MailIM_Anchor$resize(){if(gStylesLoaded){if(!this._stylesLoaded){this._stylesLoaded=true;this.reset()}this.emPx.checkForSizeChange();this._resize()}},resizeAll:function MailIM_Anchor$resizeAll(){this.resizeHorizontal();this.resizeVertical()},resizeHorizontal:function MailIM_Anchor$resizeHorizontal(){var a=this.emPx.getVal(this.eParent.clientWidth)-this._horizontalSpace;this.eltStyle.width=this.emPx.getValText(a>0?a:0)},resizeVertical:function MailIM_Anchor$resizeVertical(){var a=this.emPx.getVal(this.eParent.clientHeight)-this._verticalSpace;this.eltStyle.height=this.emPx.getValText(a>0?a:0)},dispose:function MailIM_Anchor$dispose(){this.elt=null;this.eParent=null;this.emPx=null}};var Control=function Control$(a,b){if(typeof a==="string"){this.Elt=$(b).cloneNode(true);this.Elt.id=a}else this.Elt=a;this.Elt.control=this};Control.prototype={Elt:null,attachControlToElementNoRecurse:function Control$attachControlToElementNoRecurse(a){this.attachToElt(this.Elt,a)},attachControlToElement:function Control$attachControlToElement(c){var b=this.Elt.childNodes;for(var a=0;a<b.length;a++)this.attachToElt(b[a],c)},attachToElt:function Control$attachElt(d,b){if(b.call(this,d)==false)return;var c=d.childNodes;for(var a=0;a<c.length;a++)this.attachToElt(c[a],b)},dispose:function Control$dispose(){this.Elt.control=null;this.Elt=null}};Control.findContainer=function Control$FindContainer(a){while(a&&!a.control)a=a.parentNode;return a&&a.control?a.control:null};Control.isEltInsideOfControl=function Control$isEltInControl(a,b){while(a){if(a.control&&Type.getInstanceType(a.control)==b)return true;a=a.parentNode}return false};Control.isEltInsideOfContainer=function Control$isEltInsideOfContainer(a,b){if(b)while(a){if(a==b)return true;if(a==this.Elt)return false;a=a.parentNode}return false};Control.findContainerOfType=function Control$findContainerOfType(a,b){while(a){if(a.control&&Type.getInstanceType(a.control)==b)return a.control;a=a.parentNode}return null};Control.getLocation=function Control$getLocation(b){var c=b.offsetLeft,d=b.offsetTop,a=b;while(a.offsetParent){a=a.offsetParent;c+=a.offsetLeft;d+=a.offsetTop}return {left:c,top:d,right:c+b.offsetWidth,bottom:d+b.offsetHeight}};Control.createClass("Control",null,IDisposable);function localizeFriendlyName(c){var a=c;if(a!=null){var b=a.indexOf("(E-mail Address Not Verified)");if(b!=-1){a=a.substring(0,b-1);a=a+" ("+gStrings.CW_Contact_EmailNotVerified+")"}}return a}var gDefaultAwayTime=60;MailIM.InactiveTimer=function MailIM_InactiveTimer$(a){if(!this._isAwayTimeValid(a))a=gDefaultAwayTime;this.m_awayMinutes=a;this.m_ellapsed=0;this.m_intervalHandle=0;this.m_resetTime=Delegate.create(this,this.resetTime);this._startInactiveTimer()};MailIM.InactiveTimer._interval=6e4;MailIM.InactiveTimer.prototype={m_awayMinutes:0,m_ellapsed:0,m_intervalHandle:0,m_resetTime:null,_isAwayTimeValid:function MailIM_InactiveTimer$_isAwayTimeValid(a){return a===-1||a===15||a===30||a===45||a===60||a===120||a===240},dispose:function MailIM_InactiveTimer$dispose(){this._stopInactiveTimer();this.m_resetTime=null;this.m_awayMinutes=0;this.m_ellapsed=0;this.m_intervalHandle=0},add_inactiveStatus:function MailIM_InactiveTimer$add_inactiveStatus(a){this.__inactiveStatus=Delegate.combine(this.__inactiveStatus,a)},remove_inactiveStatus:function MailIM_InactiveTimer$remove_inactiveStatus(a){this.__inactiveStatus=Delegate.remove(this.__inactiveStatus,a)},__inactiveStatus:null,add_activeStatus:function MailIM_InactiveTimer$add_activeStatus(a){this.__activeStatus=Delegate.combine(this.__activeStatus,a)},remove_activeStatus:function MailIM_InactiveTimer$remove_activeStatus(a){this.__activeStatus=Delegate.remove(this.__activeStatus,a)},__activeStatus:null,onInterval:function MailIM_InactiveTimer$onInterval(){this.m_ellapsed++;if(this.m_awayMinutes>0)if(this.m_ellapsed===this.m_awayMinutes)if(this.__inactiveStatus)this.__inactiveStatus.invoke()},resetTime:function MailIM_InactiveTimer$resetTime(){if(this.m_awayMinutes>0)if(this.m_ellapsed>=this.m_awayMinutes)if(this.__activeStatus)this.__activeStatus.invoke();this.m_ellapsed=0},_startInactiveTimer:function MailIM_InactiveTimer$_startInactiveTimer(){window.attachEvent("onresize",this.m_resetTime);document.body.attachEvent("onclick",this.m_resetTime);document.body.attachEvent("onkeydown",this.m_resetTime);if(!this.m_intervalHandle)this.m_intervalHandle=window.setInterval(Delegate.create(this,this.onInterval),MailIM.InactiveTimer._interval)},_stopInactiveTimer:function MailIM_InactiveTimer$_stopInactiveTimer(){if(this.m_intervalHandle){window.clearInterval(this.m_intervalHandle);this.m_intervalHandle=0}window.detachEvent("onresize",this.m_resetTime);document.body.detachEvent("onclick",this.m_resetTime);document.body.detachEvent("onkeydown",this.m_resetTime)},get__inactiveAwayMinutes:function MailIM_InactiveTimer$get__inactiveAwayMinutes(){return this.m_awayMinutes},set__inactiveAwayMinutes:function MailIM_InactiveTimer$set__inactiveAwayMinutes(a){this.m_awayMinutes=a;return a}};MailIM.PropertyBag=function MailIM_PropertyBag$(){this._bag={}};MailIM.PropertyBag.prototype={_bag:null,_clearAllFromPropertyBag:function MailIM_PropertyBag$_clearAllFromPropertyBag(){for(var a in this._bag)delete this._bag[a]},setToPropertyBag:function MailIM_PropertyBag$setToPropertyBag(a,b){this._bag[a]=b},getFromPropertyBag:function MailIM_PropertyBag$getFromPropertyBag(a){var b=this._bag[a];return b},replaceIdInPropertyBag:function MailIM_PropertyBag$_replaceIdInPropertyBag(a,b){var c=null;if(a&&b){c=this._bag[a];if(a!=b){this._bag[b]=c;this._bag[a]=null;delete this._bag[a]}}return c},clearFromPropertyBag:function MailIM_PropertyBag$_clearFromPropertyBag(a){delete this._bag[a]},debugCheckifAllNull:function MailIM_PropertyBag$debugCheckifAllNull(){for(var a in this._bag);},every:function MailIM_PropertyBag$every(b){for(var a in this._bag)b.invoke(a,this._bag[a])},isEmpty:function MailIM_PropertyBag$isEmpty(){for(var a in this._bag)return false;return true},dispose:function MailIM_PropertyBag$dispose(){this._clearAllFromPropertyBag()}};MailIM.DebugMessager=function MailIM_DebugMessager$(){this._messageDiv=null};MailIM.DebugMessager.prototype={_messageDiv:null,write:function MailIM_ChatManager$write(b){if(this._messageDiv){var a=document.createElement("DIV");if(arguments.length==1)a.innerHTML=b;else if(this._webIM)a.innerHTML=String.format(arguments);a=this._messageDiv.appendChild(a)}},dispose:function MailIM_PropertyBag$dispose(){this._messageDiv=null}};function setWebIMCookie(b,a,c){if(String.isNullOrEmpty(a)){var d=new Date;document.cookie=b+"=0;expires="+d.toGMTString()+"; path=/im"}else document.cookie=b+"="+a+(c?"":"; expires=Fri, 31 Dec 2010 20:00:00 UTC; path=/im")}function getWebIMCookie(c){var d=document.cookie;if(d.indexOf(c)!=-1){var e=d.split(";"),h=e.length;for(var f=h;f--;){var a=e[f],b=a.indexOf("=");if(b!=-1){var g=a.substring(0,b).trim();if(g==c)return a.substring(b+1,a.length).trim()}}}return null}Type.createNamespace("Menu");var WebLight={UI:{},Conversion:{}};WebLight.UI.getLocation=function(b,f){if(!b)return WebLight.UI.Rect.Empty;var a=new WebLight.UI.Rect;a.source=b;var e=b.currentStyle,h=["Top","Left","Right","Bottom"];for(var d=0;d<h.length;d++){var c=h[d];a["margin"+c]=WebLight.Conversion.coerceInt(e["margin"+c]);a["border"+c]=WebLight.Conversion.coerceInt(e["border"+c+"Width"]);a["padding"+c]=WebLight.Conversion.coerceInt(e["padding"+c])}a.height=b.offsetHeight;a.width=b.offsetWidth;a.left=b.offsetLeft;a.top=b.offsetTop;b=b.offsetParent;var g=WebLight.UI.getLayoutRoot();while(b&&(!f||b!=f)){a.left+=b.offsetLeft-(g!=b?WebLight.Conversion.coerceInt(b.scrollLeft):0);a.top+=b.offsetTop-(g!=b?WebLight.Conversion.coerceInt(b.scrollTop):0);b=b.offsetParent}if(document.compatMode=="CSS1Compat"){a.contentWidth=a.source.offsetWidth-a.borderLeft-a.borderRight-a.paddingLeft-a.paddingRight-a.marginLeft-a.marginRight;a.contentHeight=a.source.offsetHeight-a.borderTop-a.borderBottom-a.paddingTop-a.paddingBottom-a.marginTop-a.marginBottom}else{a.contentWidth=a.source.offsetWidth;a.contentHeight=a.source.offsetHeight}a.x=a.left;a.y=a.top;a.bottom=a.top+a.height-a.marginBottom;a.right=a.left+a.width-a.marginRight;return a};WebLight.UI.Rect=function(a,b,d,c){return {left:a,x:a,top:b,y:b,width:d,height:c,right:a+d,bottom:b+c,equals:function(a){return this.x==a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height},inflate:function(b,a){this.width+=b;this.height+=a;this.right=this.x+this.width;this.bottom=this.y+this.height},offset:function(a,b){this.x+=a;this.left=this.x;this.y+=b;this.top=this.y;this.right+=a;this.bottom+=b},isEmpty:function(){return this.width<=0||this.height<=0},contains:function(a){return a.x>=this.left&&a.x<=this.width+this.left&&a.y>=this.top&&a.y<=this.height+this.top}}};WebLight.UI.Rect.Empty=new WebLight.UI.Rect(0,0,0,0);WebLight.Conversion={coerceInt:function(a){a=parseInt(a);return isNaN(a)?0:a}};WebLight.UI.getLayoutRoot=function(){return document.compatMode=="CSS1Compat"?document.documentElement:document.body};Menu.PopUpPosition=function Menu_PopUpPosition$(){};Menu.PopUpPosition.prototype={leftBottom:1,center:2,rightTop:3,rightBottom:4,topLeft:5};Menu.PopUpPosition.createEnum("Menu.PopUpPosition",false);Menu.MenuBody=function Menu_MenuBody(a,c,d,b,e){Menu.MenuBody.constructBase(this,[a]);this._m_menuBody$1=a;this._m_menuBody$1.style.display="none";this._m_menuBody$1.style.position="absolute";this._m_menuAction$1=c;this._m_position$1=d;this._m_commonParent$1=b;this._m_window$1=getWindow(e);this._m_onKeyDown$1=Delegate.create(this,this._onKeyDown$1);this._m_onMenuBodySelect$1=Delegate.create(this,this._onMenuBodySelect$1);this._m_checkToCloseMenu$1=Delegate.create(this,this._checkToCloseMenu$1);this._m_onWindowResize$1=Delegate.create(this,this.hide)};Menu.MenuBody.prototype={_m_menuBody$1:null,_m_menuAction$1:null,_m_commonParent$1:null,_m_position$1:0,_m_onKeyDown$1:null,_m_onMenuBodySelect$1:null,_m_checkToCloseMenu$1:null,_m_onWindowResize$1:null,_m_handlers$1:null,_m_selected$1:null,_m_window$1:null,dispose:function Menu_MenuBody$dispose(){this._m_menuBody$1=this._m_menuAction$1=this._m_commonParent$1=null;this._m_onKeyDown$1=this._m_onMenuBodySelect$1=this._m_checkToCloseMenu$1=this._m_onWindowResize$1=null;this._m_position$1=0;this._m_window$1=null;Menu.MenuBody.callBase(this,"dispose")},show:function Menu_MenuBody$show(c){if(c)this._m_menuAction$1=c;var a=this._getOptions$1();this._m_handlers$1=new Array(a.length);for(var b=0;b<a.length;b++)this._m_handlers$1[b]=new Menu._focusHandler(this,a[b]);this._m_menuBody$1.attachEvent("onkeydown",this._m_onKeyDown$1);this._m_menuBody$1.attachEvent("onclick",this._m_onMenuBodySelect$1);this._m_menuBody$1.attachEvent("onfocusout",this._m_checkToCloseMenu$1);this._m_window$1.attachEvent("onresize",this._m_onWindowResize$1);this._positionMenuBody$1(this._m_menuAction$1);this._m_menuBody$1.style.display="block";this._setDropDownImageAltText$1(true);this._selectOptionInc$1(a[0])},_setDropDownImageAltText$1:function Menu_MenuBody$_setDropDownImageAltText$1(b){var a=getFirstDescendantWithClass(this._m_menuAction$1,"DropDownImg");if(a)a.alt=b?gStrings.Actionbar_Accessibility_CloseAlt:gStrings.Actionbar_Accessibility_OpenAlt},_positionMenuBody$1:function Menu_MenuBody$_positionMenuBody$1(h){var e=WebLight.UI.getLocation(h,this._m_commonParent$1),d=e.top,c=e.left,f=e.height,g=e.width,b,a;switch(this._m_position$1){case Menu.PopUpPosition.center:b=d+f/2;a=c+g/2;break;case Menu.PopUpPosition.rightTop:b=d;a=c+g;break;case Menu.PopUpPosition.rightBottom:b=d+f;this._m_menuBody$1.style.left=-500+"px";this._m_menuBody$1.style.display="block";a=c+g-this._m_menuBody$1.offsetWidth;this._m_menuBody$1.style.display="none";break;case Menu.PopUpPosition.topLeft:this._m_menuBody$1.style.left=-500+"px";this._m_menuBody$1.style.display="block";b=d-this._m_menuBody$1.offsetHeight;this._m_menuBody$1.style.display="none";a=c;break;case Menu.PopUpPosition.leftBottom:default:b=d+f;a=c}this._m_menuBody$1.style.top=b+"px";this._m_menuBody$1.style.left=a+"px"},_selectOptionInc$1:function Menu_MenuBody$_selectOptionInc$1(a){while(a&&(a.tagName!=="LI"||a.style.display==="none"))a=a.nextSibling;if(a)this._focusOption$1(a)},selectOption:function Menu_MenuBody$selectOption(b){var a=this.getItemByKey(b);if(a)addCssClass(a,"SelectedItem")},unSelectOption:function Menu_MenuBody$unSelectOption(b){var a=this.getItemByKey(b);if(a)removeCssClass(a,"SelectedItem")},_selectOptionDec$1:function Menu_MenuBody$_selectOptionDec$1(a){while(a&&(a.tagName!=="LI"||a.style.display==="none"))a=a.previousSibling;if(a)this._focusOption$1(a)},_focusOption$1:function Menu_MenuBody$_focusOption$1(a){a.childNodes[0].focus()},hide:function Menu_MenuBody$hide(){if(this._m_handlers$1){for(var a=0;a<this._m_handlers$1.length;a++)this._m_handlers$1[a].dispose();this._m_handlers$1=null;this._m_menuBody$1.detachEvent("onkeydown",this._m_onKeyDown$1);this._m_menuBody$1.detachEvent("onclick",this._m_onMenuBodySelect$1);this._m_menuBody$1.detachEvent("onfocusout",this._m_checkToCloseMenu$1);this._m_window$1.detachEvent("onresize",this._m_onWindowResize$1);this._m_menuBody$1.style.display="none";this._setDropDownImageAltText$1(false)}},get__selectedOption:function Menu_MenuBody$get__selectedOption(){return this._m_selected$1},set__selectedOption:function Menu_MenuBody$set__selectedOption(a){this._m_selected$1=a;return a},_onMenuBodySelect$1:function Menu_MenuBody$_onMenuBodySelect$1(){var a=getWindowEventSrcElement(this._m_window$1),b;while(!isNullOrUndefined(a)&&a!==this._m_menuBody$1){b=a.getAttribute(Menu.MenuBody._s_menuOptionAttribute$1);if(!String.isNullOrEmpty(b)){if(this.__menuSelect$1&&this.__menuSelect$1.invoke(this,b,a))this.hide();break}else a=a.parentNode}},add_menuSelect:function Menu_MenuBody$add_menuSelect(a){this.__menuSelect$1=Delegate.combine(this.__menuSelect$1,a)},remove_menuSelect:function Menu_MenuBody$remove_menuSelect(a){this.__menuSelect$1=Delegate.remove(this.__menuSelect$1,a)},__menuSelect$1:null,_onKeyDown$1:function Menu_MenuBody$_onKeyDown$1(){switch(this._m_window$1.event.keyCode){case Menu.MenuBody._jS_KEY_UP$1:if(!this._m_window$1.eventData.handled){this._selectOptionDec$1(this.get__selectedOption().previousSibling);this._m_window$1.eventData.handled=true}break;case Menu.MenuBody._jS_KEY_DOWN$1:if(!this._m_window$1.eventData.handled){this._selectOptionInc$1(this.get__selectedOption().nextSibling);this._m_window$1.eventData.handled=true}break;case Menu.MenuBody._jS_KEY_ESC$1:if(!this._m_window$1.eventData.handled){this.hide();this._m_window$1.eventData.handled=true}break;case Menu.MenuBody._jS_KEY_ENTER$1:if(!this._m_window$1.eventData.handled)this._m_window$1.eventData.handled=true;break;default:return}},_checkToCloseMenu$1:function Menu_MenuBody$_checkToCloseMenu$1(){var a=getWindowEventToElement(this._m_window$1);while(!isNullOrUndefined(a)){if(a===this._m_menuAction$1||a===this._m_menuBody$1)return;a=a.parentNode}this.hide()},isVisible:function Menu_MenuBody$isVisible(){return this._m_menuBody$1.style.display!=="none"},_getOptions$1:function Menu_MenuBody$_getOptions$1(){return this._m_menuBody$1.children[0].children},getItemByKey:function Menu_MenuBody$getItemByKey(d){var b=this._getOptions$1(),e=b.length;for(var a=0;a<e;a++){var c=b[a];if(c.getAttribute(Menu.MenuBody._s_menuOptionAttribute$1)===d)return c}return null},hideOption:function Menu_MenuBody$hideOption(b){var a=this.getItemByKey(b);if(a)a.style.display="none"},showOption:function Menu_MenuBody$showOption(b){var a=this.getItemByKey(b);if(a)a.style.display="block"},showAllOptions:function Menu_MenuBody$showAllOptions(){var c=this._getOptions$1(),d=c.length,a;for(var b=0;b<d;b++){a=c[b];if(a.getAttribute(Menu.MenuBody._s_menuOptionAttribute$1))a.style.display="block"}},deleteOption:function Menu_MenuBody$deleteOption(b){var a=this.getItemByKey(b);if(a)this._m_menuBody$1.children[0].removeChild(a)},addOption:function Menu_MenuBody$addOption(a){this._m_menuBody$1.children[0].appendChild(a)}};Menu._focusHandler=function Menu__focusHandler(b,a){this.menuBody=b;this.menuOption=a;a.childNodes[0].attachEvent("onfocus",Delegate.create(this,this._onFocus))};Menu._focusHandler.prototype={menuBody:null,menuOption:null,_onFocus:function Menu__focusHandler$_onFocus(){this.menuBody.set__selectedOption(this.menuOption)},dispose:function Menu__focusHandler$dispose(){this.menuOption.childNodes[0].detachEvent("onfocus",Delegate.create(this,this._onFocus))}};Menu.MenuControl=function Menu_MenuControl(a,b){Menu.MenuControl.constructBase(this,[a]);this._m_menuAction$1=a;this._m_menuBody$1=b;this._m_toggleMenu$1=Delegate.create(this,this._toggleMenu$1);this._m_menuAction$1.attachEvent("onclick",this._m_toggleMenu$1)};Menu.MenuControl.prototype={_m_menuAction$1:null,_m_menuBody$1:null,_m_toggleMenu$1:null,_toggleMenu$1:function Menu_MenuControl$_toggleMenu$1(){if(this._m_menuBody$1.isVisible())this._m_menuBody$1.hide();else this._m_menuBody$1.show(null)},dispose:function Menu_MenuControl$dispose(){if(this._m_toggleMenu$1&&this._m_menuAction$1)this._m_menuAction$1.detachEvent("onclick",this._m_toggleMenu$1);this._m_menuAction$1=null;this._m_menuBody$1=null;this._m_toggleMenu$1=null;Menu.MenuControl.callBase(this,"dispose")}};Menu.MenuBody.createClass("Menu.MenuBody",Control);Menu._focusHandler.createClass("Menu._focusHandler",null,IDisposable);Menu.MenuControl.createClass("Menu.MenuControl",Control);Menu.MenuBody._jS_KEY_UP$1=38;Menu.MenuBody._jS_KEY_DOWN$1=40;Menu.MenuBody._jS_KEY_ESC$1=27;Menu.MenuBody._jS_KEY_ENTER$1=13;Menu.MenuBody._s_menuOptionAttribute$1="menukey";function EntityReplace(b){var e="";if(b!=null){var f=b.length,c=0;while(c<f){var a=c,d=entityList[b.charAt(a)];while(a<f&&null==d){a++;d=entityList[b.charAt(a)]}e+=b.substr(c,a-c);if(d!=null){e+=d;a++}c=a}}return e}MailIM.EmoticonInfo=function MailIM_EmoticonInfo$(e,c,f,d,b,a){this.IsLeaf=true;this.IsYahooEnabled=d==true;this.DisabledLanguage=a?a:null;this.EmoticonToHtml=function(){var a=e+1;if(a>81&&a<98)a=81;if(b)return '<img class="Emoticon" alt="" src="'+getImage("emo/"+b,true)+'" title="'+c+'" />';else return '<img class="Emoticon" alt="" src="'+getImage("emo/"+a+".gif",true)+'" title="'+c+'" />'};this.Length=function(){return f}};MailIM.Emoticons=function MailIM_Emoticons$(){var b=null,d=[],f=["EMOTICON_SMILE","EMOTICON_SMILED","EMOTICON_WINK_ANIMATED","EMOTICON_SMILEO","EMOTICON_SMILEP","EMOTICON_HOTTIE","EMOTICON_ANGRY","EMOTICON_BLUSH","EMOTICON_CROOKED","EMOTICON_SAD","EMOTICON_CRY_ANIMATED","EMOTICON_DIGUST","EMOTICON_DEVIL","EMOTICON_ANGEL","EMOTICON_LOVE","EMOTICON_UNLOVE","EMOTICON_MESSENGER","EMOTICON_CAT","EMOTICON_DOG","EMOTICON_SLEEP","EMOTICON_STAR","EMOTICON_FILM_REEL","EMOTICON_MUSIC","EMOTICON_EMAIL","EMOTICON_ROSE","EMOTICON_WILTED","EMOTICON_CLOCK","EMOTICON_LIPS","EMOTICON_GIFT","EMOTICON_CAKE_ANIMATED","EMOTICON_CAMERA","EMOTICON_BULB","EMOTICON_COFFEE","EMOTICON_PHONE","EMOTICON_LEFTHUG","EMOTICON_RIGHTHUG","EMOTICON_BEER","EMOTICON_COCKTAIL","EMOTICON_MALE","EMOTICON_FEMALE","EMOTICON_THUMBSUP","EMOTICON_THUMBSDOWN","EMOTICON_VAMPIRE_ANIMATED","EMOTICON_GOAT","EMOTICON_HANDCUFFS","EMOTICON_SUN","EMOTICON_RAINBOW","EMOTICON_QUIET","EMOTICON_GROWL","EMOTICON_NERD","EMOTICON_SARCASTIC","EMOTICON_WHISPER","EMOTICON_YUCK","EMOTICON_SNAIL","EMOTICON_TURTLE","EMOTICON_PLATE","EMOTICON_BOWL","EMOTICON_PIZZA","EMOTICON_SOCCER","EMOTICON_CAR","EMOTICON_PLANE","EMOTICON_UMBRELLA","EMOTICON_ISLAND","EMOTICON_COMPUTER","EMOTICON_CELLPHONE","EMOTICON_BRB","EMOTICON_STORM","EMOTICON_FINGERS_CROSSED","EMOTICON_HIGH_5","EMOTICON_MONEY","EMOTICON_SHEEP","EMOTICON_BEATS_ME_ANIMATED","EMOTICON_SCRATCH_ANIMATED","EMOTICON_LIGHTNING_ANIMATED","EMOTICON_PARTY_ANIMATED","EMOTICON_ROLLEYES_ANIMATED","EMOTICON_CANCER_ANIMATED","EMOTICON_SLEEPY_ANIMATED","EMOTICON_XBOX","EMOTICON_BUNNY","EMOTICON_PROJECT_DREAM_0","EMOTICON_PROJECT_DREAM_1","EMOTICON_PROJECT_DREAM_2","EMOTICON_PROJECT_DREAM_3","EMOTICON_PROJECT_DREAM_4","EMOTICON_PROJECT_DREAM_5","EMOTICON_PROJECT_DREAM_6","EMOTICON_PROJECT_DREAM_7","EMOTICON_PROJECT_DREAM_8","EMOTICON_PROJECT_DREAM_9","EMOTICON_PROJECT_DREAM_10","EMOTICON_PROJECT_DREAM_11","EMOTICON_PROJECT_DREAM_12","EMOTICON_PROJECT_DREAM_13","EMOTICON_PROJECT_DREAM_14","EMOTICON_PROJECT_DREAM_15","EMOTICON_PROJECT_DREAM_16"];function e(b,f,d,c){var a=d.charAt(c);if(c<d.length-1){if(b[a]==null)b[a]=[];e(b[a],f,d,c+1)}else b[a]=f}function a(c,i,g,h,f){var a=EntityReplace(c),j=new MailIM.EmoticonInfo(b[i],c,a.length,g,h,f);e(d,j,a,0)}function g(){b={};var c;for(var a=0;a<f.length;a++){c=f[a];b[c]=a}}function i(){g();a(":)","EMOTICON_SMILE",true);a(":-)","EMOTICON_SMILE",true);a(":D","EMOTICON_SMILED");a(":d","EMOTICON_SMILED");a(":-D","EMOTICON_SMILED");a(":-d","EMOTICON_SMILED");a(":>","EMOTICON_SMILED");a(":->","EMOTICON_SMILED");a(";)","EMOTICON_WINK_ANIMATED",true,"wink.gif");a(";-)","EMOTICON_WINK_ANIMATED",true,"wink.gif");a(":-O","EMOTICON_SMILEO",true);a(":-o","EMOTICON_SMILEO",true);a(":O","EMOTICON_SMILEO",true);a(":o","EMOTICON_SMILEO",true,null,"fi");a(":P","EMOTICON_SMILEP",true);a(":p","EMOTICON_SMILEP",true,null,"fi");a(":-P","EMOTICON_SMILEP",true);a(":-p","EMOTICON_SMILEP",true);a("(H)","EMOTICON_HOTTIE",true);a("(h)","EMOTICON_HOTTIE",true);a(":@","EMOTICON_ANGRY",true);a(":-@","EMOTICON_ANGRY",true);a(":$","EMOTICON_BLUSH",true);a(":-$","EMOTICON_BLUSH",true);a(":S","EMOTICON_CROOKED",true);a(":s","EMOTICON_CROOKED",true,null,"fi");a(":-S","EMOTICON_CROOKED",true);a(":-s","EMOTICON_CROOKED",true);a(":(","EMOTICON_SAD",true);a(":-(","EMOTICON_SAD",true);a(":<","EMOTICON_SAD",true);a(":-<","EMOTICON_SAD",true);a(":'(","EMOTICON_CRY_ANIMATED",true,"cry.gif");a(":|","EMOTICON_DIGUST",true);a(":-|","EMOTICON_DIGUST",true);a("(6)","EMOTICON_DEVIL",true);a("(A)","EMOTICON_ANGEL",true);a("(a)","EMOTICON_ANGEL",true);a("(L)","EMOTICON_LOVE",true);a("(l)","EMOTICON_LOVE",true);a("(U)","EMOTICON_UNLOVE",true);a("(u)","EMOTICON_UNLOVE",true);a("(M)","EMOTICON_MESSENGER");a("(m)","EMOTICON_MESSENGER");a("(@)","EMOTICON_CAT");a("(&)","EMOTICON_DOG");a("(S)","EMOTICON_SLEEP");a("(*)","EMOTICON_STAR");a("(~)","EMOTICON_FILM_REEL");a("(8)","EMOTICON_MUSIC");a("(E)","EMOTICON_EMAIL");a("(e)","EMOTICON_EMAIL",false,null,"fr");a("(F)","EMOTICON_ROSE");a("(f)","EMOTICON_ROSE");a("(W)","EMOTICON_WILTED");a("(w)","EMOTICON_WILTED");a("(O)","EMOTICON_CLOCK");a("(o)","EMOTICON_CLOCK");a("(0)","EMOTICON_CLOCK");a("(K)","EMOTICON_LIPS",true);a("(k)","EMOTICON_LIPS",true);a("(G)","EMOTICON_GIFT");a("(g)","EMOTICON_GIFT");a("(^)","EMOTICON_CAKE_ANIMATED",false,"cake2.gif");a("(P)","EMOTICON_CAMERA");a("(p)","EMOTICON_CAMERA");a("(I)","EMOTICON_BULB");a("(i)","EMOTICON_BULB");a("(C)","EMOTICON_COFFEE");a("(c)","EMOTICON_COFFEE");a("(T)","EMOTICON_PHONE");a("(t)","EMOTICON_PHONE");a("({)","EMOTICON_LEFTHUG");a("(})","EMOTICON_RIGHTHUG");a("(B)","EMOTICON_BEER");a("(b)","EMOTICON_BEER");a("(D)","EMOTICON_COCKTAIL");a("(d)","EMOTICON_COCKTAIL");a("(Z)","EMOTICON_MALE");a("(z)","EMOTICON_MALE");a("(X)","EMOTICON_FEMALE");a("(x)","EMOTICON_FEMALE");a("(Y)","EMOTICON_THUMBSUP");a("(y)","EMOTICON_THUMBSUP");a("(N)","EMOTICON_THUMBSDOWN");a("(n)","EMOTICON_THUMBSDOWN");a(":[","EMOTICON_VAMPIRE_ANIMATED",false,"bat2.gif");a(":-[","EMOTICON_VAMPIRE_ANIMATED",false,"bat2.gif");a("(nah)","EMOTICON_GOAT");a("(%)","EMOTICON_HANDCUFFS");a("(#)","EMOTICON_SUN");a("(R)","EMOTICON_RAINBOW");a("(r)","EMOTICON_RAINBOW");a(":-#","EMOTICON_QUIET",true);a("8o|","EMOTICON_GROWL");a("8-|","EMOTICON_NERD",true);a("^o)","EMOTICON_SARCASTIC",true);a(":-*","EMOTICON_WHISPER");a("+o(","EMOTICON_YUCK",true);a("(sn)","EMOTICON_SNAIL");a("(tu)","EMOTICON_TURTLE");a("(pl)","EMOTICON_PLATE");a("(||)","EMOTICON_BOWL");a("(pi)","EMOTICON_PIZZA");a("(so)","EMOTICON_SOCCER");a("(au)","EMOTICON_CAR");a("(ap)","EMOTICON_PLANE");a("(um)","EMOTICON_UMBRELLA");a("(ip)","EMOTICON_ISLAND");a("(co)","EMOTICON_COMPUTER");a("(mp)","EMOTICON_CELLPHONE");a("(brb)","EMOTICON_BRB");a("(st)","EMOTICON_STORM");a("(yn)","EMOTICON_FINGERS_CROSSED");a("(h5)","EMOTICON_HIGH_5");a("(mo)","EMOTICON_MONEY");a("(bah)","EMOTICON_SHEEP");a(":^)","EMOTICON_BEATS_ME_ANIMATED",false,"sniff.gif");a("*-)","EMOTICON_SCRATCH_ANIMATED",true,"thinking.gif");a("(li)","EMOTICON_LIGHTNING_ANIMATED",false,"lightning.gif");a("<:o)","EMOTICON_PARTY_ANIMATED",true,"party.gif");a("8-)","EMOTICON_ROLLEYES_ANIMATED",true,"eyeroll.gif");a("(ci)","EMOTICON_CANCER_ANIMATED",false,"smoke.gif");a("|-)","EMOTICON_SLEEPY_ANIMATED",true,"yawn.gif");a("(xx)","EMOTICON_XBOX");a("('.')","EMOTICON_BUNNY");a("*red+u","EMOTICON_PROJECT_DREAM_0");a("*naf","EMOTICON_PROJECT_DREAM_1");a("*sierra","EMOTICON_PROJECT_DREAM_2");a("*bgca","EMOTICON_PROJECT_DREAM_3");a("*9mil","EMOTICON_PROJECT_DREAM_4");a("*hsus","EMOTICON_PROJECT_DREAM_5");a("*unicef","EMOTICON_PROJECT_DREAM_6");a("*komen","EMOTICON_PROJECT_DREAM_7");a("*one","EMOTICON_PROJECT_DREAM_8");a("*mssoc","EMOTICON_PROJECT_DREAM_9");a("*care","EMOTICON_PROJECT_DREAM_10");a("*wwf","EMOTICON_PROJECT_DREAM_11");a("*acs","EMOTICON_PROJECT_DREAM_12");a("*oxfam","EMOTICON_PROJECT_DREAM_13");a("*mod","EMOTICON_PROJECT_DREAM_14");a("*help","EMOTICON_PROJECT_DREAM_15");a("*sgw","EMOTICON_PROJECT_DREAM_16")}function h(a){var d=65248,c=65281,e=93;if(a.charCodeAt!=null&&String.fromCharCode!=null){var b=a.charCodeAt(0);if(b>=c&&b<c+e)a=String.fromCharCode(b-d)}return a}function c(a,f,b,d){if(a==null)return null;else if(a.IsLeaf){if(a.DisabledLanguage!=null){var g=null;if(g&&a.DisabledLanguage==g)return null}if(d&&a.IsYahooEnabled||!d)return a;return null}else if(b>=f.length||b<0)return null;else if(typeof a=="object"){var e=f.charAt(b);e=h(e);return c(a[e],f,b+1,d)}return null}function j(b,a){if("&"!=b.charAt(a))return 1;var d=0,e=false;if(a<b.length&&"&"==b.charAt(a)){e=false;for(var f in entityList){var c=entityList[f];if(a+c.length<=b.length&&c==b.substr(a,c.length)){d+=c.length;a+=d;e=true;break}}if(e)return d}return d}this.Replace=function(b,h){var g="";if(b!=null){var f=0,i=b.length;while(f<i){var a=f,e=c(d,b,a,h);while(a<i&&null==e){a+=j(b,a);e=c(d,b,a,h)}g+=b.substr(f,a-f);if(e!=null){g+=e.EmoticonToHtml();a+=e.Length()}f=a}}return g};i()};var globalEmoticons;function EmoticonReplace(b,a){if(globalEmoticons==null)globalEmoticons=new MailIM.Emoticons;return replaceMultipleSpacesWithNbsp(globalEmoticons.Replace(b,a))}function EmoticonReplacedHtml(a,b){if(a!=null&&a!="")return EmoticonReplace(EntityReplace(a),b);else return ""}function LinkAndEmoticonReplacedHtml(f,i){if(f==null||f=="")return "";var c=EntityReplace(f),e="",b=/(((http|https):\/\/)|(www\.))(\S+)/gi;b.lastIndex=0;var d=b.exec(c);while(null!=d){var j=d.index>0?c.substring(0,d.index):"",a=c.substring(d.index,b.lastIndex),g="";if(a!=null)if(a.length>0)if(a.lastIndexOf(".")==a.length-1){a=a.substring(0,a.length-1);g="."}g+=c.substring(b.lastIndex);var h=a;if(d[1]=="www.")h="http://"+a;e+=EmoticonReplace(j,i)+"<a class='underline' href='"+h+"' target='_new' title='"+a+"'>"+a+"</a>";c=g;b=/(((http|https):\/\/)|(www\.))(\S+)/gi;b.lastIndex=0;d=b.exec(c)}e+=EmoticonReplace(c);if(e.length<=0)e=f;return e}MailIM.EmoticonMenuBody=function MailIM_EmotionMenuBody$(c,b,d){this.m_window=getWindow(d);var a=this.m_window.document.getElementById(c);this.m_emoOnClick=Delegate.create(this,this.emoMenuSelectHandler);this.m_menuBody=new Menu.MenuBody(a,null,Menu.PopUpPosition.topLeft,this.m_window.document.getElementById(b),this.m_window);this.m_menuBody.add_menuSelect(this.m_emoOnClick)};MailIM.EmoticonMenuBody.prototype={m_emoOnClick:null,m_menuBody:null,m_currentCW:null,m_window:null,emoMenuSelectHandler:function MailIM_EmotionMenuBody$emoMenuSelectHandler(c,a){this.copyEmoToTextBox(a);return true},getBody:function MailIM_EmotionMenuBody$getBody(){return this.m_menuBody},setCW:function MailIM_EmotionMenuBody$setCW(a){this.m_currentCW=a},copyEmoToTextBox:function MailIM_EmotionMenuBody$copyEmoToTextBox(a){if(!this.m_currentCW.eTextbox.disabled){this.m_currentCW.eTextbox.value=this.m_currentCW.eTextbox.value+a;this.m_currentCW._synchronizeSendButtonState();this.m_currentCW.eTextbox.focus()}},dispose:function MailIM_EmotionMenuBody$dispose(){if(this.m_emoOnClick&&this.m_menuBody)this.m_menuBody.remove_menuSelect(this._m_optionsOnClick);if(this.m_menuBody)this.m_menuBody.dispose();this.m_emoOnClick=null;this.m_menuBody=null;this.m_currentCW=null;this.m_window=null}};var gEmoMenuBody=null,gEmoYMenuBody=null;function UnInitEmoMenuBody(b){var a=getWindow(b);if(a.gEmoMenuBody!=null){a.gEmoMenuBody.dispose();a.gEmoMenuBody=null}if(a.gEmoYMenuBody!=null){a.gEmoYMenuBody.dispose();a.gEmoYMenuBody=null}}