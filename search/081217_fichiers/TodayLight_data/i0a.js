CompatExtension["c_keyevent"]=function CompatEx$KeyEvent(a){function e(a){switch(a){case "onkeydown":case "onkeyup":case "onkeypress":return true}return false}function d(b){if(b===a)return true;switch(b.tagName){case "INPUT":case "A":case "BUTTON":case "SELECT":case "TEXTAREA":case "HTML":return true}return false}var f=a.attachEvent,g=a.detachEvent;function b(c,b){if(e(c)&&!d(this)){b._elt=this;b._isKeyboardHandlerAttached=false;b._onKeyboardFocusIn=function(){if(!b._isKeyboardHandlerAttached){b._isKeyboardHandlerAttached=true;a.attachEvent(c,b)}};this.attachEvent("onfocusin",b._onKeyboardFocusIn);b._onKeyboardFocusOut=function(){if(!b._elt.contains(event.toElement)){b._isKeyboardHandlerAttached=false;a.detachEvent(c,b)}};this.attachEvent("onfocusout",b._onKeyboardFocusOut);return}f.call(this,c,b)}function c(b,a){if(e(b)&&!d(this)){var f=a._onKeyboardFocusIn;delete a._onKeyboardFocusIn;this.detachEvent("onfocusin",f);var c=a._onKeyboardFocusOut;delete a._onKeyboardFocusOut;this.detachEvent("onfocusout",c);delete a._elt;delete a._isKeyboardHandlerAttached;return}g.call(this,b,a)}a.attachEvent=b;a.detachEvent=c;a.HTMLDocument.prototype.attachEvent=b;a.HTMLDocument.prototype.detachEvent=c;a.HTMLElement.prototype.attachEvent=b;a.HTMLElement.prototype.detachEvent=c};CompatExtension.load("c_keyevent",window);History={};History.addNavigationStep=function History$addNavigationStep(a){History._addNavigationStepImpl(a)};History._addNavigationStepImpl=function History$_addNavigationStepImpl(){};History.stateChanged=function History$stateChanged(a){var b=History._deserializeState(a);History.isOnNavigateFiring=true;History.fireEvent("onnavigate",[b]);History.isOnNavigateFiring=false};History.getSerializedState=function History$getSerializedState(){return History._getSerializedStateImpl()};History._getSerializedStateImpl=function History$_getSerializedStateImpl(){};History._serializeState=function History$_serializeState(c){var a=[];for(var b in c)a.push(History.NAME_VALUE_DELIMITER,encodeURIComponent(b),History.NAME_VALUE_DELIMITER,encodeURIComponent(c[b]));if(a.length!=0)a[0]="";return a.join("")};History._deserializeState=function History$_deserializeState(b){var d={};if(b==""||b==null)return d;var c=b.split(History.NAME_VALUE_DELIMITER);for(var a=c.length-1;a>0;a=a-2)d[decodeURIComponent(c[a-1])]=decodeURIComponent(c[a]);return d};History.isOnNavigateFiring=false;History.NAME_VALUE_DELIMITER="/";Events.addEventing(History);__classes["History"]=History;History._addNavigationStepImpl=function History$iframe$_addNavigationStepImpl(e){History._isSavingState=true;var b=null,c=null,a=null;try{if(null!=(b=$(History.historyFrameId))&&null!=(c=b.contentWindow)&&null!=(a=c.document)&&(a.readyState===undefined||"complete"==a.readyState)){var d=History._serializeState(e);History._navigateIframe(a,d)}else History._isSavingState=false}catch(f){History._isSavingState=false}};History._getSerializedStateImpl=function History$iframe$_getSerializedStateImpl(){return $(History.historyFrameId).contentWindow.stateStr};History._navigateIframe=function History$iframe$_navigateIframe(a,b){a.open("javascript:'<html></html>'");a.write(['<html><head><script>function Init(){window.stateStr="',b,"\"; if(parent.History && parent.History.stateChanged) {if(!parent.History._isSavingState){parent.History.stateChanged(window.stateStr);}}}</script></head><body onload='Init()'></body></html>"].join(""));a.close();History._isSavingState=false};History._isSavingState=false;History.historyFrameId="historyFrame";History._navigateIframe=function History$iframe$hotmail$_navigateIframe(a,c){if(""==History._domain)History._getDomain();var b=InboxPage.Config.isPfDown?"":['document.domain="',History._domain,'";'].join("");a.open("javascript:'<html></html>'");a.write(["<html><head><script>function Init(){",b,'window.stateStr="',c,"\"; if(parent.History && parent.History.stateChanged) {if(!parent.History._isSavingState){parent.History.stateChanged(window.stateStr);}}}</script></head><body onload='Init()'></body></html>"].join(""));a.close();History._isSavingState=false};if(Browser.isFF2)History._navigateIframe=function History$FF2$iframe$hotmail$_navigateIframe(a,b){a.location.href=a.location.pathname+a.location.search+"#"+b};History._getDomain=function History$iframe$hotmail$_getDomain(){var a=window.location.hostname,c=a.lastIndexOf(".",a.length),d=a.lastIndexOf(".",c-1),b=a.substr(d+1).toLowerCase();if("live.com"==b||"live-int.com"==b)History._domain=b;else History._domain=window.location.hostname};History._domain="";FolderListHelper={};FolderListHelper.getFolderCount=function FolderListHelper$getFolderCount(b){var a=$(b);return parseInt(a.getAttribute("count"))};FolderListHelper.setFolderCount=function FolderListHelper$setFolderCount(d,b){if(typeof InboxPage!="undefined"&&InboxPage)if(d==InboxPage.Config.sysFldrs.searchFid)return;var a=$(d),e=$tag(a,"a")[0];if(FolderListHelper.getFolderCount(d)==b)return;var c=$tag(a,"span");if(b>0){c[1].style.display="inline";$addClass(a,"BoldText")}else{$setDisplay(c[1],false);$removeClass(a,"BoldText")}c[2].innerText=b;e.title=e.innerText;a.setAttribute("count",b)};Type.createStaticClass(FolderListHelper,"FolderListHelper");HM.SortBy=Web.Flags.create("Sender",0,"Subject",1,"Size",2,"Type",3,"Date",4);HM.registerFppClass("InboxUiData",[Web.Network.FppProxy.__string("FolderListHtml"),Web.Network.FppProxy.__string("MessageListHtml"),Web.Network.FppProxy.__string("MessageHtml"),Web.Network.FppProxy.__string("InfoPaneHtml"),Web.Network.FppProxy.__string("RedirectUrl")]);HM.registerFppClass("HmAuxData",[Web.Network.FppProxy.__string("Value")]);HM.registerFppClass("MessageRenderingInfo",[Web.Network.FppProxy.__string("MessageId"),Web.Network.FppProxy.__string("FolderId"),Web.Network.FppProxy.__primitive("OpenMessageBody"),Web.Network.FppProxy.__primitive("AllowUnsafeContent"),Web.Network.FppProxy.__primitive("OverrideCodepage"),Web.Network.FppProxy.__string("MtLang"),Web.Network.FppProxy.__custom(HM.HmAuxData,"AuxData"),Web.Network.FppProxy.__enum("SortKey"),Web.Network.FppProxy.__primitive("SortAsc"),Web.Network.FppProxy.__enum("Action"),Web.Network.FppProxy.__primitive("MarkAsRead")]);HM.ListNavigateDirection=Web.Flags.create("FirstPage",0,"LastPage",1,"NextPage",2,"PreviousPage",3,"CurrentPage",4);HM.ReadingPaneLocation=Web.Flags.create("None",0,"Off",1,"Right",2,"Bottom",3);HM.registerFppClass("MessageListRenderingInfo",[Web.Network.FppProxy.__string("FolderId"),Web.Network.FppProxy.__enum("PageDirection"),Web.Network.FppProxy.__primitive("PageSkip"),Web.Network.FppProxy.__enum("SortKey"),Web.Network.FppProxy.__primitive("SortAsc"),Web.Network.FppProxy.__string("AnchorMessageId"),Web.Network.FppProxy.__string("AnchorMessageDate"),Web.Network.FppProxy.__primitive("PageNumCurrent"),Web.Network.FppProxy.__primitive("PageNumMidStart"),Web.Network.FppProxy.__primitive("IsSearchResults"),Web.Network.FppProxy.__string("SearchKeyword"),Web.Network.FppProxy.__primitive("MessageCount"),Web.Network.FppProxy.__primitive("AutoSelectMessageIndex"),Web.Network.FppProxy.__enum("ReadingPaneLocation")]);HM.registerFppMethod("GetInboxData",[Web.Network.FppProxy.__primitive("fetchFolderList"),Web.Network.FppProxy.__primitive("renderUrlsInFolderList"),Web.Network.FppProxy.__primitive("fetchMessageList"),Web.Network.FppProxy.__custom("messageListRenderingInfo"),Web.Network.FppProxy.__primitive("fetchMessage"),Web.Network.FppProxy.__custom("messageRenderingInfo")],"GetInboxData",Web.Network.Type.XMLPost,"abortable","Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.registerFppMethod("ClearFolder",[Web.Network.FppProxy.__string("clearFolderId"),Web.Network.FppProxy.__custom("messageListRenderingInfo")],"ClearFolder",Web.Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.JmrType=Web.Flags.create("Junk",0,"NotJunk",1,"AV",2,"SVMOptInOptOut",3,"SVMClassification",4,"Phish",5,"Unsubscribe",6,"Unknown",-1);HM.registerFppMethod("MoveMessagesToFolder",[Web.Network.FppProxy.__string("fromFolderId"),Web.Network.FppProxy.__string("toFolderId"),Web.Network.FppProxy.__array("messageList"),Web.Network.FppProxy.__array("messageAuxData"),Web.Network.FppProxy.__custom("messageListRenderingInfo")],"MoveMessagesToFolder",Web.Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.registerFppMethod("MarkMessagesForJmr",[Web.Network.FppProxy.__string("folderId"),Web.Network.FppProxy.__array("messages"),Web.Network.FppProxy.__array("auxData"),Web.Network.FppProxy.__enum("jmrType"),Web.Network.FppProxy.__primitive("setReportToJunkOK"),Web.Network.FppProxy.__custom("messageListRenderingInfo"),Web.Network.FppProxy.__custom("messageRenderingInfo")],"MarkMessagesForJmr",Web.Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.ReadMessageOperation=Web.Flags.create("GetMessage",0,"MarkAsNotJunk",1,"Unsubscribe",2,"AddContact",3,"None",4);HM.registerFppClass("__2",[Web.Network.FppProxy.__primitive("IsBlocking"),Web.Network.FppProxy.__primitive("YesCode"),Web.Network.FppProxy.__primitive("NoCode"),Web.Network.FppProxy.__string("Message")]);HM.registerFppMethod("AddContactFromMessage",[Web.Network.FppProxy.__custom("messageRenderingInfo"),Web.Network.FppProxy.__string("contactName"),Web.Network.FppProxy.__string("contactEmail")],"AddContactFromMessage",Web.Network.Type.XMLPost,"abortable","Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.registerFppMethod("SvmFeedback",[Web.Network.FppProxy.__string("svmUrl"),Web.Network.FppProxy.__custom("messageRenderingInfo"),Web.Network.FppProxy.__custom("messageListRenderingInfo")],"SvmFeedback",Web.Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.registerFppMethod("MarkMessagesReadState",[Web.Network.FppProxy.__primitive("readState"),Web.Network.FppProxy.__array("messages"),Web.Network.FppProxy.__array("messageAuxData"),Web.Network.FppProxy.__custom("messageListRenderingInfo")],"MarkMessagesReadState",Web.Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.registerFppMethod("SaveVoicemailOnPhone",[Web.Network.FppProxy.__array("messageIdList")],"SaveVoicemailOnPhone",Web.Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");HM.registerFppMethod("DeleteVoicemailOnPhone",[Web.Network.FppProxy.__array("messageIdList")],"DeleteVoicemailOnPhone",Web.Network.Type.XMLPost,null,"Microsoft.Msn.Hotmail.Ui.Fpp.MailBox");window.InboxServices={};Events.addEventing(InboxServices);InboxServices._endUpdateUi=function InboxServices$_endUpdateUi(a){InboxServices.fireEvent("endUpdateUi",[a])};InboxServices.beginRefreshInbox=function InboxServices$beginRefreshInbox(e,f,a,d,c,g,b){if(!b)b=InboxServices._endRefreshInbox;if(a!=null&&a.SearchKeyword!=null)a.SearchKeyword=a.SearchKeyword.replace('"',"&quot;");HM.GetInboxData(e,false,f,a,d,c,b,{showMl:g})};InboxServices._endRefreshInbox=function InboxServices$_endRefreshInbox(c,a,b){InboxServices._endUpdateUi(c,a,b);if(a.showMl)InboxPage.showFullReadingPane(false)};InboxServices.beginClearFolder=function InboxServices$beginClearFolder(b,a){HM.ClearFolder(b,a,InboxServices._endUpdateUi)};InboxServices.beginMarkMessages=function InboxServices$beginMarkMessages(a,d,b,c){if(a.length==0)return;HM.MarkMessagesReadState(b,a,d,c,InboxServices._endMarkMessages,{messages:a,asRead:b})};InboxServices._endMarkMessages=function InboxServices$_endMarkMessages(c,a,b){InboxServices._endUpdateUi(c,a,b);InboxPage.messageList.markMessages(a.messages,a.asRead)};InboxServices.beginMoveMessages=function InboxServices$beginMoveMessages(c,f,a,b,d){if(0==c.length)return;if(a!=InboxPage.Config.sysFldrs.trashFid&&a==b)return;if(a==InboxPage.Config.sysFldrs.noneFid)return;var e=InboxPage.messageList.getUnreadCount(c);HM.MoveMessagesToFolder(a,b,c,f,d,InboxServices._endMoveMessages,{unreadCount:e,fromFid:a,toFid:b,perfRecorderTimerName:InboxPage.postProcData.perfRecorderTimerName})};InboxServices._endMoveMessages=function InboxServices$_endMoveMessages(i,c){InboxServices._endUpdateUi(i);InboxPage.postProcData.perfRecorderTimerName=c.perfRecorderTimerName;var d=c.unreadCount;if(d>0){var e=InboxPage.Config.sysFldrs.trashFid,f=InboxPage.Config.sysFldrs.junkFid,j=InboxPage.folderList,a=c.fromFid,g=FolderListHelper.getFolderCount(a)-d,b=c.toFid;if(!InboxPage.folderList.isSrch)FolderListHelper.setFolderCount(a,g);if(!((b==f||b==e)&&(a==f||a==e))){var h=FolderListHelper.getFolderCount(b)+d;FolderListHelper.setFolderCount(b,h)}}};InboxServices.beginGetMessageListPage=function InboxServices$beginGetMessageListPage(d,e,a,c,b){if(a!=null&&a.SearchKeyword!=null)a.SearchKeyword=a.SearchKeyword.replace('"',"&quot;");HM.GetInboxData(d,false,e,a,c,b,InboxServices._endGetMessageListPage,{},InboxServices._endGetMessageListPageError)};InboxServices._endGetMessageListPage=function InboxServices$_endGetMessageListPage(c,a,b){InboxServices._endUpdateUi(c,a,b);InboxServices.fireEvent("endGetMessageListPage",[])};InboxServices._endGetMessageListPageError=function InboxServices$_endGetMessageListPageError(){InboxServices.fireEvent("endGetMessageListPage",[])};InboxServices.setJunkStatus=function InboxServices$setJunkStatus(a,h,c,f,b,d,e){if(a.length==0)return;var g=InboxPage.messageList.getUnreadCount(a);HM.MarkMessagesForJmr(c,a,h,b,f,d,e,InboxServices._endSetJunkStatus,{jmrType:b,unreadCount:g,fid:c,perfRecorderTimerName:InboxPage.postProcData.perfRecorderTimerName})};InboxServices._endSetJunkStatus=function InboxServices$_endSetJunkStatus(k,b,j){InboxServices._endUpdateUi(k,b,j);InboxPage.postProcData.perfRecorderTimerName=b.perfRecorderTimerName;if(HM.JmrType.Unsubscribe==b.jmrType||HM.JmrType.Junk==b.jmrType||HM.JmrType.Phish==b.jmrType)InboxPage.Config.hasSeenReportUi=true;var f=b.unreadCount;if(f>0){var g=InboxPage.Config.sysFldrs.trashFid,c=b.fid,l=InboxPage.folderList,h=FolderListHelper.getFolderCount(c)-f,d=b.jmrType,e=InboxPage.Config.sysFldrs.junkFid,a="";if(HM.JmrType.NotJunk==d)a=e!=c?c:InboxPage.Config.sysFldrs.inboxFid;else if(HM.JmrType.Junk==d)a=e;else if(HM.JmrType.Unsubscribe==d)a=c;else a=g;FolderListHelper.setFolderCount(c,h);if(!((a==e||a==g)&&(c==e||c==g&&HM.JmrType.Phish==d))){var i=FolderListHelper.getFolderCount(a)+f;FolderListHelper.setFolderCount(a,i)}}};InboxServices.addContactFromMessage=function InboxServices$addContactFromMessage(c,b,a){HM.AddContactFromMessage(a,c,b,InboxServices._endUpdateUi)};InboxServices.deleteVMFromPhone=function InboxServices$deleteVMFromPhone(a){HM.DeleteVoicemailOnPhone([a],null)};InboxServices.markVMAsSaved=function InboxServices$markVMAsSaved(a){HM.SaveVoicemailOnPhone([a],null)};InboxServices.beginSvmFeedback=function InboxServices$beginSvmFeedback(c,b,a){HM.SvmFeedback(c,b,a,InboxServices._endUpdateUi)};var Safety={};Safety.markAsJunk=function Safety$markAsJunk(c,d,e){InboxPage.postProcData.history=false;var a=false,b=false;if(!InboxPage.Config.hasSeenReportUi){b=!Safety._showReportingQuestionUi(Page.decode(InboxPage.Strings.allowJunkReportingQuestion));if(b)return;a=true}Safety._setJunkStatus(c,d,e,a,HM.JmrType.Junk,true,null)};Safety.markAsNotJunk=function Safety$markAsNotJunk(d,e,b,c){InboxPage.postProcData.history=false;var a=null;if(c&&b!=InboxPage.Config.sysFldrs.junkFid){a=InboxPage.createMessageRenderingInfo(true);a.AuxData=null;a.Action=HM.ReadMessageOperation.MarkAsNotJunk}Safety._setJunkStatus(d,e,b,false,HM.JmrType.NotJunk,true,a)};Safety.markAsPhish=function Safety$markAsPhish(c,d,e){InboxPage.postProcData.history=false;var a=false,b=false;if(!InboxPage.Config.hasSeenReportUi){b=!Safety._showReportingQuestionUi(Page.decode(InboxPage.Strings.allowJunkReportingQuestion));if(b)return;a=true}Safety._setJunkStatus(c,d,e,a,HM.JmrType.Phish,true,null)};Safety.markAsUnsubscribe=function Safety$markAsUnsubscribe(e,f,g){InboxPage.postProcData.history=false;var c=false,d=false;if(!InboxPage.Config.hasSeenReportUi){d=!Safety._showReportingQuestionUi(Page.decode(InboxPage.Strings.unsubscribeText));if(d)return;c=true}var b=InboxPage.createMessageRenderingInfo(true);b.Action=HM.ReadMessageOperation.Unsubscribe;Safety._setJunkStatus(e,f,g,c,HM.JmrType.Unsubscribe,false,b);var a=InboxPage.readingPane.unsubscribeUrl;if(null!=a&&""!=a)window.open(a)};Safety._showReportingQuestionUi=function Safety$_showReportingQuestionUi(a){return confirm(a)};Safety._setJunkStatus=function Safety$_setJunkStatus(c,h,d,g,b,f,e){var a=InboxPage.createMessageListRenderingInfo(true);if(!(b==HM.JmrType.Unsubscribe||b==HM.JmrType.NotJunk&&d!=InboxPage.Config.sysFldrs.junkFid))a.MessageCount-=c.length;if(f)InboxPage.configureAutoSelect(a);InboxServices.setJunkStatus(c,h,d,g,b,a,e)};Type.createStaticClass(Safety,"Safety");var Messages={};Messages.markAsReadUnread=function Messages$markAsUnread(a,d,c){InboxPage.postProcData.history=false;InboxPage.postProcData.ads=false;for(var b=a.length-1;b>=0;b--){msg=$(a[b]);var e=!$containsClass(msg,"InboxContentItemUnread");if(e==c){a.splice(b,1);d.splice(b,1)}}if(0==a.length)return;InboxServices.beginMarkMessages(a,d,c,InboxPage.createMessageListRenderingInfo(true))};Messages.remove=function Messages$remove(b,a){Messages.move(b,a,InboxPage.folderList.fid,InboxPage.Config.sysFldrs.trashFid)};Messages.move=function Messages$move(b,e,c,d){InboxPage.postProcData.history=false;var a=InboxPage.createMessageListRenderingInfo(true);InboxPage.configureAutoSelect(a);a.MessageCount-=b.length;InboxServices.beginMoveMessages(b,e,c,d,a)};Messages.print=function Messages$print(a,d){if(a&&a.length>0){var b=[];for(var c=a.length-1;c>=0;c--){b.push(a[c]);b.push("-1")}var e="PrintShell.aspx?type=message&cpids="+b.join(",")+"&isSafe="+d;window.open(e,"","width=600px,height=400px,menubar=no,location=no,toolbar=no,resizable=yes,scrollbars=yes")}InboxPage.postProcData.history=false;InboxPage.postProcData.ads=false};Type.createStaticClass(Messages,"Messages");var ButtonList=function ButtonList(c){Control.create(this,c);this._buttons={};this._keys=[];this._data={};this._enabled=false;Events.init(this);var b=$tag(c,"li"),f=b.length;for(var a=0;a<f;a++){if(b[a].className=="Divider")continue;var e=b[a].getAttribute("key");this.initializeButton(b[a],e)}var d=c.getAttribute("enabled")=="true";this.setEnabled(d)};ButtonList.prototype={elt:null,userdata:null,_buttons:null,_keys:null,_data:null,initializeButton:function ButtonList$initializeButton(b,a){this._keys.add(a);this._buttons[a]=b;this._data[a]=b.getAttribute("data")},_enabled:true,getEnabled:function ButtonList$getEnabled(){return this._enabled},setEnabled:function ButtonList$setEnabled(a){if(a==this._enabled)return;if(a)$replaceClass(this.elt,"Disabled","Enabled");else $replaceClass(this.elt,"Enabled","Disabled");this.elt.setAttribute("enabled",a.toString());this._enabled=a},forEach:function ButtonList$forEach(c,d){var e=this._keys.length;for(var a=0;a<e;a++){var b=this._keys[a];c(this,{button:this._buttons[b],idx:a,key:b,context:d})}},clear:function ButtonList$clear(){this._buttons={};this._keys=[];this._data={};var a=$tag(this.elt,"UL")[0];a.innerHTML=""},count:function ButtonList$count(){return this._keys.length},containsButtonKey:function ButtonList$containsButtonKey(a){return this._keys.contains(a)},getButtonProperty:function ButtonList$getButtonElt(b,c){var a=this._buttons[b];switch(c){case "elt":return a;case "enabled":return !$containsClass(a,"Disabled");case "visible":return $getDisplay(a);case "text":return $tag(a,"SPAN")[0].innerText;case "selected":return $containsClass(a,"Selected");case "html":return $tag(a,"SPAN")[0].innerHTML;case "data":return this._data[b]}},setButtonProperty:function ButtonList$setButtonProperty(c,d,b){var a=this._buttons[c];switch(d){case "enabled":if(b)$removeClass(a,"Disabled");else $addClass(a,"Disabled");break;case "selected":if(b)$addClass(a,"Selected");else $removeClass(a,"Selected");break;case "visible":$setDisplay(a,b);break;case "text":$tag(a,"SPAN")[0].innerText=b;break;case "html":$tag(a,"SPAN")[0].innerHTML=b;break;case "data":this._data[c]=b}},dispose:function ButtonList$dispose(){this.userdata=null;Control.destroy(this)},_buttonOnClick:function ButtonList$_buttonOnClick(a){if(!a)return;var b={button:Control.getAncestorByAttr(event.srcElement,"key"),key:a,data:this._data[a]};if(this._enabled&&this.getButtonProperty(a,"enabled"))this.fireEvent("onbuttonclick",[this,b])}};ButtonList.prototype.addButton=function ButtonList$addButton(c){this._buttons={};this._keys=[];var d=$tag(this.elt,"UL")[0];d.innerHTML+=this.getButtonHTML(c);var b=$tag(d,"LI"),f=b.length;for(var a=0;a<f;a++){if(b[a].className=="Divider")continue;var e=b[a].getAttribute("key");this._keys.add(e);this._buttons[e]=b[a]}this._data[c.key]=c.data};Events.addEventing(ButtonList);ButtonList.createClass("ButtonList");var Menu=function Menu(b,a){ButtonList.call(this,b);this.setEnabled(true);this.owner=a;this._focusHandler=Delegate.create(this,this._focusOut);this.elt.attachEvent("onfocusout",this._focusHandler);this._keyDownHandler=Delegate.create(this,this._keyDown);this.elt.attachEvent("onkeydown",this._keyDownHandler);this.hide()};Menu.prototype={owner:null,_focusHandler:null,dispose:function Menu$dispose(){this.hide();if(this.owner!=null){this.fireEvent("ondispose",[this]);this.elt.detachEvent("onfocusout",this._focusHandler);this.owner=null;this.callBase(ButtonList,"dispose")}},_keyDown:function Menu$keyDown(){this._lastKey=event.keyCode},_focusOut:function Menu$onFocusOut(){if(!this.elt.contains(event.toElement)&&this.elt!=event.toElement){if(this._lastKey==9&&this.owner&&this.owner.focus)$callFocus(this.owner);this.dispose()}},getButtonHTML:function Menu$getButtonHTML(a){return String.format(Menu._BUTTON_HTML,a.key,a.caption||"",a.tooltip||"")},focus:function Menu$focus(){if(this._keys.length>0){var a=null;this.forEach(function(c,b){if(!a&&c.getButtonProperty(b.key,"visible"))a=$tag(c.getButtonProperty(b.key,"elt"),"A")[0]});if(a)$callFocus(a)}},_selected:null,getSelectedButton:function Menu$getSelectedButton(){return this._selected},setSelectedButton:function Menu$setSelectedButton(a){if(this._selected)this.setButtonProperty(this._selected,"selected",false);if(a)this.setButtonProperty(a,"selected",true)},reposition:function Menu$reposition(a){AlignBehavior.DropDown(this.elt,this.owner,a)},show:function Menu$show(a){$setDisplay(this.elt,true);this.reposition(a)},hide:function Menu$hide(){if(this.elt!=null)$setDisplay(this.elt,false)},_buttonOnClick:function Menu$_buttonOnClick(a){this.callBase(ButtonList,"_buttonOnClick",[a]);this.dispose()},getButtonHTML:function ButtonList$getButtonHTML(a){return Menu.CreateButtonHTML(a)}};if(Browser.isIE6){var oldShow=Menu.prototype.show;Menu.prototype.show=function Menu$show(b){oldShow.call(this,b);var a=this;setTimeout(function(){var b=$tag(a.elt,"DIV");b[b.length-1].style.height=$tag(a.elt,"UL")[0].offsetHeight+"px"},0)}}Menu._BUTTON_HTML='<li key="{0}"><a unselectable=on href="javascript:;" onclick="event.returnValue=false;" title="{2}">{1}</a></li>';Menu._DIVIDIER_HTML='<li class="Divider"><div></div></li>';Menu.CreateButtonHTML=function Menu$CreateButtonHTML(a){if(a.caption=="-")return Menu._DIVIDIER_HTML;return String.format(Menu._BUTTON_HTML,a.key,a.caption||"",a.tooltip||a.caption||"")};Menu.CreateMenuHTML=function Menu$CreateMenuHTML(c){var b=['<div onclick="return Control.invoke(\'Menu\', \'_buttonOnClick\', event, Control.lookup(event.srcElement, \'key\'));" enabled="false" class="Menu c_m Disabled" style="display: none;"><ul>'],d=c.length;for(var a=0;a<d;a++)b[a+1]=Menu.CreateButtonHTML(c[a]);b[d+1]='</ul><div class="shadow"></div></div>';return b.join("")};Menu.Create=function Menu$Create(b){var a=document.createElement("div");document.body.appendChild(a);a.innerHTML=Menu.CreateMenuHTML(b||[]);a=a.firstChild;return a};Menu.Destroy=function Menu$Destroy(a){document.body.removeChild(a.parentElement)};Menu.createClass("Menu",ButtonList);var AlignBehavior={};AlignBehavior.DropDown=function AlignBehavior$DropDown(c,g,i){var d=$getLocation(g,i),f=d.left;if(document.documentElement.dir=="rtl")f=d.right-c.offsetWidth;var a={x:f,y:d.bottom},b=a.x+c.offsetWidth-document.body.offsetWidth;a.x=b>0?a.x-b:a.x;if(document.documentElement.dir=="rtl")a.x=a.x<0?0:a.x;var h=a.x,e=0;if(Browser.isSF){b=a.y+c.offsetHeight-document.body.offsetHeight;e=(b>0?a.y-b:a.y)+document.body.scrollTop}else{b=a.y-document.getElementsByTagName("HTML")[0].scrollTop+c.offsetHeight-document.body.offsetHeight;e=b>0?a.y-b:a.y}c.style.left=h+"px";c.style.top=e+"px"};function MessageList(a){Control.create(this,a);this._setStateFromDom();this._menu=new Menu($("contextMenu"));this._menu.attachEvent("onbuttonclick",Delegate.create(this,this._handleMenuItem));a.attachEvent("oncontextmenu",Delegate.create(this,this._handleMenu));InboxServices.attachEvent("endGetMessageListPage",Delegate.create(this,this._endGetMessageListPage))}__p=MessageList.prototype={};__p.sBy="Date";__p.sAsc=false;__p.pDir=HM.ListNavigateDirection.FirstPage;__p.pSkip=0;__p.aMid="";__p.pCur=1;__p.pMid=1;__p.mCt=0;__p.aDate="";__p.big=false;__p.srch=false;__p._selection=[];__p._shiftClickPivot=-1;__p._shiftClickPivotAction=true;__p._sorted=false;__p.dispose=function MessageList$dispose(){Control.destroy(this)};__p._setStateFromDom=function MessageList$_setStateFromDom(){var a=$tag(this.elt,"div");if(null==a||a.length==0)return;a=a[0];this.sBy=a.getAttribute("sBy");this.sAsc=a.getAttribute("sAsc");this.pDir=a.getAttribute("pDir");this.pSkip=a.getAttribute("pSkip");this.aMid=a.getAttribute("aMid");this.aDate=a.getAttribute("aDate");this.pCur=a.getAttribute("pCur");this.pMid=a.getAttribute("pMid");this.mCt=a.getAttribute("mCt");this.big=a.getAttribute("big");this.srch=a.getAttribute("srch");this.sAsc=this.sAsc=="1";if(this.getCheckedCount()>0)this._refreshSelectionFromChecks();else{this._selection=[];var b=a.getAttribute("sel");b=parseInt(b);if(-1!=b){this._selection.push(b);this._ensureVisible(this._getMessageListItems()[b])}this._shiftClickPivot=b}$("msgChkAll").checked=false;InboxPage.postProcData.uiUpdate=true};__p.setHTML=function MessageList$setHTML(a){this.elt.innerHTML=a;this._setStateFromDom();if(!InboxPage.isReadingPaneOn)InboxPage.resetContentHeight($("messageListContentContainer"))};__p.getCount=function MessageList$getCount(){return parseInt(this.mCt)};__p.hide=function MessageList$hide(){$addClass($("messageListSplitPane"),"MessageListSplitPaneHidden");$addClass($("sortSearchContainer"),"SortSearchContainerHidden")};__p.show=function MessageList$show(){InboxPage.isReadMessageMode=false;if(!InboxPage.isReadingPaneOn)this.clearSelection();$removeClass($("messageListSplitPane"),"MessageListSplitPaneHidden");$removeClass($("sortSearchContainer"),"SortSearchContainerHidden")};__p.sort=function MessageList$sort(b){if(this.big){InboxPage.doPostProc=false;alert(Page.decode(InboxPage.Strings.cannotSortBigInbox));return}else if(this.srch){InboxPage.doPostProc=false;alert(Page.decode(InboxPage.Strings.cannotSortSearch));return}this._sorted=true;var a=InboxPage.createMessageListRenderingInfo(false);a.FolderId=InboxPage.folderList.fid;a.SortKey=b;a.SortAsc=this.sBy==b?!this.sAsc:HM.SortBy[b]!=HM.SortBy.Date;a.MessageCount=this.mCt;InboxPage.postProcData.psValue=InboxPage.Ps.readMessage;InboxPage.postProcData.perfRecorderTimerName="SO";InboxPage.beginRefreshInbox(true,true,a,false,null)};__p.search=function MessageList$search(b){var a=InboxPage.createMessageListRenderingInfo(false);a.SortKey=this.sBy;a.SortAsc=this.sAsc;a.IsSearchResults=true;a.SearchKeyword=b;InboxPage.beginRefreshInbox(true,true,a,false,null);InboxPage.postProcData.psValue=InboxPage.Ps.searchResults};__p._onBodyClick=function MessageList$_onBodyClick(){if("msgChk"==event.srcElement.name||"msgChkCell"==event.srcElement.getAttribute("name")){this._onCheckMessageClick(event);InboxPage.doPostProc=false;return true}else if(null!=event.srcElement.getAttribute("noOp")){InboxPage.doPostProc=false;return true}var b=this._getTextSelection(event.srcElement);if(null!=b&&0!=b.length)return;var a=Control.getAncestorByAttr(event.srcElement,"msg");if(null==a){InboxPage.doPostProc=false;return true}if(event.shiftKey||event.ctrlKey){window.open(String.format("{0}?Aux={1}&ReadMessageId={2}&n={3}{4}",Page.SELF_PATH,a.getAttribute("mad"),a.id,Math.floor(1+Math.random()*200),InboxPage.folderList.isSrch?"":String.format("&FolderID={0}",InboxPage.folderList.fid)));if(!Browser.isFF)event.returnValue=false;else event.cancelBubble=true;InboxPage.doPostProc=false;return true}if(InboxPage.isReadingPaneOn&&InboxPage.readingPane.mode==ReadingPane.MESSAGE_MODE&&InboxPage.readingPane.mid==a.id){InboxPage.doPostProc=false;return}this.selectByElem(a,true,-1,true);this._shiftClickPivot=this._getMessageListEltIndex(a);this._shiftClickPivotAction=true;InboxPage.postProcData.perfRecorderTimerName="R";this._openMessageByElt(a)};__p._onDblClick=function MessageList$_onDblClick(){if(!InboxPage.isReadingPaneOn)return;var a=InboxPage.readingPane;if(a.mode==ReadingPane.MESSAGE_MODE){a.doubleClicked=true;if(a.setHTMLed)a.onFullViewClick()}};__p._onNavClick=function MessageList$_onNavClick(){var a=Control.getAncestorByAttr(event.srcElement,"pnCur");if(null==a){InboxPage.doPostProc=false;return}InboxPage.postProcData.perfRecorderTimerName="PG";InboxPage.postProcData.psValue=InboxPage.Ps.mailFolders;this._openPageByElt(a)};__p._getTextSelection=function MessageList$_getTextSelection(d){var a="";if(window.getSelection){if(window.getSelection().rangeCount>0){var b=window.getSelection().getRangeAt(0);a=d!=b.commonAncestorContainer.parentNode?"":b.toString()}}else if(document.getSelection)a=document.getSelection();else if(document.selection){var b=document.selection.createRange(),c=b.parentElement();a=null!=c&&d!=c?"":b.text}return a};__p._openMessageByElt=function MessageList$_openMessageByElt(a,b,c){var e=a.id,d=a.getAttribute("mad"),f=a.getAttribute("vm");if(b)this._ensureVisible(a);this._openMessage(e,d,f,c)};__p._openMessage=function MessageList$_openMessage(d,c,b){var a=InboxPage.createMessageRenderingInfo(false);a.MessageId=d;a.FolderId=InboxPage.folderList.fid;a.AuxData=InboxPage.createMessageAuxData(c);a.SortKey=this.sBy;a.SortAsc=this.sAsc;a.Action=HM.ReadMessageOperation.None;a.MarkAsRead="vm"!=b;if(b)a.AuxData=null;InboxPage.beginRefreshInbox(false,false,null,true,a)};__p._openPageByElt=function MessageList$_openPageByElt(b,c,d){if(d&&this._getMessageListPageWorking)return;this._getMessageListPageWorking=true;var f=b.getAttribute("pnCur"),j=b.getAttribute("pnAm"),i=b.getAttribute("pnAd"),g=b.getAttribute("pnDir"),h=b.getAttribute("pnMid"),e=b.getAttribute("pnSkip"),a=InboxPage.createMessageListRenderingInfo(true);a.PageDirection=g;a.PageSkip=e;a.AnchorMessageId=j;a.AnchorMessageDate=i;a.PageNumCurrent=f;a.PageNumMidStart=h;if(null!=c)a.AutoSelectMessageIndex=c;InboxServices.beginGetMessageListPage(true,true,a,false,null)};__p._endGetMessageListPage=function MessageList$_endGetMessageListPage(){this._getMessageListPageWorking=false};__p.next=function MessageList$next(e){var d=this._selection,c=0==d.length?0:d[0]+1,b=this.selectByIndex(c,true,true);this._shiftClickPivot=c;this._shiftClickPivotAction=true;if(!b){var a=$("nextPageLink");if(a)this._openPageByElt(a,0)}else this._openMessageByElt(b,true,e)};__p.previous=function MessageList$previous(e){var d=this._selection;if(0==d.length)return;var c=d[0]-1,b=this.selectByIndex(c,true,true);this._shiftClickPivot=c;this._shiftClickPivotAction=true;if(!b){var a=$("prevPageLink");if(a)this._openPageByElt(a,InboxPage.Config.pageSize-1)}else this._openMessageByElt(b,true,e)};__p._ensureVisible=function MessageList$_ensureVisible(a){$scrollIntoView(a,this.elt.children[0].children[0].children[0])};__p.updateSortMenu=function MessageList$updateSortMenu(){var i=$("sortMenu"),f=$("SortByDate"),c=$("SortBySender"),e=$("SortBySubject"),g=$("SortBySize"),d=InboxPage.Config.sysFldrs.sentFid==InboxPage.folderList.fid||InboxPage.Config.sysFldrs.draftsFid==InboxPage.folderList.fid,h=$tag($tag(i,"A")[0],"SPAN")[0],j="Sender"!=this.sBy?this.sBy:d?"To":"From";if(this._sorted)h.innerHTML=String.format(Page.decode(InboxPage.Strings.sortByCaption),Page.decode(InboxPage.Strings.sortBy[j]));$tag(c,"SPAN")[0].innerHTML=Page.decode(InboxPage.Strings.sortBy[d?"To":"From"]);c.title=String.format(Page.decode(InboxPage.Strings.sortByCaption),Page.decode(InboxPage.Strings.sortBy[d?"To":"From"]));var a="sel";$removeClass(f,a);$removeClass(c,a);$removeClass(e,a);$removeClass(g,a);$addClass($("SortBy"+this.sBy),a);var b="clear";$tag(f,"IMG")[0].className=b;$tag(c,"IMG")[0].className=b;$tag(e,"IMG")[0].className=b;$tag(g,"IMG")[0].className=b;$tag($("SortBy"+this.sBy),"IMG")[0].className=this.sAsc?"ascend_rest_dark":"descend_rest_dark"};__p.markMessages=function MessageList$markMessages(e,f){var c=false,b="InboxContentItemUnread";for(var d=e.length-1;d>=0;d--){var a=$(e[d]);if(a)if($containsClass(a,b)&&f){$removeClass(a,b);var g=a.children[1].children[0];this._updateMessageIcon(g,"i_read",Page.decode(InboxPage.Strings.readMsgText));c=true}else if(!$containsClass(a,b)&&!f){$addClass(a,b);var g=a.children[1].children[0];this._updateMessageIcon(g,"i_new",Page.decode(InboxPage.Strings.unreadMsgText));c=true}}return c};__p._updateMessageIcon=function MessageList$_updateMessageIcon(a,c,b){a.className=c;a.alt=b;a.title=b};__p.isRead=function MessageList$isRead(a){return !$containsClass($(a),"InboxContentItemUnread")};__p.getUnreadCount=function MessageList$getUnreadCount(c){var b=0;for(var a=c.length-1;a>=0;a--)if(!this.isRead(c[a]))b++;return b};__p.removeVMOnPhoneStatus=function MessageList$removeVMOnPhoneStatus(){var d=this._getMessageListItems()[this.getSelectionIndex()],a=$tag(d,"TD"),c=3==a.length,b=c?$tag($tag(a[1],"DIV")[0],"IMG"):$tag(a[4],"IMG");if(2==b.length)$setDisplay(b[1],false)};__p._handleMenu=function MessageList$_handleMenu(){var b=Control.getAncestorByAttr(event.srcElement,"msg");if(!b)return;event.returnValue=false;event.cancelBubble=true;var f=$tag(b,"INPUT")[0],d=f.checked,c=b.getAttribute("vm");if(!d)this.selectByElem(b,true,-1,true);if(InboxPage.isReadingPaneOn&&!d)InboxPage.readingPane.updateSelectedCount(1);f.checked=true;var g=this.getCheckedCount(),a="visible";this._menu.setButtonProperty("PrintMessages",a,1==g);this._menu.setButtonProperty("ViewSource",a,1==g);this._menu.setButtonProperty("MarkAsJunk",a,!(InboxPage.folderList.fid==InboxPage.Config.sysFldrs.junkFid));this._menu.setButtonProperty("MarkAsNotJunk",a,InboxPage.folderList.fid==InboxPage.Config.sysFldrs.junkFid);this._menu.setButtonProperty("MarkAsRead",a,c!="vm");this._menu.setButtonProperty("MarkAsUnread",a,c!="vm");var e=this._menu.getButtonProperty("DeleteMessages","elt");if(c!="vm")$addClass(e,"BorderTop");else $removeClass(e,"BorderTop");Tracking.addPS(InboxPage.Ps.contextMenu);this._menu.show({x:event.clientX,y:event.clientY+document.getElementsByTagName("HTML")[0].scrollTop});this._menu.focus()};__p._handleMenuItem=function MessageList$_handleMenuItem(b,a){Toolbar.onclick(a.key)};__p._getMessageListItems=function MessageList$_getMessageListItems(){var a=$tag(this.elt,"tbody");return $tag(a[0],"tr")};__p.getSelectedMessageData=function MessageList$getSelectedMessageData(){var e=this._getMessageListItems(),b=[],c=[];for(var a=this._selection.length-1;a>=0;a--){var d=e[this._selection[a]],f=d.id;b.push(f);var h=d.getAttribute("mad"),g=InboxPage.createMessageAuxData(h);c.push(g)}return {mids:b,mads:c}};__p.selectByIndex=function MessageList$selectByIndex(a,c,d){var b=this._getMessageListItems();if(a>=b.length||a<0)return null;return this.selectByElem(b[a],c,a,d)};__p.selectByMid=function MessageList$selectByMid(c,a,b){return this.selectByElem($(c),a,-1,b)};__p._getMessageListEltIndex=function MessageList$_getMessageListEltIndex(d){var c=-1,b=this._getMessageListItems();for(var a=b.length;a--;)if(d==b[a]){c=a;break}return c};__p.selectByElem=function MessageList$selectByElem(a,c,b,d){if(!a)return null;if(-1==b)b=this._getMessageListEltIndex(a);if(-1==b)return null;if(d)this.clearSelection();if(c){this._selection.push(b);$addClass(a,"MessageListItemSelected")}else{this._selection.remove(b);$removeClass(a,"MessageListItemSelected")}return a};__p.clearSelection=function MessageList$clearSelection(a){var d=this._getMessageListItems(),c;if(!a)c=document.getElementsByName("msgChk");for(var b=this._selection.length-1;b>=0;b--){idx=this._selection[b];this.selectByElem(d[idx],false,idx,false);if(!a)c[idx].checked=false}if(!a)$("msgChkAll").checked=false};__p.getSelectionIndex=function MessageList$getSelectionIndex(){var a=this._selection;return 0==a.length?-1:a[0]};__p._onCheckMessageClick=function MessageList$_onCheckMessageClick(l){var a=l.srcElement,c=$("msgChkAll"),g=Control.getAncestorByAttr(a,"msg"),b=this._getMessageListEltIndex(g);if("TD"==a.nodeName){var f=$tag(a,"INPUT");if(f.length>0){a=f[0];a.checked=!a.checked}}if(event.shiftKey&&this._shiftClickPivot>-1){var d=this._shiftClickPivot;if(d<b)this.checkRange(d,b,this._shiftClickPivotAction);else this.checkRange(b,d,this._shiftClickPivotAction)}if(c.checked==true&&a.checked==false)c.checked=false;else if(c.checked==false&&a.checked==true){var j=document.getElementsByName("msgChk"),h=true;for(var e=j.length-1;e>=0;e--)if(j[e].checked==false){h=false;break}c.checked=h}var i=this.getCheckedCount(),k=i+(a.checked?-1:1);if(0==k)this.clearSelection(true);this.selectByElem(g,a.checked,b,false);if(InboxPage.isReadingPaneOn)InboxPage.readingPane.updateSelectedCount(i);if(!(event.shiftKey&&this._shiftClickPivot>-1)){this._shiftClickPivot=b;this._shiftClickPivotAction=a.checked}};__p._refreshSelectionFromChecks=function MessageList$_refreshSelectionFromChecks(){this._selection=[];var b=document.getElementsByName("msgChk");for(var a=b.length-1;a>=0;a--)if(b[a].checked==true)this._selection.push(a)};__p.getCheckedCount=function MessageList$getCheckedCount(){var c=0,b=document.getElementsByName("msgChk");for(var a=b.length-1;a>=0;a--)if(b[a].checked)c++;return c};__p.checkRange=function MessageList$checkRange(f,g,b){var d=0,c=document.getElementsByName("msgChk"),e=Math.min(g+1,c.length);for(var a=f;a<e;a++)if(c[a].checked!=b){c[a].checked=b;this.selectByIndex(a,b,false);if(b)d++}if(InboxPage.isReadingPaneOn)InboxPage.readingPane.updateSelectedCount(d)};__p.checkAll=function MessageList$checkAll(a){var b=document.getElementsByName("msgChk");InboxPage.doPostProc=false;this.clearSelection();this.checkRange(0,b.length-1,a);$("msgChkAll").checked=a};__p.hasFocus=__p.focus=function MessageList$emptyFunction(){};MessageList.createClass("MessageList");function FolderList(a){Control.create(this,a);this._setStateFromDom();this._registerPerfDataHandler()}FolderList.JUNK_NAME="J";FolderList.NOT_JUNK_NAME="NJ";FolderList.UNSAFE_NAME="MU";FolderList.SAFE_NAME="MS";__p=FolderList.prototype={};__p.fid=__p.fst=__p.ft=null;__p.dispose=function FolderList$dispose(){Control.destroy(this);this._unregisterPerfDataHandler()};__p._setStateFromDom=function FolderList$_setStateFromDom(){var a=$tag(this.elt,"ul");a=a[0];this.fid=a.getAttribute("fid");this.fst=a.getAttribute("fst");this.ft=a.getAttribute("ft");this.isSrch=null!=a.getAttribute("isSrch");this.srchKw=a.getAttribute("srchKw");InboxPage.postProcData.uiUpdate=true};__p._onclick=function FolderList$_onclick(){var a=Control.getAncestorByAttr(event.srcElement,"fid");if(null==a||!a.id.isGuid()){InboxPage.doPostProc=false;return}var c=a.id,b=null!=a.getAttribute("isSrch");this.goToFldr(c,b)};__p.goToFldr=function FolderList$goToFldr(d,b){var c=InboxPage.messageList,a=InboxPage.createMessageListRenderingInfo(false);a.FolderId=d;a.SortKey=c.sBy;a.SortAsc=c.sAsc;a.IsSearchResults=b;a.SearchKeyword=b?this.srchKw:null;InboxPage.beginRefreshInbox(true,true,a,false,null,true);InboxPage.postProcData.perfRecorderTimerName="VI";InboxPage.postProcData.psValue=InboxPage.Ps.mailFolders};__p.setHTML=function FolderList$setHTML(a){this.elt.innerHTML=a;this._setStateFromDom()};__p.scrollIntoView=function FolderList$scrollIntoView(d){var b=$(d),c=this.elt,a=c.parentNode;if(b.offsetTop>a.offsetHeight)a.scrollTop=b.offsetTop+b.offsetHeight-a.offsetHeight};__p.getSelectedFolderType=function FolderList$getSelectedFolderType(){return this.ft};__p._registerPerfDataHandler=function FolderList$_registerPerfDataHandler(){if(typeof PerfRecorder=="undefined"||!PerfRecorder)return false;var c=this,a=function(){return {c16:c.ft}},b=PerfRecorder.registerAuxPageDataCallback;b(FolderList.JUNK_NAME,a);b(FolderList.NOT_JUNK_NAME,a);b(FolderList.SAFE_NAME,a);b(FolderList.UNSAFE_NAME,a);return true};__p._unregisterPerfDataHandler=function FolderList$_unregisterPerfDataHandler(){if(typeof PerfRecorder!="undefined"&&PerfRecorder){var a=PerfRecorder.unregisterAuxPageDataCallback;a(FolderList.JUNK_NAME);a(FolderList.NOT_JUNK_NAME);a(FolderList.SAFE_NAME);a(FolderList.UNSAFE_NAME)}};FolderList.createClass("FolderList");function ReadingPane(a){Control.create(this,a);this._setStateFromDom()}ReadingPane.NO_MODE=0;ReadingPane.MESSAGE_MODE=1;ReadingPane.NO_SELECTION_MODE=2;ReadingPane.SOME_SELECTION_MODE=3;ReadingPane.DELAY_LOADED_MODE=4;ReadingPane.oneSelHtml=String.format(Page.decode(InboxPage.Strings.someSelHtml),Page.decode(InboxPage.Strings.oneMsgSelected));ReadingPane.someSelTmpl=String.format(Page.decode(InboxPage.Strings.someSelHtml),Page.decode(InboxPage.Strings.someMsgsSelectedTmpl));ReadingPane.READ_NAME="R";__p=ReadingPane.prototype={};__p.codePageOverride=-1;__p.warnOnReplyForward=__p.isSvm=__p.showBody=__p.openBody=__p.showUnsafe=__p.unread=false;__p.contactEmail=__p.contactName=__p.rfSafeUrls=null;__p.auxData=__p.mid=__p.unsubscribeUrl=__p.fid=null;__p._replyForwardUrl=__p._replyAction=__p._replyAllAction=__p._forwardAction=null;__p.wmPlayers=null;__p.isFullView=false;__p.mode=ReadingPane.NO_MODE;__p.dispose=function ReadingPane$dispose(){if(this.wmPlayers!=null)while(this.wmPlayers.length>0){var a=this.wmPlayers.pop();a.dispose()}this._unregisterPerfDataHandler();Control.destroy(this)};__p._setStateFromDom=function ReadingPane$_setStateFromDom(){var a=$tag(this.elt,"div");if(null==a||a.length==0){this.mode=ReadingPane.NO_MODE;return}a=a[0];this._child=a;if(a.getAttribute("noSel")){this.mode=ReadingPane.NO_SELECTION_MODE;return}if(a.getAttribute("someSel")){this.mode=ReadingPane.SOME_SELECTION_MODE;return}if(a.getAttribute("delayed")){this.mode=ReadingPane.DELAY_LOADED_MODE;this.mid=a.getAttribute("mid");return}this.mode=ReadingPane.MESSAGE_MODE;this.setHTMLed=true;this.mid=a.getAttribute("mid");this.auxData=a.getAttribute("mad");this.contactEmail=a.getAttribute("ca");this.contactName=a.getAttribute("cn");this.openBody=a.getAttribute("ob")!=null;this.showBody=a.getAttribute("sb")!=null;this.showUnsafe=a.getAttribute("su")!=null;var b=a.getAttribute("cpo");this.codePageOverride=null!=b?b:-1;this.unread=a.getAttribute("nr")!=null;this.fid=a.getAttribute("fid");this.ftype=a.getAttribute("ft");this.ps=a.getAttribute("ps");this.vm=a.getAttribute("vm");this.vop=a.getAttribute("vop");this.safety=a.getAttribute("sf");this._replyForwardUrl=a.getAttribute("rfu");this._replyAction=a.getAttribute("ra");this._replyAllAction=a.getAttribute("raa");this._forwardAction=a.getAttribute("fa");this.warnOnReplyForward=null!=a.getAttribute("wrf");this.unsubscribeUrl=a.getAttribute("uu");this.isSvm=a.getAttribute("svm");var c=a.getAttribute("im");if(c=="im"){InboxPage.MsnIm.fromAddr=this.contactEmail;setTimeout(initMessengerPresence,20)}else if(c=="webim")if(window.informWebIMOfUpdate!==undefined&&window.informWebIMOfUpdate!==null)setTimeout(window.informWebIMOfUpdate,20);this._downloadFrame=$("downloadFrame");if(null!=this._downloadFrame)this._downloadFrame.attachEvent("onload",Delegate.create(this,ReadingPane._endDownloadAttachment));if($("AudioAttachments")!=null&&$("AllAttachments")!=null&&!Loc.isBidi)this._loadWMP();this._registerPerfDataHandler()};__p._loadWMP=function ReadingPane$_loadWMP(){Loader.load(InboxPage.WMP.cssUrls,InboxPage.WMP.scriptUrls,Delegate.create(this,this._attachAudioPlayers),$("bucket1"))};if(!Browser.isIE)__p._loadWMP=function ReadingPane$_loadWMP(){Loader.load(InboxPage.WMP.cssUrls,InboxPage.WMP.scriptUrls,Delegate.create(this,this._attachAudioPlayers))};__p._isSvmLinkClick=function ReadingPane$_isSvmLink(){var a=false;if(this.isSvm&&"A"==event.srcElement.tagName){var b=event.srcElement.href;if(b&&b.match("cgi-bin/feedback"))a=true}return a};__p._onBodyClick=function ReadingPane$_onBodyClick(){var a=false;if(this._isSvmLinkClick()){var b=InboxPage.createMessageListRenderingInfo(true),c=event.srcElement.href;InboxPage.configureAutoSelect(b);InboxServices.beginSvmFeedback(c,InboxPage.createMessageRenderingInfo(true),b);event.returnValue=false;event.cancelBubble=true;a=true}if(!a)InboxPage.doPostProc=false;return !a};__p._getDownloadUrl=function ReadingPane$_getDownloadUrl(a){var b="",c=a.getAttribute("aIdx"),g=a.getAttribute("aDepth"),f=a.getAttribute("isView"),e=a.getAttribute("tempFile");if(null!=c&&""!=c){var d=String.format("messageid={0}&attindex={1}&cp={2}&attdepth={3}",this.mid,c,this.codePageOverride,g);if(f!=null&&f=="true"&&e!=null)b=String.format("ViewOfficePreview.aspx?{0}&tempFile={1}",d,encodeURIComponent(e));else b=String.format("ScanAttachment.aspx?{0}",d)}return b};__p._downloadAttachment=function ReadingPane$_downloadAttachment(a){if(null!=this._downloadFrame)this._downloadFrame.src=a};__p._onAttachmentClick=function ReadingPane$_onAttachmentClick(){var a=Control.getAncestorByAttr(event.srcElement,"aIdx");if(null!=a){var b=a.getAttribute("aNewWin");if(null!=b)window.open(this._getDownloadUrl(a));else this._downloadAttachment(this._getDownloadUrl(a))}else InboxPage.doPostProc=false};ReadingPane._endDownloadAttachment=function ReadingPane$_endDownloadAttachment(){var b=null;try{if(Browser.isIE)b=this._downloadFrame.contentWindow.document.parentWindow;else b=this._downloadFrame.contentWindow}catch(e){return}if(b){var a={show:b.bShowMessage,block:b.bBlockClient,descr:b.sErrorDescription,yesNo:b.iYesCode,data:b.sData};if(a.show&&a.descr)if(a.block)if(a.yesNo>=0){var d=confirm(a.descr)?a.yesNo:-1;if(15==d&&null!=this._downloadFrame)this._downloadAttachment(a.data)}else alert(a.descr);else{var c=Infopane.getInstance();c.setContent(a.descr);$addClass(c.elt,"BorderNoTop");c.show()}}};__p._onMarkAsSafe=function ReadingPane$_onMarkAsSafe(b){var a=InboxPage.verifyMinimumSelection();if(a){InboxPage.postProcData.psValue=InboxPage.Ps.mailFolders;InboxPage.postProcData.perfRecorderTimerName="MS";Safety.markAsNotJunk(a.mids,a.mads,InboxPage.folderList.fid,b)}};__p._onMarkAsUnsafe=function ReadingPane$_onMarkAsUnsafe(){var a=InboxPage.verifyMinimumSelection();if(a){InboxPage.postProcData.psValue=InboxPage.Ps.mailFolders;InboxPage.postProcData.perfRecorderTimerName="MU";if(InboxPage.folderList.fid!=InboxPage.Config.sysFldrs.junkFid)Safety.markAsJunk(a.mids,a.mads,InboxPage.folderList.fid);else Messages.remove(a.mids,a.mads)}};__p._onUnsubscribe=function ReadingPane$_onUnsubscribe(){var a=InboxPage.verifyMinimumSelection();if(a)Safety.markAsUnsubscribe(a.mids,a.mads,InboxPage.folderList.fid)};__p.setHTML=function ReadingPane$setHTML(a){try{this.elt.innerHTML=a}catch(b){this.elt.innerHTML=a.replace(/<p.*>/gi,"<br/>")}this._setStateFromDom();this._handleWideMsg()};__p._showWideMsgBar=function ReadingPane$_showWideMsgBar(){var a=$("wideMsgBarPlaceholder");if(null==a.innerHTML||""==a.innerHTML)a.innerHTML=$("wideMsgBar").innerHTML;$setDisplay(a,true);Tracking.addPS(InboxPage.Ps.showFullMessageLink)};__p._hideWideMsgBar=function ReadingPane$_hideWideMsgBar(){$setDisplay($("wideMsgBarPlaceholder"),false)};__p._handleWideMsg=function ReadingPane$_handleWideMsg(){this._collapseMsg();if(this.mode!=ReadingPane.MESSAGE_MODE)return;if(Browser.isIE6)setTimeout(Delegate.create(this,this._handleWideMsg2),50);else this._handleWideMsg2()};__p._handleWideMsg2=function ReadingPane$_handleWideMsg2(){var j=$("contentRight"),i=Browser.isSF?document.body:$tag(document,"HTML")[0],a=parseInt(InboxPage.Config.readingPane.unmanagedAutoExpandMessageAtWidth);a=isNaN(a)||a<0?-1:a;var h=$("RadAd_Skyscraper"),k=h?h.offsetWidth:0,c="BottomUnmanaged"==Page.getLayout(),b=c?$("readMsgBodyContainer"):$("readingPaneContainer"),g=Browser.isIE6&&c?b&&b.scrollWidth>j.offsetWidth-k:b&&b.scrollWidth>b.offsetWidth,f=$("safetyBar"),d=f&&f.getAttribute("expands"),e=this.isFullView&&g&&(c&&(a==-1||i.offsetWidth<a)||!InboxPage.hasSkyscraper||this.openBody&&!d);if(this.doubleClicked)e=true;if(e)if(Browser.isIE6)setTimeout(Delegate.create(this,this._expandMsg),0);else this._expandMsg();else if(g&&!d&&this.isFullView)this._showWideMsgBar()};__p._adjustMessageWidth=function ReadingPane$_adjustMessageWidth(){var g=Browser.isSF?document.body:$tag(document,"HTML")[0],f=$("contentRight"),e=$("readingPaneContainer"),a=$("readMsgBodyContainer"),b=a?a.offsetParent.currentStyle:null;if(!a)return;var c=a.scrollWidth+parseInt(b.paddingLeft)+parseInt(b.paddingRight)+2,d=$("RadAd_Skyscraper");if(d)c+=d.offsetWidth;$addClass(e,"ExpandMessage");f.style.width=c+24+"px"};__p._onShowFullClick=function ReadingPane$_onShowFullClick(){var a=InboxPage.postProcData;a.psValue=InboxPage.Ps.showFullMessageClick;a.ads=false;a.history=false;this._expandMsg()};__p.onCloseClick=function ReadingPane$onCloseClick(){var a=InboxPage.postProcData;a.hideInfoPane=true;a.history=false;InboxPage.showFullReadingPane(false);InboxPage.messageList.focus();Toolbar.updateToolbarState();this._collapseMsg()};__p.onFullViewClick=function ReadingPane$onFullViewClick(){var a=InboxPage.postProcData;a.hideInfoPane=true;a.ads=false;a.history=false;this._expandMsg()};__p._expandMsg=function ReadingPane$_expandMsg(){if("BottomUnmanaged"==Page.getLayout())this._adjustMessageWidth();else{InboxPage.showFullReadingPane(true);InboxPage.resetSkyscraperScroll(true);InboxPage.readingPane.focus();Toolbar.updateToolbarState();if(InboxPage.hasSkyscraper){$removeClass($("contentRight"),"WithSkyscraper");if(Browser.isIE6)$("MainContent").className=$("MainContent").className}}InboxPage.resizeActionBars();this._hideWideMsgBar()};__p._collapseMsg=function ReadingPane$_collapseMsg(){if("BottomUnmanaged"==Page.getLayout()){$("contentRight").style.width="auto";$removeClass($("readingPaneContainer"),"ExpandMessage")}else if(InboxPage.hasSkyscraper){$addClass($("contentRight"),"WithSkyscraper");if(Browser.isIE6)$("MainContent").className=$("MainContent").className}InboxPage.resizeActionBars()};__p.reset=function ReadingPane$reset(){if(this._child){this.elt.removeChild(this._child);this._child=null}this.elt.innerHTML="";this.elt.scrollTop=0;this.mode=ReadingPane.NO_MODE};__p._onOpenBody=function ReadingPane$_onOpenBody(){InboxPage.postProcData.history=false;this._openMessage(HM.ReadMessageOperation.None,true,false)};__p._onShowUnsafe=function ReadingPane$_onShowUnsafe(){this._showUnsafe()};__p._onClickUnsafeLink=function ReadingPane$_onClickUnsafeLink(){if(this._isSvmLinkClick())return;var a=event;a.cancelBubble=true;if(confirm(Page.decode(InboxPage.Strings.unsafeLinkQuestion)))this._showUnsafe();else{a.returnValue=false;InboxPage.doPostProc=false}};__p._showUnsafe=function ReadingPane$_showUnsafe(){InboxPage.postProcData.history=false;this._openMessage(HM.ReadMessageOperation.None,true,true)};__p._onAddContact=function ReadingPane$_onAddContact(){InboxPage.postProcData.history=false;var a=InboxPage.createMessageRenderingInfo(true);a.Action=HM.ReadMessageOperation.AddContact;InboxServices.addContactFromMessage(this.contactName,this.contactEmail,a)};__p._openMessage=function ReadingPane$_openMessage(d,f,e,b,c){var a=InboxPage.createMessageRenderingInfo(true);a.Action=d;a.OpenMessageBody=f;a.AllowUnsafeContent=e;if(b)a.OverrideCodepage=b;if(c)a.MtLang=c;InboxPage.beginRefreshInbox(false,false,null,true,a)};__p._onSelectMenu=function ReadingPane$_onSelectMenu(){if(event.keyCode==13||event.keyCode!=38&&event.keyCode!=40&&event.keyCode!=9){var b=this.codePageOverride,c="",a=event.srcElement.value;if(null==a||""==a){InboxPage.doPostProc=false;return true}if(event.srcElement.id=="CP")b=a;else if(event.srcElement.id=="MT")c=a;InboxPage.postProcData.history=false;this._openMessage(HM.ReadMessageOperation.None,this.showBody,this.showUnsafe,b,c)}};__p.reply=function ReadingPane$reply(){var a="CanNotReplyAddress"==this._replyAction?null:String.format(this._replyForwardUrl,this._replyAction,this.showUnsafe?"True":"False");return this._replyForward(a,InboxPage.Strings.cannotReplyAddr)};__p.replyAll=function ReadingPane$replyAll(){var a="CanNotReplyAddress"==this._replyAllAction?null:String.format(this._replyForwardUrl,this._replyAllAction,this.showUnsafe?"True":"False");return this._replyForward(a,InboxPage.Strings.cannotReplyAddr)};__p.forward=function ReadingPane$forward(){var a="CanNotForwardAddress"==this._forwardAction?null:String.format(this._replyForwardUrl,this._forwardAction,this.showUnsafe?"True":"False");return this._replyForward(a,InboxPage.Strings.cannotFwdAddr)};__p._replyForward=function ReadingPane$_replyForward(a,b){InboxPage.doPostProc=false;if(a)if(!this.warnOnReplyForward)Page.postWithFolderCache("folderCache","NewMessage",a);else Page.showMessage(Page.decode(InboxPage.Strings.replyForwardWarning),a,null,"_self");else alert(Page.decode(b));return false};__p.deleteVMFromPhone=function ReadingPane$deleteVMFromPhone(){this._changeVMSafetyBar(false);InboxPage.messageList.removeVMOnPhoneStatus();InboxServices.deleteVMFromPhone(this.mid)};__p.markVMFAsSaved=function ReadingPane$markVMFAsSaved(){this._changeVMSafetyBar(true);InboxServices.markVMAsSaved(this.mid)};__p._changeVMSafetyBar=function ReadingPane$_changeSafetyBar(c){var a=$("safetyBar");if(!a)return;a=$tag(a,"SPAN")[0];var b=$tag(a,"SPAN");$addClass(b[0],"DisplayNone");$removeClass(b[c?1:2],"DisplayNone");$addClass(b[!c?1:2],"DisplayNone");$addClass(b[3],"DisplayNone");var d=$tag(a,"A");if(c)$addClass(d[1],"DisplayNone");else{$addClass(d[0],"DisplayNone");$addClass(d[1],"DisplayNone")}};__p._attachAudioPlayers=function ReadingPane$_attachAudioPlayers(){var c=$("AudioAttachments"),d=$("AllAttachments");this.wmPlayers=[];var b=$tag(d,"a");for(var a=0;a<b.length;a++)if(b[a].id=="AudioAttachment"){var e=b[a].innerText,f=this._getDownloadUrl(b[a]);this.wmPlayers.push(new WMP.WMPlayer(c,f,e))}};__p.showFullView=function ReadingPane$showFullView(){if(this.isFullView)return;var a=$("readingPaneSplitPane");if("Bottom"==InboxPage.Config.readingPane.location){a._oldTop=a.style.top;a.style.top=null}else if("Right"==InboxPage.Config.readingPane.location){a._oldLeft=a.style[Loc.LEFT];a.style[Loc.LEFT]=null}$updateClass(a,["ReadingPaneSplitPaneFull"],["ReadingPaneSplitPaneRight","ReadingPaneSplitPaneBottom","ReadingPaneSplitPaneHidden"]);this.isFullView=true;if(InboxPage.messageList.hasFocus())this.focus(true)};__p.hideFullView=function ReadingPane$hideFullView(){if(!this.isFullView)return;if("BottomUnmanaged"==Page.getLayout())$("contentRight").style.width="auto";var b=InboxPage.Config.readingPane.location,a=$("readingPaneSplitPane");if("Bottom"==b){a.style.top=a._oldTop;a.style._oldTop=null;$updateClass(a,["ReadingPaneSplitPaneBottom"],["ReadingPaneSplitPaneFull"])}else if("Right"==b){a.style[Loc.LEFT]=a._oldLeft;a.style._oldLeft=null;$updateClass(a,["ReadingPaneSplitPaneRight"],["ReadingPaneSplitPaneFull"])}else $addClass(a,"ReadingPaneSplitPaneHidden");this.isFullView=false;if(this.hasFocus())InboxPage.messageList.focus()};__p.isShowingMessage=function ReadingPane$isShowingMessage(){return this.mode==ReadingPane.MESSAGE_MODE&&(InboxPage.isReadingPaneOn||this.isFullView)};ReadingPane.doDelayLoad=function ReadingPane$doDelayLoad(b){var a=InboxPage.createMessageRenderingInfo(false);a.MessageId=b;a.FolderId=InboxPage.folderList.fid;InboxPage.beginRefreshInbox(false,false,null,true,a)};__p.updateSelectedCount=function ReadingPane$updateSelectedCount(b){var a;if(0==b)a=Page.decode(InboxPage.Strings.noSelHtml);else if(1==b)a=ReadingPane.oneSelHtml;else a=String.format(ReadingPane.someSelTmpl,b);this.toggleActionBar(false);this.setHTML(a);InboxPage.resetContentHeight($("readingPaneContentContainer"))};__p.toggleActionBar=function ReadingPane$toggleActionBar(a){if(a){$("actionBar").style.visibility="visible";$removeClass(this.elt,"ReadingPaneContainerNoActionBar")}else{$("actionBar").style.visibility="hidden";$addClass(this.elt,"ReadingPaneContainerNoActionBar")}};__p._registerPerfDataHandler=function ReadingPane$_registerPerfDataHandler(){if(typeof PerfRecorder=="undefined"||!PerfRecorder)return false;var a=this,b=function(){var b=String.format("{0}x{1}",window.screen.width,window.screen.height);return {bh:document.documentElement.clientHeight,bw:document.documentElement.clientWidth,c5:b,s:b,c6:typeof InboxPage!="undefined"&&InboxPage&&!InboxPage.isReadingPaneOn&&InboxPage.readingPane.isFullView&&$("readingPaneContainer")?$("readingPaneContainer").scrollWidth:"NA",c16:a.ftype,c19:a.safety,c20:InboxPage.Config.readingPane.location}};PerfRecorder.registerAuxPageDataCallback(ReadingPane.READ_NAME,b);return true};__p._unregisterPerfDataHandler=function ReadingPane$_unregisterPerfDataHandler(){if(PerfRecorder)PerfRecorder.unregisterAuxPageDataCallback(ReadingPane.READ_NAME)};function onClickUnsafeLink(a){Control.invoke("ReadingPane","_onClickUnsafeLink",a)}__p.hasFocus=__p.focus=function ReadingPane$emptyFunction(){};ReadingPane.createClass("ReadingPane");SearchBox={};SearchBox._onSearchClick=function SearchBox$_onSearchClick(c){var a=$("productSearchTerms");if(null==a){InboxPage.doPostProc=false;return}var b=a.value;c.cancelBubble=true;if($containsClass(a,"c_fia")&&b.trim()!="")InboxPage.messageList.search(b)};SearchBox.setValue=function SearchBox$updateSearchValue(b){var a=$("productSearchTerms");a.value=b;a.className="c_ml c_fia";a.s="t"};SearchBox.resetValue=function SearchBox$resetValue(){var a=$("productSearchTerms");a.value=a.getAttribute("r");a.className="c_ml TextItalic";a.s=""};Type.createStaticClass(SearchBox,"SearchBox");Toolbar={};Toolbar.REGULAR=0;Toolbar.ALTERNATE=1;Toolbar.initialize=function Toolbar$initialize(){Toolbar.initializeTools(Toolbar,Toolbar.REGULAR);if($("Alt_Toolbar")){Toolbar.alt={};Toolbar.initializeTools(Toolbar.alt,Toolbar.ALTERNATE)}};Toolbar.initializeTools=function Toolbar$initializeTools(a,c){var b="";if(Toolbar.ALTERNATE==c)b="Alt_";a.reply=$(b+"ReplyButton").parentNode;a.replyAll=$(b+"ReplyAllButton").parentNode;a.forward=$(b+"ForwardButton").parentNode;a.junk=$(b+"MarkAsJunk").parentNode;a.notJunk=$(b+"MarkAsNotJunk").parentNode;a.phish=$(b+"MarkAsPhish").parentNode;a.read=$(b+"MarkAsRead").parentNode;a.unread=$(b+"MarkAsUnread").parentNode;a.previous=$(b+"PreviousButton").parentNode;a.next=$(b+"NextButton").parentNode;a.newMsg=$(b+"NewMessage").parentNode;a.markAs=$(b+"MarkAs");a.markAsMenu=$tag(a.markAs,"UL")[0];a.moveTo=$(b+"MoveTo");a.moveToMenu=$tag(a.moveTo,"UL")[0];a.print=$(b+"PrintMessages").parentNode;a.emptyFolder=$(b+"EmptyFolderButton").parentNode;a.pipeAfterNew=$(b+"AfterNewMessagePipe");a.pipeAfterJunk=$(b+"AfterMarkAsJunkPipe");a.pipeAfterMove=$(b+"AfterMoveToPipe");a.pipeBeforeNextPrev=$(b+"BeforeNextPrevPipe")};Toolbar.onclick=function Toolbar$onclick(a){if(!a){InboxPage.doPostProc=false;return}switch(a){case "Options":case "Help":case "HelpFeedback":case "HelpWhatsNew":case "HelpFAQ":case "HelpSupport":case "HelpAbout":case "SearchProduct":InboxPage.doPostProc=false;return}var b=Control.getAncestorByAttr(event.srcElement,"aId");return Toolbar.doAction(a,b)};Toolbar.doAction=function Toolbar$doAction(d,e){var f=InboxPage.readingPane,b=InboxPage.folderList,c=InboxPage.postProcData;switch(d){case "NewMessage":InboxActions.newMsg();return false;case "CheckPop":Page.submit(d);InboxPage.doPostProc=false;return;case "ReplyButton":return InboxActions.reply();case "ReplyAllButton":return InboxActions.replyAll();case "ForwardButton":return InboxActions.forward();case "NextButton":InboxActions.nextMsg();return;case "PreviousButton":InboxActions.prevMsg();return;case "FullViewButton":f.onFullViewClick();return;case "CloseButton":InboxActions.closeFullViewMsg();return;case "CheckAll":InboxActions.select($("msgChkAll").checked);return;case "SortByDate":InboxPage.messageList.sort("Date");return;case "SortBySender":InboxPage.messageList.sort("Sender");return;case "SortBySubject":InboxPage.messageList.sort("Subject");return;case "SortBySize":InboxPage.messageList.sort("Size");return;case "ShowWithAttach":InboxPage.messageList.search("hasattachment:true");return;case "EmptyFolderButton":if(confirm(Page.decode(InboxPage.Strings.confirmEmptyFolder))){if(InboxPage.Config.sysFldrs.junkFid==b.fid){c.psValue=InboxPage.Ps.mailFolders;InboxPage.postProcData.perfRecorderTimerName="EJ"}c.history=false;InboxServices.beginClearFolder(b.fid,InboxPage.createMessageListRenderingInfo(true))}return;case "DeleteMessages":InboxActions.deleteMsg();return;case "PrintMessages":InboxActions.printMsg();return;case "MarkAsUnread":InboxActions.markAsUnread();return;case "MarkAsRead":InboxActions.markAsRead();return;case "MarkAsJunk":InboxActions.markAsJunk();return}var a=InboxPage.verifyMinimumSelection();if(null==a)return;switch(d){case "MarkAsNotJunk":c.psValue=InboxPage.Ps.mailFolders;InboxPage.postProcData.perfRecorderTimerName="NJ";Safety.markAsNotJunk(a.mids,a.mads,b.fid,false);break;case "MarkAsPhish":Safety.markAsPhish(a.mids,a.mads,b.fid);break;case "MoveTo":var g=e&&e.getAttribute?e.getAttribute("fid"):"";c.psValue=InboxPage.Ps.mailFolders;InboxPage.postProcData.perfRecorderTimerName="DM";Messages.move(a.mids,a.mads,b.fid,g);break;case "ViewSource":if(a.mids.length>0)window.open("/mail/GetMessageSource.aspx?msgid="+a.mids[0])}};Toolbar.updateToolbarState=function Toolbar$updateToolbarState(){Toolbar.updateToolbarStateHelper(Toolbar,Toolbar.REGULAR);if(Toolbar.alt)Toolbar.updateToolbarStateHelper(Toolbar.alt,Toolbar.ALTERNATE);Resize._mainContentResize()};Toolbar.updateToolbarStateHelper=function Toolbar$updateToolbarStateHelper(a,i){var f=InboxPage.folderList.fst,g=f!="SENT"&&f!="DRAFTS",c=f=="JUNK",k=f=="TRASH",e=InboxPage.readingPane.isShowingMessage(),j=!InboxPage.readingPane.isFullView,h=InboxPage.readingPane.vm,b=e&&1==i;a.reply.style.display=e&&!c?"block":"none";a.replyAll.style.display=e&&!c?"block":"none";a.forward.style.display=e&&!c?"block":"none";a.junk.style.display=!b&&g&&!c?"block":"none";a.phish.style.display=g?"block":"none";a.notJunk.style.display=!b&&g&&c?"block":"none";a.read.style.display=!h?"block":"none";a.unread.style.display=j&&!h?"block":"none";a.next.style.display=InboxPage.isReadingPaneOn||InboxPage.readingPane.isFullView?"block":"none";a.previous.style.display=InboxPage.isReadingPaneOn||InboxPage.readingPane.isFullView?"block":"none";a.emptyFolder.style.display=!b&&(c||k)?"block":"none";a.pipeBeforeNextPrev.style.display=c?"none":"block";var d=a.markAsMenu.binding;if(d)d.invalidatePosition();d=a.moveToMenu.binding;if(d)d.invalidatePosition();if(Toolbar.ALTERNATE==i){a.newMsg.style.display=b?"none":"block";a.print.style.display=b?"none":"block";a.markAs.style.display=b?"none":"block";a.moveTo.style.display=b?"none":"block";a.pipeAfterJunk.style.display=b?"none":"block";a.pipeAfterMove.style.display=b?"none":"block";a.pipeAfterNew.style.display=!(c&&b)?"block":"none";a.pipeBeforeNextPrev.style.display=b?"block":"none";if(b)$addClass($("Alt_Toolbar"),"ReadMessageAltToolbar");else $removeClass($("Alt_Toolbar"),"ReadMessageAltToolbar")}};Type.createStaticClass(Toolbar,"Toolbar");Toolbar.initialize();__p=ReadingPane.prototype;__p._hasFocus=false;__p.initFocusHandling=function MessageList$initFocusHandling(){this._focusInDelegate=Delegate.create(this,this._onFocusIn);this._focusOutDelegate=Delegate.create(this,this._onFocusOut);this._splitPaneElt=$("readingPaneSplitPane");this._splitPaneElt.attachEvent("onfocusin",this._focusInDelegate);this._splitPaneElt.attachEvent("onfocusout",this._focusOutDelegate)};__p.disposeFocusHandling=function MessageList$disposeFocusHandling(){this._splitPaneElt.detachEvent("onfocusout",this._focusOutDelegate);this._splitPaneElt.detachEvent("onfocusin",this._focusInDelegate);this._focusOutDelegate=null;this._focusInDelegate=null};__p._innerSetHTML=__p.setHTML;__p.setHTML=function ReadingPane$setHTML$wrapper(b){var a=this._hasFocus;this._innerSetHTML(b);if(a)this.focus()};__p._onFocusIn=function ReadingPane$_onFocusIn(){this._hasFocus=true};__p._onFocusOut=function ReadingPane$_onFocusOut(){if(!this._splitPaneElt.contains(event.toElement))this._hasFocus=false};__p.focus=function ReadingPane$focus(b){if(this.mode===ReadingPane.MESSAGE_MODE){var a=$("rpFocusElt");if(a)$callFocus(a)}else if(this.mode===ReadingPane.DELAY_LOADED_MODE||b)this._hasFocus=true};__p.hasFocus=function ReadingPane$hasFocus(){return this._hasFocus};__p=MessageList.prototype;__p._navEventTimer=null;__p._hasFocus=false;MessageList.KEYBOARD_DELAY_MILLISECONDS=200;__p.initFocusHandling=function MessageList$initFocusHandling(){this._focusInDelegate=Delegate.create(this,this._onFocusIn);this._focusOutDelegate=Delegate.create(this,this._onFocusOut);this.elt.attachEvent("onfocusin",this._focusInDelegate);this.elt.attachEvent("onfocusout",this._focusOutDelegate)};__p.initKeyboardHandling=function MessageList$initKeyboardHandling(){this._keyDownDelegate=Delegate.create(this,this._onKeyDownWrapper);this.elt.attachEvent("onkeydown",this._keyDownDelegate);var a=$("msgChkAll");if(a)a.attachEvent("onkeydown",this._keyDownDelegate)};__p.disposeFocusHandling=function MessageList$disposeFocusHandling(){this.elt.detachEvent("onfocusout",this._focusOutDelegate);this.elt.detachEvent("onfocusin",this._focusInDelegate);this._focusOutDelegate=null;this._focusInDelegate=null};__p.disposeKeyboardHandling=function MessageList$disposeKeyboardHandling(){this.elt.detachEvent("onkeydown",this._keyDownDelegate);var a=$("msgChkAll");if(a)a.detachEvent("onkeydown",this._keyDownDelegate);this._keyDownDelegate=null};__p._onKeyDownWrapper=function MessageList$_onKeyDownWrapper(){Control.onPreInvoke("MessageList","_onKeyDownWrapper");InboxPage.doPostProc=false;this._onKeyDown();Control.onPostInvoke("MessageList","_onKeyDownWrapper")};__p._onKeyDown=function MessageList$_onKeyDown(){if(event.shiftKey||event.ctrlKey||event.altKey)return true;var a;switch(event.keyCode){case 38:a="prevMsg";break;case 40:a="nextMsg";break;default:return true}if(Control.invokeStatic("InboxActions",a,event,true))return true;event.returnValue=false;event.cancelBubble=true;return false};__p._startNavEventTimer=function MessageList$_startNavEventTimer(a){this._cancelNavEventTimer();this._navEventTimer=setTimeout(a,MessageList.KEYBOARD_DELAY_MILLISECONDS)};__p._cancelNavEventTimer=function MessageList$_cancelNavEventTimer(){if(null!=this._navEventTimer){clearTimeout(this._navEventTimer);delete this._navEventTimer;this._navEventTimer=null}};__p._innerOpenMessage=__p._openMessage;__p._openMessage=function MessageList$_openMessage$wrapper(b,a,c,d){if(d)this._startNavEventTimer(Delegate.create(this,function(){InboxPage.doPostProc=true;this._innerOpenMessage(b,a,c)}));else{InboxPage.doPostProc=true;this._innerOpenMessage(b,a,c)}};__p._innerOpenPageByElt=__p._openPageByElt;__p._openPageByElt=function MessageList$_openPageByElt$wrapper(b,a){this._cancelNavEventTimer();this._innerOpenPageByElt(b,a,true)};__p._innerSetHTML=__p.setHTML;__p.setHTML=function MessageList$setHTML$wrapper(b){var a=this._hasFocus;this._innerSetHTML(b);if(a)this.focus()};__p._onFocusIn=function MessageList$_onFocusIn(){this._hasFocus=true};__p._onFocusOut=function MessageList$_onFocusOut(){if(!this.elt.contains(event.toElement))this._hasFocus=false};__p.focus=function MessageList$focus(){var a=$tag(this.elt,"input");if(a&&a.length>0){var b=this.getSelectionIndex();if(b<0||b>=a.length)b=0;$callFocus(a[b])}};__p.hasFocus=function MessageList$hasFocus(){return this._hasFocus};InboxActions={};InboxActions.newMsg=function InboxActions$newMsg(){if(typeof PerfRecorder!="undefined"&&PerfRecorder)PerfRecorder.startTimer(false,"CON");Page.postWithFolderCache("folderCache","NewMessage","EditMessageLight.aspx?n="+Page.queryString.newNonce);InboxPage.doPostProc=false};InboxActions.deleteMsg=function InboxActions$deleteMsg(){var a=InboxPage.verifyMinimumSelection();if(a){InboxPage.postProcData.psValue=InboxPage.Ps.mailFolders;InboxPage.postProcData.perfRecorderTimerName="DM";Messages.remove(a.mids,a.mads)}};InboxActions.markAsJunk=function InboxActions$markAsJunk(d){var b=InboxPage.folderList.fid,c=InboxPage.Config.sysFldrs;if(d&&(b==c.junkFid||b==c.trashFid))return true;var a=InboxPage.verifyMinimumSelection();if(a){InboxPage.postProcData.psValue=InboxPage.Ps.mailFolders;InboxPage.postProcData.perfRecorderTimerName="J";Safety.markAsJunk(a.mids,a.mads,b)}};InboxActions.markAsRead=function InboxActions$markAsRead(){InboxActions._markAsReadUnread(true)};InboxActions.markAsUnread=function InboxActions$markAsUnread(){InboxActions._markAsReadUnread(false)};InboxActions._markAsReadUnread=function $InboxActions$_markAsReadUnread(b){var a=InboxPage.verifyMinimumSelection();if(a){InboxPage.postProcData.showLoading=false;Messages.markAsReadUnread(a.mids,a.mads,b)}};InboxActions.moveToFolder=function InboxActions$moveToFolder(){var b=$("MoveTo");if(b){var a=b.children[0];if(a){a.focus();if(Browser.isIE)a.click();else a.onclick();InboxPage.doNotCloseMenu=true}}};InboxActions.printMsg=function printMsg(){var a=InboxPage.verifyMinimumSelection();if(a){InboxPage.postProcData.showLoading=false;Messages.print(a.mids,InboxPage.readingPane.isShowingMessage()?InboxPage.readingPane.showUnsafe:false)}};InboxActions.reply=function InboxActions$reply(){if(InboxPage.readingPane.isShowingMessage())return InboxPage.readingPane.reply();return true};InboxActions.replyAll=function InboxActions$replyAll(){if(InboxPage.readingPane.isShowingMessage())return InboxPage.readingPane.replyAll();return true};InboxActions.forward=function InboxActions$forward(){if(InboxPage.readingPane.isShowingMessage())return InboxPage.readingPane.forward();return true};InboxActions.prevMsg=function InboxActions$prevMsg(a){return InboxActions._prevNextHelper(a,true)};InboxActions.nextMsg=function InboxActions$nextMsg(a){return InboxActions._prevNextHelper(a,false)};InboxActions._prevNextHelper=function InboxActions$_prevNextHelper(a,b){if(a&&!InboxPage.isReadingPaneOn&&!InboxPage.readingPane.isFullView)return true;if(InboxPage.readingPane.isFullView&&-1==InboxPage.messageList.getSelectionIndex())InboxPage.showFullReadingPane(false);else if(b)InboxPage.messageList.previous();else InboxPage.messageList.next()};InboxActions.selectAll=function InboxActions$selectAll(){return InboxActions.select(true,true)};InboxActions.selectNone=function InboxActions$selectNone(){return InboxActions.select(false,true)};InboxActions.select=function InboxActions$select(b,a){if(a&&InboxPage.readingPane.isFullView)return true;InboxPage.messageList.checkAll(b)};InboxActions.searchMail=function InboxActions$searchMail(){if(InboxPage.readingPane.isFullView)return true;var a=$("productSearchTerms");if(a)try{a.focus()}catch(b){}};InboxActions.closeFullViewMsg=function InboxActions$closeFullViewMsg(b){var a=InboxPage.readingPane;if(b&&!a.isFullView)return true;a.onCloseClick()};InboxActions.openMsg=function InboxActions$openMsg(){if(!InboxPage.isReadingPaneOn&&!InboxPage.readingPane.isFullView){var b=InboxPage.messageList,a=b.getSelectedMessageData();if(a.mids.length==1){var c=$(a.mids[0]);if(c)b._openMessageByElt(c);return false}}return true};InboxActions.goToInbox=function InboxActions$goToInbox(){InboxPage.folderList.goToFldr(InboxPage.Config.sysFldrs.inboxFid,false)};InboxActions.goToDrafts=function InboxActions$goToDrafts(){InboxPage.folderList.goToFldr(InboxPage.Config.sysFldrs.draftsFid,false)};InboxActions.goToSent=function InboxActions$goToSent(){InboxPage.folderList.goToFldr(InboxPage.Config.sysFldrs.sentFid,false)};Type.createStaticClass(InboxActions,"InboxActions");InboxPage.initialize=function InboxPage$initialize(){InboxPage._initializePostProcData();window.attachEvent("onunload",InboxPage._onUnload);window.attachEvent("onbeforeunload",InboxPage._onBeforeUnload);window.attachEvent("onresize",InboxPage.resizeActionBars);if(Page.isPageLoaded)InboxPage._onLoad();else window.attachEvent("onload",InboxPage._onLoad);InboxPage._invokes=[];InboxPage.isReadingPaneOn="Bottom"==InboxPage.Config.readingPane.location||"Right"==InboxPage.Config.readingPane.location;InboxPage.hasSkyscraper=$containsClass($("contentRight"),"WithSkyscraper");InboxPage.folderList=new FolderList($("folderListContainer"));InboxPage.messageList=new MessageList($("messageListContainer"));InboxPage.readingPane=new ReadingPane($("readingPaneContainer"));InboxPage.messageList.initFocusHandling();if(InboxPage.kbdInitMsgListShortcuts)InboxPage.messageList.initKeyboardHandling();InboxPage.readingPane.initFocusHandling();if(InboxPage.kbdShortcuts)KeyboardHandler.initialize(InboxPage.kbdShortcuts,function(b,a){ShortcutsHandler.handler(b,a,InboxPage.pdCookie,function(c,b){var a=Control.invokeStatic("InboxActions",b,c,true);if(!a&&!InboxPage.doNotCloseMenu)$menu.closeCurrent();InboxPage.doNotCloseMenu=false;return a})},KbdShortcuts.timeout,false);if(InboxPage.isReadMessageMode)InboxPage.showFullReadingPane(true,true);var a=InboxPage.readingPane;if(a.isFullView||InboxPage.isReadingPaneOn)a.toggleActionBar(a.mode==ReadingPane.MESSAGE_MODE);InboxPage.updateUi();Page.fppCfg.CanaryValue=Cookie.getCookie(Page.fppCfg.CanaryToken);Network.initialize(Page.fppCfg);Network.makeCallback=FunctionHelper.wrapTopLevelMethod;Network.reportError=InboxPage._onFppError;Network.onPreInvoke=InboxPage._onNetworkPreInvoke;Network.onPostCallback=InboxPage._onNetworkPostCallback;Control.onPreInvoke=InboxPage._onPreInvoke;Control.onPostInvoke=Network.onRequestComplete=InboxPage._onPostInvoke;InboxServices.attachEvent("endUpdateUi",Delegate.create(this,InboxPage._endUpdateUi));Infopane.initialize();FireAnt.Debug.initialize();FireAnt.Debug.addData=InboxPage._addErrorData;FireAnt.Debug.onJsError=InboxPage._onjsError;Network.onexception=FireAnt.Debug.handleException;if(!Browser.isSF)History.attachEvent("onnavigate",function(a){Control.invokeStatic("InboxPage","_onRestoreState",{},a)});LoadingIndicator.hide();Cookie.setCookieValues(InboxPage.Config.konaRefreshCookie,{},Cookie.SessionCookie);if(InboxPage.readingPane.mode==ReadingPane.DELAY_LOADED_MODE)Control.invokeStatic("ReadingPane","doDelayLoad",{},InboxPage.readingPane.mid);else if(!InboxPage.isReadMessageMode&&InboxPage.Config.readingPane.autoSelectFirstMsg&&InboxPage.isReadingPaneOn)InboxPage._markCurrentAsRead();setTimeout(InboxPage.downloadBucket1,100);Page.oninitresize=InboxPage.resizeActionBars;InboxPage._registerPerfDataHandlers()};InboxPage.onBucket1Download=function InboxPage$onBucket1Download(){InboxPage.initializeBucket1()};InboxPage.downloadBucket1=function InboxPage$downloadBucket1(){Loader.load(InboxPage.cssUrls,InboxPage.scriptUrls,InboxPage.onBucket1Download,$("bucket1"))};InboxPage.dispose=function InboxPage$dispose(){window.detachEvent("onunload",InboxPage._onUnload);window.detachEvent("onbeforeunload",InboxPage._onBeforeUnload);window.detachEvent("onload",InboxPage._onLoad);Infopane.cleanup();if(InboxPage.folderList)InboxPage.folderList.dispose();if(InboxPage.messageList){if(InboxPage.kbdInitMsgListShortcuts)InboxPage.messageList.disposeKeyboardHandling();InboxPage.messageList.disposeFocusHandling();InboxPage.messageList.dispose()}if(InboxPage.readingPane){InboxPage.readingPane.disposeFocusHandling();InboxPage.readingPane.dispose()}if(InboxPage.splitter)InboxPage.splitter.dispose();if(InboxPage.dnd)InboxPage.disposeDragDrop();if(InboxPage.kbdShortcuts)KeyboardHandler.dispose();InboxPage._unregisterPerfDataHandlers();InboxPage.doNotCloseMenu=null};InboxPage._registerPerfDataHandlers=function InboxPage$_registerPerfDataHandlers(){if(typeof PerfRecorder=="undefined"||!PerfRecorder)return false;var a=PerfRecorder.registerAuxPageDataCallback;a("DM",function(){return {c16:InboxPage.folderList.getSelectedFolderType()}});a("VI",function(){return {c16:InboxPage.folderList.getSelectedFolderType(),c20:InboxPage.Config.readingPane.location}});return true};InboxPage._unregisterPerfDataHandlers=function InboxPage$_unregisterPerfDataHandlers(){if(!PerfRecorder)return;var a=PerfRecorder.unregisterAuxPageDataCallback;a("DM");a("VI")};InboxPage._initializePostProcData=function InboxPage$_initializePostProcData(){InboxPage.postProcData={history:true,ads:true,psValue:null,uiUpdate:false,showLoading:true,perfRecorderTimerName:null,perfRecorderPayloadLen:null,hideInfoPane:false,updateSortUi:false}};InboxPage._onPreInvoke=function InboxPage$_onPreInvoke(b,c,d){if(b=="Resize")return;if(InboxPage._invokes.length>5)InboxPage._invokes.shift();InboxPage._invokes.push({typeName:b,methodName:c,args:d});PerfRecorder.startTimer(true,InboxPage.postProcData.perfRecorderTimerName);var a=Infopane.getInstance(false);if(History.isOnNavigateFiring||a&&null!=event&&(a.elt==event.srcElement||a.elt.contains(event.srcElement)))Infopane.hide();InboxPage.doPostProc=true;InboxPage._initializePostProcData()};InboxPage._onPostInvoke=function InboxPage$_onPostInvoke(a){if(a=="Resize")return;if(InboxPage.doPostProc){if(InboxPage.postProcData.showLoading)LoadingIndicator.show();if(!Network.hasOpenRequests()){InboxPage.doPostProc=false;InboxPage._onUserActionComplete();InboxPage._initializePostProcData()}}};InboxPage._onUserActionComplete=function InboxPage$_onUserActionComplete(){var a=InboxPage.postProcData;if(a.history)InboxPage._saveState();if(a.ads)setTimeout(RefreshAds,20);if(a.uiUpdate)InboxPage.updateUi();if(a.psValue){PerfRecorder.stopTimer(a.perfRecorderTimerName,InboxPage.postProcData.perfRecorderPayloadLen);PerfRecorder.sendTransaction();Tracking.addPS(a.psValue,PerfRecorder.getPerfPayload())}if(a.hideInfoPane)Infopane.hide();LoadingIndicator.hide()};InboxPage._onBeforeUnload=function InboxPage$_onBeforeUnload(){if(!InboxPage.doPostProc)InboxPage._createPageRefreshCookie()};InboxPage._onUnload=function InboxPage$_onUnload(){LoadingIndicator.hide();InboxPage.dispose()};InboxPage._onLoad=function InboxPage$_onLoad(){if(!Browser.isSF){if(""==$("isFirstPL").value){var a=History.getSerializedState();if(a)History.stateChanged(a)}$("isFirstPL").value=""}};InboxPage.beginRefreshInbox=function InboxPage$beginRefreshInbox(e,f,a,d,b,g,c){InboxPage.readingPane.doubleClicked=false;InboxPage.readingPane.setHTMLed=false;InboxServices.beginRefreshInbox(e,f,a,d,b,g,c)};InboxPage._endUpdateUi=function InboxPage$_endUpdateUi(c){if(null!=c.RedirectUrl&&""!=c.RedirectUrl){InboxPage.doPostProc=false;window.location.href=c.RedirectUrl;return}var g=c.MessageHtml,d=c.MessageListHtml,e=c.FolderListHtml,f=c.InfoPaneHtml,b=0;if(null!=e&&""!=e){InboxPage.folderList.setHTML(e);b=e.length;if(InboxPage.folderList.isSrch)SearchBox.setValue(InboxPage.folderList.srchKw);else SearchBox.resetValue()}if(null!=d&&""!=d){InboxPage.messageList.setHTML(d);b=b+d.length;InboxPage.postProcData.updateSortUi=true;if(InboxPage.messageList.srch&&0==InboxPage.messageList.getCount())InboxPage.postProcData.psValue=InboxPage.Ps.searchResultsEmpty}if(null!=g&&""!=g){var a=InboxPage.readingPane;b=b+g.length;a.reset();if(!InboxPage.isReadingPaneOn){a.toggleActionBar(true);InboxPage.showFullReadingPane(true);if(Browser.isIE6)Resize.Element_OnResize($("readingPaneSplitPane"),false)}a.setHTML(g);if(a.isFullView&&a.mode!=ReadingPane.MESSAGE_MODE||InboxPage.isReadingPaneOn)a.toggleActionBar(a.mode==ReadingPane.MESSAGE_MODE);InboxPage.resetContentHeight($("readingPaneContentContainer"));if(a.mode==ReadingPane.DELAY_LOADED_MODE)ReadingPane.doDelayLoad(a.mid);else if(a.mode==ReadingPane.MESSAGE_MODE){InboxPage.postProcData.perfRecorderTimerName="R";InboxPage.postProcData.psValue=a.ps;if($(a.mid)&&(a.unread||!InboxPage.messageList.isRead(a.mid)))InboxPage._markCurrentAsRead()}}if(null!=f&&""!=f){var h=Infopane.getInstance();h.setContent(f);h.show();b=b+f.length}if(-1==InboxPage.messageList.getSelectionIndex()&&InboxPage.readingPane.isFullView)InboxPage.showFullReadingPane(false);InboxPage.postProcData.perfRecorderPayloadLen=b;InboxPage.postProcData.uiUpdate=true};InboxPage._scrollToTop=function InboxPage$_scrollToTop(){var a=Browser.isSF?document.body:$tag(document,"HTML")[0];a.scrollTop=0};InboxPage._markCurrentAsRead=function InboxPage$_markCurrentAsRead(){var a=InboxPage.readingPane.mode;if(a!=ReadingPane.MESSAGE_MODE&&a!=ReadingPane.DELAY_LOADED_MODE)return;var b=InboxPage.messageList.markMessages([InboxPage.readingPane.mid],InboxPage.readingPane.vm!="vm");if(b)FolderListHelper.setFolderCount(InboxPage.readingPane.fid,FolderListHelper.getFolderCount(InboxPage.readingPane.fid)-1)};InboxPage.showFullReadingPane=function InboxPage$showFullReadingPane(a,c){var b=a!=InboxPage.readingPane.isFullView;if(a){InboxPage.readingPane.showFullView();InboxPage.messageList.hide()}else{InboxPage.messageList.show();InboxPage.readingPane.hideFullView()}if(InboxPage.isReadingPaneOn&&!InboxPage.readingPane.isFullView){$removeClass($("readingPaneSplitter"),"SplitterBarHidden");InboxPage.initSplitter()}else $addClass($("readingPaneSplitter"),"SplitterBarHidden");if(!c&&b&&"BottomUnmanaged"==Page.getLayout())InboxPage._scrollToTop()};InboxPage.resizeActionBars=function InboxPage$resizeActionBars(){var a=$("actionBar");if(a)if(Browser.isIE6)setTimeout(function(){InboxPage._resizeActionBars2(a)},500);else InboxPage._resizeActionBars2(a)};InboxPage._resizeActionBars2=function InboxPage$_resizeActionBars2(a){Resize._resizeToolbar(a,a.children[0].children[0],[$("readingPaneContainer")])};InboxPage._createPageRefreshCookie=function InboxPage$_createPageRefreshCookie(){var a=InboxPage._getCurrentState();a["n"]=Page.queryString.nonce;a["fullView"]=InboxPage.readingPane.isFullView;Cookie.setCookieValues(InboxPage.Config.konaRefreshCookie,a,Cookie.SessionCookie)};InboxPage._saveState=function InboxPage$_saveState(){if(Browser.isSF)return;History.addNavigationStep(InboxPage._getCurrentState())};InboxPage._getCurrentState=function InboxPage$_getCurrentState(){var a=InboxPage.messageList,b=InboxPage.folderList;if(InboxPage.readingPane.isShowingMessage()){var c=InboxPage.readingPane;return {mid:c.mid,mad:c.auxData,fid:b.fid,sBy:a.sBy,sAsc:a.sAsc+"",pDir:a.pDir+"",pSkip:a.pSkip+"",aMid:a.aMid,aDate:a.aDate,pCur:a.pCur+"",pMid:a.pMid+"",isSrch:b.isSrch+"",srchKw:b.srchKw}}else return {mid:"",mad:"",fid:b.fid,sBy:a.sBy,sAsc:a.sAsc+"",pDir:a.pDir+"",pSkip:a.pSkip+"",aMid:a.aMid,aDate:a.aDate,pCur:a.pCur+"",pMid:a.pMid+"",isSrch:b.isSrch+"",srchKw:b.srchKw}};InboxPage._onRestoreState=function InboxPage$_onRestoreState(a){InboxPage.postProcData.history=false;a.sAsc=a.sAsc=="true";a.isSrch=a.isSrch=="true";var b=InboxPage.createMessageListRenderingInfo(false);b.FolderId=a.fid;b.PageDirection=a.pDir;b.PageSkip=a.pSkip;b.SortKey=a.sBy;b.SortAsc=a.sAsc;b.AnchorMessageId=a.aMid;b.AnchorMessageDate=a.aDate;b.PageNumCurrent=a.pCur;b.PageNumMidStart=a.pMid;b.IsSearchResults=a.isSrch;b.SearchKeyword=a.srchKw;var c=null,d=""!=a.mid;if(d){c=InboxPage.createMessageRenderingInfo(false);c.MessageId=a.mid;c.FolderId=a.fid;c.AuxData=null;c.SortKey=a.sBy;c.SortAsc=a.sAsc;c.Action=HM.ReadMessageOperation.None}InboxPage.beginRefreshInbox(a.fid!=InboxPage.folderList.fid,true,b,d,c)};InboxPage.updateUi=function InboxPage$updateUi(){Toolbar.updateToolbarState();if(InboxPage.postProcData.updateSortUi)InboxPage.messageList.updateSortMenu();if(InboxPage.folderList.isSrch)InboxPage.folderList.scrollIntoView(InboxPage.folderList.fid)};InboxPage.createMessageListRenderingInfo=function InboxPage$createMessageListRenderingInfo(b){var a=new HM.MessageListRenderingInfo,c=InboxPage.messageList,d=InboxPage.folderList;a.FolderId=b?d.fid:null;a.PageDirection=b?c.pDir:HM.ListNavigateDirection.FirstPage;a.PageSkip=b?c.pSkip:0;a.SortKey=b?c.sBy:"Date";a.SortAsc=b?c.sAsc:false;a.AnchorMessageId=b?c.aMid:null;a.AnchorMessageDate=b?c.aDate:null;a.PageNumCurrent=b?c.pCur:1;a.PageNumMidStart=b?c.pMid:1;a.IsSearchResults=b?d.isSrch:false;a.SearchKeyword=b?d.srchKw:"";a.MessageCount=b?c.mCt:-1;a.AutoSelectMessageIndex=InboxPage.Config.readingPane.autoSelectFirstMsg&&InboxPage.isReadingPaneOn?0:-1;a.ReadingPaneLocation=InboxPage.Config.readingPane.location;return a};InboxPage.createMessageRenderingInfo=function InboxPage$createMessageRenderingInfo(b){var a=new HM.MessageRenderingInfo,c=InboxPage.readingPane,d=InboxPage.messageList;a.MessageId=b?c.mid:null;a.FolderId=b?InboxPage.folderList.fid:null;a.OpenMessageBody=b?c.showBody:false;a.AllowUnsafeContent=b?c.showUnsafe:false;a.OverrideCodepage=b?c.codePageOverride:-1;a.AuxData=b?InboxPage.createMessageAuxData(c.auxData):null;a.SortKey=b?d.sBy:"Date";a.SortAsc=b?d.sAsc:false;a.Action=HM.ReadMessageOperation.GetMessage;a.MarkAsRead=true;return a};InboxPage.configureAutoSelect=function InboxPage$configureAutoSelect(a){a.AutoSelectMessageIndex=InboxPage.isReadingPaneOn||InboxPage.readingPane.isFullView?InboxPage.messageList.getSelectionIndex():-1};InboxPage.createMessageAuxData=function InboxPage$createMessageAuxData(a){var b=null;if(null!=a&&""!=a){b=new HM.HmAuxData;b.Value=a}return b};InboxPage.getSelectedMessageData=function InboxPage$getSelectedMessageData(){if(InboxPage.readingPane.isShowingMessage()){var b=[InboxPage.readingPane.mid],c=InboxPage.createMessageAuxData(InboxPage.readingPane.auxData),a=[c];return {mids:b,mads:a}}return InboxPage.messageList.getSelectedMessageData()};InboxPage.verifyMinimumSelection=function InboxPage$verifyMinimumSelection(){var a=InboxPage.getSelectedMessageData();if(0==a.mids.length){alert(Page.decode(InboxPage.Strings.noMessagesSelected));return null}return a};InboxPage._addErrorData=function InboxPage$_addErrorData(e,c){e.push(String.format("<br /><b>Build:</b>{0}",App.BUILD));c.push(String.format("<br />\r\nBuild:{0}",App.BUILD));e.push("<br /><b>User action(s):</b>");c.push("<br />\r\nUser action(s):");var b=InboxPage._invokes,d;for(var a=b.length-1;a>=0;a--){d=String.format("{0} - {1}.{2}({3})",a+1,b[a].typeName,b[a].methodName,b[a].args||"");e.push(d);c.push(d)}};InboxPage._onjsError=function InboxPage$_onjsError(a){if(App.forceErrorsToShow){if(!App._errorMsg)App._errorMsg="";App._errorMsg+=a.usermsg+"<hr>";Infopane.show(App._errorMsg,{pri:Infopane.ErrorPri.High});Infopane.hide=function(){}}else if(!a.isSilent)Infopane.show(Res.strings.browserJSError,{pri:Infopane.ErrorPri.High});LoadingIndicator.hide();InboxPage.postProcData.history=false;HM.ReportError(a.trace)};InboxPage._onFppError=function InboxPage$_onFppError(b){Page.fppPending(false);var a=[];InboxPage._addErrorData([],a);InboxPage.postProcData.history=false;HM.ReportError(String.format("{0}<br />\r\nDetails:<br />\r\n{1}",b,a.join("<br />\r\n")))};InboxPage._onNetworkPreInvoke=function InboxPage$_onNetworkPreInvoke(){Page.fppPending(true);Infopane.hide()};InboxPage._onNetworkPostCallback=function InboxPage$_onNetworkPostCallback(){Page.fppPending(false)};Type.createStaticClass(InboxPage,"InboxPage");Network._FppMethod.createClass("Network._FppMethod");Network._Request.createClass("Network._Request");Type.createStaticClass(Network,"Network");Type.createStaticClass(InboxServices,"InboxServices");if(!Browser.isIE)InboxPage.downloadBucket1=function InboxPage$downloadBucket1(){Loader.load(InboxPage.cssUrls,InboxPage.scriptUrls,InboxPage.onBucket1Download)};InboxPage.initSplitter=function(){};InboxPage.onSubmitReadingPaneOptionClicked=function(){};InboxPage.moveToOnClick=function(){};InboxPage.resetSkyscraperScroll=function(){};InboxPage.resetContentHeight=function(){};InboxPage.initialize();new function(){var a=InboxPage.Ps;a.searchResults="96696";a.searchResultsEmpty="97784";a.contextMenu="96542";a.dragNdrop="96541";a.folderResize="97517";a.readingPaneResize="97519";a.showFullMessageClick="97518";a.showFullMessageLink="97568"}